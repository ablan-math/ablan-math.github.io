<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงูุฏุฑุณ ูก-ูฃ: ุญู ุงููุนุงุฏูุงุช ุงููุชุนุฏุฏุฉ ุงูุฎุทูุงุช | ููุตุฉ ุงูุฑูุงุถูุงุช ุงูุชูุงุนููุฉ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; }
        .hidden { display: none; }
        .step-box { border-right: 4px solid #1d4ed8; }
        .vocab-term { background-color: #ffefc5; padding: 2px 6px; border-radius: 4px; font-weight: bold; }
        .option-label { display: block; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; cursor: pointer; transition: all 0.2s ease-in-out; }
        .option-label:hover { border-color: #3b82f6; background-color: #eff6ff; }
        input[type="radio"]:checked + .option-label { border-color: #2563eb; background-color: #dbeafe; box-shadow: 0 0 0 2px #bfdbfe; }
        input[type="radio"] { display: none; }
        .feedback-correct { color: #16a34a; }
        .feedback-incorrect { color: #dc2626; }
        .highlight-change { color: #ef4444; font-weight: bold; }
        .math-eq { font-family: "Courier New", monospace; font-size: 1.2rem; font-weight: bold; color: #4338ca; background-color: #f3f4f6; border: 1px solid #d1d5db; padding: 2px 8px; border-radius: 6px; display: inline-block; vertical-align: middle; white-space: nowrap; }
        .fraction { display: inline-flex; flex-direction: column; text-align: center; vertical-align: middle; margin: 0 0.2em; }
        .fraction > span { display: block; padding: 0 0.4em; }
        .fraction > .frac-bar { border-top: 2px solid #4338ca; }
        .step-interactive { display: none; opacity: 0; transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out; transform: translateY(10px); }
        .step-interactive.active { display: block; opacity: 1; transform: translateY(0); }
        /* === ุชูุณูู ุฎุงุต ุจุงูุฃุฑูุงู (ุฌุฏูุฏ) === */
        .highlight-number {
            background-color: #fef9c3; /* yellow-100 */
            color: #b45309; /* amber-700 */
            padding: 1px 5px;
            border-radius: 4px;
            border: 1px solid #fde047; /* yellow-300 */
            font-weight: bold;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div id="app-container" class="grid grid-template-rows: auto 1fr auto; min-height: 100vh;">
        <header id="main-header" class="bg-white shadow-md sticky top-0 z-50"></header>
        <main class="container mx-auto max-w-4xl my-8">
            <div class="p-6 bg-white rounded-xl shadow-lg">
                <header class="flex justify-between items-center mb-8 border-b pb-4 border-gray-200">
                    <h1 id="lesson-title" class="text-3xl font-bold text-blue-800">ุงูุฏุฑุณ ูก-ูฃ: ุญู ุงููุนุงุฏูุงุช ุงููุชุนุฏุฏุฉ ุงูุฎุทูุงุช</h1>
                </header>
                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">๐ก ุฃููุงู: ุงูููููู ุงูุฃุณุงุณู</h2>
                    <div class="p-4 bg-blue-50 rounded-lg space-y-3">
                        <p>ูู ูุฐุง ุงูุฏุฑุณุ ุณูุญู <span class="vocab-term">ูุนุงุฏูุงุช ูุชุนุฏุฏุฉ ุงูุฎุทูุงุช</span>ุ ููู ูุนุงุฏูุงุช ุชุชุทูุจ ุฃูุซุฑ ูู ุนูููุฉ ูุงุญุฏุฉ ูุญููุง. ุงูููุชุงุญ ูู ุงูุชุฎูุต ูู ุนูููุงุช ุงูุฌูุน ูุงูุทุฑุญ ุฃููุงูุ ุซู ุงูุชุฎูุต ูู ุนูููุงุช ุงูุถุฑุจ ูุงููุณูุฉ.</p>
                        <p>ุณูุชุนูู ุฃูุถุงู ุนู <span class="vocab-term">ูุธุฑูุฉ ุงูุฃุนุฏุงุฏ</span> ูุญู ูุณุงุฆู ุชุชุถูู <span class="vocab-term">ุฃุนุฏุงุฏุงู ุตุญูุญุฉ ูุชุชุงููุฉ</span>.</p>
                    </div>
                </section>
                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">๐ฏ ุซุงููุงู: ุฃูุซูุฉ ุชูุงุนููุฉ</h2>
                    <div class="p-6 bg-gray-50 rounded-lg">
                        <div class="flex flex-col space-y-8">
                            <!-- Example 1 & 2 -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                <div id="interactive-container-1" class="p-4 bg-white rounded-lg shadow">
                                    <p class="text-lg font-semibold mb-4">ูุซุงู ูก: ุญู ุงููุนุงุฏูุฉ <span class="math-eq">ูฅุณ + ูฉ = ูขูค</span></p>
                                    <div class="steps-container space-y-4 min-h-[280px]">
                                        <div class="interactive-placeholder text-center text-gray-500 p-4"><p>ุงุถุบุท "ุงูุชุงูู" ูุจุฏุก ุฎุทูุงุช ุงูุญู</p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ 1: ุงูุชุฎูุต ูู ุงูุฌูุน</h4><p>ูุทุฑุญ <span class="highlight-number">ูฉ</span> ูู ููุง ุงูุทุฑููู.</p><div class="text-center mt-2 flex flex-col items-center"><p class="math-eq">ูฅุณ + ูฉ <span class="highlight-change">- ูฉ</span> = ูขูค <span class="highlight-change">- ูฉ</span></p><p class="math-eq">ูฅุณ = ูกูฅ</p></div></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ 2: ุงูุชุฎูุต ูู ุงูุถุฑุจ</h4><p>ููุณู ููุง ุงูุทุฑููู ุนูู <span class="highlight-number">ูฅ</span>.</p><p class="math-eq text-center mt-2 flex justify-center items-center"><span class="fraction"><span>ูฅุณ</span><span class="frac-bar"></span><span>ูฅ</span></span> = <span class="fraction"><span>ูกูฅ</span><span class="frac-bar"></span><span>ูฅ</span></span></p></div>
                                        <div class="step-interactive p-4 bg-green-200 rounded-lg step-box border-green-600"><h4 class="font-bold">ุงูุฎุทูุฉ ุงูุฃุฎูุฑุฉ: ุงูุญู ุงูููุงุฆู</h4><p>ูุจุณุท ุงููุนุงุฏูุฉ ููุฌุฏ ุงูุญู: <span class="math-eq">ุณ = ูฃ</span>.</p></div>
                                    </div>
                                    <div class="flex justify-between mt-6">
                                        <button data-example="1" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">ุฑุฌูุน</button>
                                        <div>
                                            <button data-example="1" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">ุงูุชุงูู</button>
                                            <button data-example="1" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">ุฅุนุงุฏุฉ</button>
                                        </div>
                                    </div>
                                </div>
                                <div id="interactive-container-2" class="p-4 bg-white rounded-lg shadow">
                                    <p class="text-lg font-semibold mb-4">ูุซุงู ูข: ูุนุงุฏูุฉ ุชุชุถูู ูุณูุฑุงู <span class="math-eq"><span class="fraction"><span>ูข</span><span class="frac-bar"></span><span>ูฃ</span></span>ุณ + ูค = ูข</span></p>
                                    <div class="steps-container space-y-4 min-h-[280px]">
                                        <div class="interactive-placeholder text-center text-gray-500 p-4"><p>ุงุถุบุท "ุงูุชุงูู" ูุจุฏุก ุฎุทูุงุช ุงูุญู</p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ 1: ุงูุชุฎูุต ูู ุงูุฌูุน</h4><p>ูุทุฑุญ <span class="highlight-number">ูค</span> ูู ููุง ุงูุทุฑููู.</p><div class="text-center mt-2 flex flex-col items-center"><p class="math-eq"><span class="fraction"><span>ูข</span><span class="frac-bar"></span><span>ูฃ</span></span>ุณ + ูค <span class="highlight-change">- ูค</span> = ูข <span class="highlight-change">- ูค</span></p><p class="math-eq"><span class="fraction"><span>ูข</span><span class="frac-bar"></span><span>ูฃ</span></span>ุณ = -ูข</p></div></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ 2: ุงูุชุฎูุต ูู ุงููุณุฑ</h4><p>ูุถุฑุจ ุงูุทุฑููู ูู ููููุจ ุงููุณุฑ <span class="math-eq"><span class="fraction"><span>ูฃ</span><span class="frac-bar"></span><span>ูข</span></span></span>.</p><p class="math-eq text-center mt-2 flex justify-center items-center"><span class="highlight-change"><span class="fraction"><span>ูฃ</span><span class="frac-bar"></span><span>ูข</span></span> ร </span><span class="fraction"><span>ูข</span><span class="frac-bar"></span><span>ูฃ</span></span>ุณ = -ูข <span class="highlight-change">ร <span class="fraction"><span>ูฃ</span><span class="frac-bar"></span><span>ูข</span></span></span></p></div>
                                        <div class="step-interactive p-4 bg-green-200 rounded-lg step-box border-green-600"><h4 class="font-bold">ุงูุฎุทูุฉ ุงูุฃุฎูุฑุฉ: ุงูุญู ุงูููุงุฆู</h4><p>ูุจุณุท ุงููุนุงุฏูุฉ ููุฌุฏ ุงูุญู: <span class="math-eq">ุณ = -ูฃ</span>.</p></div>
                                    </div>
                                    <div class="flex justify-between mt-6">
                                        <button data-example="2" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">ุฑุฌูุน</button>
                                        <div>
                                            <button data-example="2" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">ุงูุชุงูู</button>
                                            <button data-example="2" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">ุฅุนุงุฏุฉ</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                             <!-- Example 3 & 4 -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                <div id="interactive-container-3" class="p-4 bg-white rounded-lg shadow">
                                    <p class="text-lg font-semibold mb-4">ูุซุงู ูฃ: ุฎุงุตูุฉ ุงูุชูุฒูุน <span class="math-eq">ูฃ(ุณ - ูฅ) = ูกูข</span></p>
                                    <div class="steps-container space-y-4 min-h-[340px]">
                                        <div class="interactive-placeholder text-center text-gray-500 p-4"><p>ุงุถุบุท "ุงูุชุงูู" ูุจุฏุก ุฎุทูุงุช ุงูุญู</p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ 1: ุงูุชูุฒูุน</h4><p>ูุถุฑุจ <span class="highlight-number">ูฃ</span> ูู ูู ุญุฏ ุฏุงุฎู ุงูููุณ.</p><p class="math-eq text-center mt-2">ูฃุณ - ูกูฅ = ูกูข</p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ 2: ุงูุชุฎูุต ูู ุงูุทุฑุญ</h4><p>ูุถูู <span class="highlight-number">ูกูฅ</span> ุฅูู ููุง ุงูุทุฑููู.</p><div class="text-center mt-2 flex flex-col items-center"><p class="math-eq">ูฃุณ - ูกูฅ <span class="highlight-change">+ ูกูฅ</span> = ูกูข <span class="highlight-change">+ ูกูฅ</span></p><p class="math-eq">ูฃุณ = ูขูง</p></div></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ 3: ุงูุชุฎูุต ูู ุงูุถุฑุจ</h4><p>ููุณู ููุง ุงูุทุฑููู ุนูู <span class="highlight-number">ูฃ</span>.</p><p class="math-eq text-center mt-2 flex justify-center items-center"><span class="fraction"><span>ูฃุณ</span><span class="frac-bar"></span><span>ูฃ</span></span> = <span class="fraction"><span>ูขูง</span><span class="frac-bar"></span><span>ูฃ</span></span></p></div>
                                        <div class="step-interactive p-4 bg-green-200 rounded-lg step-box border-green-600"><h4 class="font-bold">ุงูุฎุทูุฉ ุงูุฃุฎูุฑุฉ: ุงูุญู ุงูููุงุฆู</h4><p><span class="math-eq">ุณ = ูฉ</span>.</p></div>
                                    </div>
                                    <div class="flex justify-between mt-6">
                                        <button data-example="3" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">ุฑุฌูุน</button>
                                        <div>
                                            <button data-example="3" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">ุงูุชุงูู</button>
                                            <button data-example="3" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">ุฅุนุงุฏุฉ</button>
                                        </div>
                                    </div>
                                </div>
                                <div id="interactive-container-4" class="p-4 bg-white rounded-lg shadow">
                                    <p class="text-lg font-semibold mb-4">ูุซุงู ูค: ูุชุบูุฑุงุช ูู ุงูุทุฑููู <span class="math-eq">ูฆ(ู - ูข) = ูขู</span></p>
                                    <div class="steps-container space-y-4 min-h-[340px]">
                                        <div class="interactive-placeholder text-center text-gray-500 p-4"><p>ุงุถุบุท "ุงูุชุงูู" ูุจุฏุก ุฎุทูุงุช ุงูุญู</p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ 1: ุงูุชูุฒูุน</h4><p>ูุทุจู ุฎุงุตูุฉ ุงูุชูุฒูุน ุนูู ุงูุทุฑู ุงูุฃููู.</p><p class="math-eq text-center mt-2">ูฆู - ูกูข = ูขู</p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ 2: ุชุฌููุน ุงููุชุบูุฑุงุช</h4><p>ูุทุฑุญ <span class="math-eq">ูขู</span> ูู ููุง ุงูุทุฑููู.</p><div class="text-center mt-2 flex flex-col items-center"><p class="math-eq">ูฆู <span class="highlight-change">- ูขู</span> - ูกูข = ูขู <span class="highlight-change">- ูขู</span></p><p class="math-eq">ูคู - ูกูข = ู</p></div></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ 3: ุญู ุงููุนุงุฏูุฉ</h4><p>ูุถูู <span class="highlight-number">ูกูข</span> ููุทุฑููู ุซู ููุณู ุนูู <span class="highlight-number">ูค</span>.</p><div class="text-center mt-2 flex flex-col items-center"><p class="math-eq">ูคู = ูกูข</p><p class="math-eq flex justify-center items-center"><span class="fraction"><span>ูคู</span><span class="frac-bar"></span><span>ูค</span></span> = <span class="fraction"><span>ูกูข</span><span class="frac-bar"></span><span>ูค</span></span></p></div></div>
                                        <div class="step-interactive p-4 bg-green-200 rounded-lg step-box border-green-600"><h4 class="font-bold">ุงูุฎุทูุฉ ุงูุฃุฎูุฑุฉ: ุงูุญู ุงูููุงุฆู</h4><p><span class="math-eq">ู = ูฃ</span>.</p></div>
                                    </div>
                                    <div class="flex justify-between mt-6">
                                        <button data-example="4" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">ุฑุฌูุน</button>
                                        <div>
                                            <button data-example="4" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">ุงูุชุงูู</button>
                                            <button data-example="4" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">ุฅุนุงุฏุฉ</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">๐ฏ ุซุงูุซุงู: ูุณุงุฆู ุงูุฃุนุฏุงุฏ ุงููุชุชุงููุฉ</h2>
                    <div class="p-6 bg-gray-50 rounded-lg">
                        <div class="p-4 bg-indigo-50 rounded-lg mb-6 text-gray-700 space-y-3">
                            <p><strong class="text-indigo-800">ุชูุถูุญ ูุงู:</strong></p>
                            <ul class="list-disc pr-6 space-y-2">
                                <li><span class="bg-blue-100 text-blue-800 px-2 py-1 rounded"><strong>ุงูุฃุนุฏุงุฏ ุงูุตุญูุญุฉ ุงููุชุชุงููุฉ:</strong></span> ุงููุงุฑู ุจูููุง <span class="highlight-number">ูก</span> (ูุซู: <span class="math-eq">ูุ ู+ูกุ ู+ูข</span>).</li>
                                <li><span class="bg-purple-100 text-purple-800 px-2 py-1 rounded"><strong>ุงูุฃุนุฏุงุฏ ุงูุฒูุฌูุฉ ุฃู ุงููุฑุฏูุฉ ุงููุชุชุงููุฉ:</strong></span> ุงููุงุฑู ุจูููุง <span class="highlight-number">ูข</span> (ูุซู: <span class="math-eq">ูุ ู+ูขุ ู+ูค</span>).</li>
                            </ul>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div id="interactive-container-5" class="p-4 bg-white rounded-lg shadow">
                                <p class="text-lg font-semibold mb-4">ูุซุงู ูฅ: ุฃุนุฏุงุฏ ุตุญูุญุฉ ูุชุชุงููุฉ ูุฌููุนูุง <span class="math-eq">ูฆูฃ</span></p>
                                <div class="steps-container space-y-4 min-h-[340px]">
                                    <div class="interactive-placeholder text-center text-gray-500 p-4"><p>ุงุถุบุท "ุงูุชุงูู" ูุจุฏุก ุฎุทูุงุช ุงูุญู</p></div>
                                    <div class="step-interactive p-4 bg-blue-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ 1: ุชุนุฑูู ุงููุชุบูุฑุงุช</h4><p>ููุฑุถ ุฃู ุงูุฃุนุฏุงุฏ ูู: <span class="math-eq">ูุ ู + ูกุ ู + ูข</span>.</p></div>
                                    <div class="step-interactive p-4 bg-blue-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ 2: ูุชุงุจุฉ ุงููุนุงุฏูุฉ</h4><p class="math-eq text-center mt-2">ู + (ู + ูก) + (ู + ูข) = ูฆูฃ</p></div>
                                    <div class="step-interactive p-4 bg-blue-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ 3: ุญู ุงููุนุงุฏูุฉ</h4><div class="text-center mt-2 flex flex-col items-center"><p class="math-eq">ูฃู + ูฃ = ูฆูฃ</p><p class="math-eq">ูฃู = ูฆู</p><p class="math-eq">ู = ูขู</p></div></div>
                                    <div class="step-interactive p-4 bg-green-200 rounded-lg step-box border-green-600"><h4 class="font-bold">ุงูุฎุทูุฉ ุงูุฃุฎูุฑุฉ: ุฅูุฌุงุฏ ุงูุฃุนุฏุงุฏ</h4><p>ุงูุฃุนุฏุงุฏ ูู: <span class="math-eq">ูขูุ ูขูกุ ูขูข</span>.</p></div>
                                </div>
                                <div class="flex justify-between mt-6">
                                    <button data-example="5" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">ุฑุฌูุน</button>
                                    <div>
                                        <button data-example="5" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">ุงูุชุงูู</button>
                                        <button data-example="5" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">ุฅุนุงุฏุฉ</button>
                                    </div>
                                </div>
                            </div>
                            <div id="interactive-container-6" class="p-4 bg-white rounded-lg shadow">
                                <p class="text-lg font-semibold mb-4">ูุซุงู ูฆ: ุฃุนุฏุงุฏ ูุฑุฏูุฉ ูุชุชุงููุฉ ูุฌููุนูุง <span class="math-eq">ูงูฅ</span></p>
                                <div class="steps-container space-y-4 min-h-[340px]">
                                    <div class="interactive-placeholder text-center text-gray-500 p-4"><p>ุงุถุบุท "ุงูุชุงูู" ูุจุฏุก ุฎุทูุงุช ุงูุญู</p></div>
                                    <div class="step-interactive p-4 bg-purple-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ 1: ุชุนุฑูู ุงููุชุบูุฑุงุช</h4><p>ููุฑุถ ุฃู ุงูุฃุนุฏุงุฏ ูู: <span class="math-eq">ูุ ู + ูขุ ู + ูค</span>.</p></div>
                                    <div class="step-interactive p-4 bg-purple-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ 2: ูุชุงุจุฉ ุงููุนุงุฏูุฉ</h4><p class="math-eq text-center mt-2">ู + (ู + ูข) + (ู + ูค) = ูงูฅ</p></div>
                                    <div class="step-interactive p-4 bg-purple-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ 3: ุญู ุงููุนุงุฏูุฉ</h4><div class="text-center mt-2 flex flex-col items-center"><p class="math-eq">ูฃู + ูฆ = ูงูฅ</p><p class="math-eq">ูฃู = ูฆูฉ</p><p class="math-eq">ู = ูขูฃ</p></div></div>
                                    <div class="step-interactive p-4 bg-green-200 rounded-lg step-box border-green-600"><h4 class="font-bold">ุงูุฎุทูุฉ ุงูุฃุฎูุฑุฉ: ุฅูุฌุงุฏ ุงูุฃุนุฏุงุฏ</h4><p>ุงูุฃุนุฏุงุฏ ูู: <span class="math-eq">ูขูฃุ ูขูฅุ ูขูง</span>.</p></div>
                                </div>
                                <div class="flex justify-between mt-6">
                                    <button data-example="6" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">ุฑุฌูุน</button>
                                    <div>
                                        <button data-example="6" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">ุงูุชุงูู</button>
                                        <button data-example="6" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">ุฅุนุงุฏุฉ</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="mt-12">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-bold text-gray-800">โ๏ธ ุฑุงุจุนุงู: ุญุงู ุฏูุฑู! ุงุฎุชุจุฑ ูููู</h2>
                        <div id="attempts-counter" class="text-sm font-bold text-gray-600"></div>
                    </div>
                    <form id="quizForm" class="p-6 bg-gray-50 rounded-lg space-y-8"></form>
                    <div id="quiz-results" class="hidden mt-6 p-4 rounded-lg text-center">
                        <h3 class="text-xl font-bold">ูุชูุฌุชู ุงูููุงุฆูุฉ</h3>
                        <p id="quiz-score" class="text-4xl font-bold my-2"></p>
                        <div id="save-status" class="mt-4 text-sm font-semibold"></div>
                        <button id="retake-quiz-btn" class="hidden mt-4 bg-blue-600 text-white font-medium py-2 px-6 rounded-lg hover:bg-blue-700">ุฅุนุงุฏุฉ ุงูุงุฎุชุจุงุฑ</button>
                    </div>
                </section>
            </div>
        </main>
        <footer id="main-footer" class="bg-gray-200 py-4"></footer>
    </div>
    <div id="explanationModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-lg shadow-2xl p-6 max-w-lg w-full">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold">๐ก ุดุฑุญ ุงูุฅุฌุงุจุฉ</h3>
                <button id="closeModalBtn" class="p-2 -m-2 rounded-full hover:bg-gray-200">
                    <svg class="h-6 w-6 text-gray-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <div id="explanationText" class="text-gray-700 max-h-[60vh] overflow-y-auto"></div>
        </div>
    </div>
    <div id="smartExplanationModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-lg shadow-2xl p-6 max-w-lg w-full border-t-4 border-purple-500">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-purple-800">๐ง ุงูุญู ุงูุฐูู</h3>
                <button id="closeSmartModalBtn" class="p-2 -m-2 rounded-full hover:bg-gray-200">
                    <svg class="h-6 w-6 text-gray-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <div id="smartExplanationText" class="text-gray-700 max-h-[60vh] overflow-y-auto"></div>
        </div>
    </div>
    <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzrf1-At3Pq7i39bGV3F1iD3-b0G-WWyRi5cgpKeQjyn_N5fh2EmGhoyRKUsbLd-F_UJQ/exec";
    const MAX_ATTEMPTS = 3;
    let currentQuestions = []; 
    function getStudentFromStorage() { const studentDataString = localStorage.getItem('currentStudent'); if (studentDataString) { try { return JSON.parse(studentDataString); } catch (e) { return null; } } return null; }
    function buildHeader(studentData, lessonTitle = null, studentId, classId) { const headerContainer = document.getElementById('main-header'); if (!headerContainer) return; let titleHtml; if (lessonTitle) { titleHtml = `<div><h2 class="text-sm text-gray-500 leading-tight">ููุตุฉ ุงูุฑูุงุถูุงุช ุงูุชูุงุนููุฉ</h2><h1 class="text-xl font-bold text-indigo-700 leading-tight">${lessonTitle}</h1></div>`; } else { titleHtml = `<a href="../index.html" target="_top"><h1 class="text-2xl font-bold text-blue-800">ููุตุฉ ุงูุฑูุงุถูุงุช ุงูุชูุงุนููุฉ</h1></a>`; } let userInfoHtml = ''; if (studentData && studentId && classId) { userInfoHtml = `<div class="text-left"><span class="font-semibold">ุฃููุงูุ ${studentData.name}</span><br><a href="../index.html?studentId=${studentId}&classId=${classId}" target="_top" class="text-sm text-blue-600 hover:underline">ุงูุนูุฏุฉ ุฅูู ุงูููุฑุณ &larr;</a></div>`; } else { userInfoHtml = `<div class="text-left"><p class="text-lg text-gray-600">ุฒุงุฆุฑ</p><a href="../index.html" target="_top" class="text-sm text-blue-600 hover:underline">ุงูุนูุฏุฉ ุฅูู ุงูููุฑุณ &larr;</a></div>`; } headerContainer.innerHTML = `<div class="container mx-auto px-6 py-4 flex justify-between items-center">${titleHtml}${userInfoHtml}</div>`; const logoutLink = headerContainer.querySelector('#logout-link'); if(logoutLink) { logoutLink.addEventListener('click', () => { localStorage.removeItem('currentStudent'); }); } }
    function buildFooter() { const footerContainer = document.getElementById('main-footer'); if (!footerContainer) return; footerContainer.innerHTML = `<div class="container mx-auto px-6"><p class="text-center text-gray-600 text-sm">ยฉ 2024 ุฌููุน ุงูุญููู ูุญููุธุฉ | ุชุตููู ูุชุทููุฑ: ุฃ. ุนุจุฏุงูุนุฒูุฒ ุฎุงูุฏ ุงูุนุจูุงู</p></div>`; }
    function initializeQuiz(lessonId, questions, studentData, studentId) { currentQuestions = questions; const quizForm = document.getElementById('quizForm'); if (!quizForm) return; if (questions.length === 0) { quizForm.innerHTML = `<p class="text-center text-gray-600">ูุง ุชูุฌุฏ ุฃุณุฆูุฉ ูุชุงุญุฉ ููุฐุง ุงูุฏุฑุณ ุญุงููุงู.</p>`; return; } let attemptsLeft; if (studentData) { const studentLessonData = studentData.lessons?.[lessonId] || { attempts: 0 }; attemptsLeft = MAX_ATTEMPTS - studentLessonData.attempts; } else { attemptsLeft = 1; } const attemptsCounter = document.getElementById('attempts-counter'); if (attemptsCounter) { attemptsCounter.innerHTML = `ุงููุญุงููุงุช ุงููุชุจููุฉ: <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full">${attemptsLeft}</span>`; } const quizHtml = questions.map((q, index) => { const optionsHTML = q.options.map((opt, optIndex) => `<div><input type="radio" name="q${index}" value="${opt.value}" id="q${index}_opt${optIndex}" class="hidden"><label for="q${index}_opt${optIndex}" class="option-label">${opt.display}</label></div>`).join(''); const smartButtonHTML = q.smartExplanation ? `<button type="button" id="smart-explain-btn-${index}" class="hidden mt-2 text-xs text-purple-600 hover:underline font-semibold">๐ง ุงูุญู ุงูุฐูู</button>` : ''; return `<div class="p-4 border-2 border-gray-200 rounded-lg"><p class="font-bold">${index + 1}. <span class="text-yellow-500">${q.level}</span> ${q.text}</p><div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mt-3">${optionsHTML}</div><div id="feedback-q${index}" class="mt-2 text-sm font-bold"></div><div class="flex items-center space-x-4 space-x-reverse">${smartButtonHTML}<button type="button" id="explain-btn-${index}" class="hidden mt-2 text-xs text-blue-600 hover:underline">ุงุนุฑู ููุงุฐุงุ</button></div></div>`; }).join(''); quizForm.innerHTML = quizHtml + `<button type="submit" id="submit-quiz-btn" class="w-full text-white bg-green-600 hover:bg-green-700 font-medium rounded-lg text-lg px-5 py-3 mt-8">ุชุญูู ูู ุฅุฌุงุจุงุชู</button>`; questions.forEach((q, index) => { const explainBtn = document.getElementById(`explain-btn-${index}`); if(explainBtn) explainBtn.addEventListener('click', () => showExplanation(index)); if (q.smartExplanation) { const smartExplainBtn = document.getElementById(`smart-explain-btn-${index}`); if(smartExplainBtn) smartExplainBtn.addEventListener('click', () => showSmartExplanation(index)); } }); if (attemptsLeft <= 0) { const submitBtn = quizForm.querySelector('#submit-quiz-btn'); submitBtn.disabled = true; submitBtn.textContent = 'ูุง ุชูุฌุฏ ูุญุงููุงุช ูุชุจููุฉ'; submitBtn.classList.add('bg-gray-400', 'hover:bg-gray-400'); } quizForm.onsubmit = (e) => { e.preventDefault(); let score = 0; questions.forEach((q, index) => { const userAnswer = e.target.elements[`q${index}`]?.value; const feedbackEl = document.getElementById(`feedback-q${index}`); if (userAnswer === q.correct) { score++; feedbackEl.textContent = 'โ ุฅุฌุงุจุฉ ุตุญูุญุฉ!'; feedbackEl.className = 'mt-2 text-sm font-bold text-green-600'; } else { feedbackEl.textContent = `โ ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ.`; feedbackEl.className = 'mt-2 text-sm font-bold text-red-600'; } document.getElementById(`explain-btn-${index}`).classList.remove('hidden'); if (q.smartExplanation) { document.getElementById(`smart-explain-btn-${index}`).classList.remove('hidden'); } }); const finalGrade = Math.round((score / questions.length) * 10); const resultsDiv = document.getElementById('quiz-results'); resultsDiv.classList.remove('hidden'); document.getElementById('quiz-score').textContent = `${finalGrade} / 10`; if (studentId) { saveGrade(lessonId, finalGrade); if (attemptsLeft - 1 > 0) { document.getElementById('retake-quiz-btn').classList.remove('hidden'); } } else { document.getElementById('save-status').textContent = 'ุชู ุนุฑุถ ูุชูุฌุชู. ุณุฌู ุงูุฏุฎูู ูุญูุธ ุชูุฏูู.'; } e.target.querySelector('#submit-quiz-btn').disabled = true; }; }
    function saveGrade(lessonId, grade) { const urlParams = new URLSearchParams(window.location.search); const studentId = urlParams.get('studentId'); const classId = urlParams.get('classId'); if (!studentId || !classId) { const saveStatus = document.getElementById('save-status'); saveStatus.textContent = 'โ ุฎุทุฃ: ูุง ูููู ุญูุธ ูุชูุฌุชู. ุจูุงูุงุช ุงูุทุงูุจ ุฃู ุงููุตู ุบูุฑ ููุฌูุฏุฉ.'; console.error("Student ID or Class ID is missing from the URL."); return; } const saveStatus = document.getElementById('save-status'); saveStatus.textContent = 'ุฌุงุฑู ุญูุธ ูุชูุฌุชู...'; const url = `${SCRIPT_URL}?action=saveGrade&studentId=${studentId}&classId=${classId}&lessonId=${lessonId}&grade=${grade}`; fetch(url) .then(res => res.json()) .then(result => { if (result.status === 'success') { saveStatus.textContent = 'โ ุชู ุญูุธ ูุชูุฌุชู ุจูุฌุงุญ! ุณุชุธูุฑ ูู ููุญุฉ ุงูุชุญูู ุนูุฏ ุงูุนูุฏุฉ.'; const studentData = JSON.parse(localStorage.getItem('currentStudent')); if (studentData) { if (!studentData.lessons) studentData.lessons = {}; if (!studentData.lessons[lessonId] || studentData.lessons[lessonId].grade < grade) { studentData.lessons[lessonId] = { grade: grade, attempts: (studentData.lessons[lessonId]?.attempts || 0) + 1 }; } else { studentData.lessons[lessonId].attempts++; } localStorage.setItem('currentStudent', JSON.stringify(studentData)); } } else { throw new Error(result.message); } }) .catch(error => { saveStatus.textContent = 'โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุงูุฏุฑุฌุฉ.'; console.error("Save Grade Error:", error); }); }
    function showExplanation(questionIndex) { const modal = document.getElementById('explanationModal'); const explanationText = document.getElementById('explanationText'); if(modal && explanationText && currentQuestions[questionIndex] && currentQuestions[questionIndex].explanation) { explanationText.innerHTML = currentQuestions[questionIndex].explanation; modal.classList.remove('hidden'); } }
    function closeModal() { const modal = document.getElementById('explanationModal'); if(modal) modal.classList.add('hidden'); }
    function showSmartExplanation(questionIndex) { const modal = document.getElementById('smartExplanationModal'); const explanationText = document.getElementById('smartExplanationText'); if(modal && explanationText && currentQuestions[questionIndex] && currentQuestions[questionIndex].smartExplanation) { explanationText.innerHTML = currentQuestions[questionIndex].smartExplanation; modal.classList.remove('hidden'); } }
    function closeSmartModal() { const modal = document.getElementById('smartExplanationModal'); if(modal) modal.classList.add('hidden'); }
    const LESSON_ID = 'c1_l3'; 
    function generateQuiz() { 
        const questionBank = [
            { 
              type: 'mcq', level: 'โญ', topic: 'multi-step', text: 'ุญู ุงููุนุงุฏูุฉ: <span class="math-eq">ูขุณ + ูก = ูง</span>', 
              options: [ { display: '<span class="math-eq">ูค</span>', value: 'ูค' }, { display: '<span class="math-eq">ูฃ</span>', value: 'ูฃ' }, { display: '<span class="math-eq">ูฅ</span>', value: 'ูฅ' }, { display: '<span class="math-eq">ูฆ</span>', value: 'ูฆ' } ], 
              correct: 'ูฃ', 
              explanation: `<p class='mb-2'>ูุชุฎูุต ูู ุงูุฌูุน ุฃููุงู ุซู ุงูุถุฑุจ.</p><div class='text-right space-y-2'><p>ุฃููุงู: ูุทุฑุญ <span class="highlight-number">ูก</span> ูู ุงูุทุฑููู: <span class='math-eq'>ูขุณ + ูก <span class='highlight-change'>- ูก</span> = ูง <span class='highlight-change'>- ูก</span></span></p><p>ุซุงููุงู: ูุจุณุท: <span class='math-eq'>ูขุณ = ูฆ</span></p><p>ุซุงูุซุงู: ููุณู ุงูุทุฑููู ุนูู <span class="highlight-number">ูข</span>: <span class='math-eq flex justify-center items-center'><span class="fraction"><span>ูขุณ</span><span class="frac-bar"></span><span>ูข</span></span> = <span class="fraction"><span>ูฆ</span><span class="frac-bar"></span><span>ูข</span></span></span></p><p>ุฑุงุจุนุงู: ุงูุญู ุงูููุงุฆู: <span class='math-eq'>ุณ = ูฃ</span></p></div>`,
              smartExplanation: `<p>ูุง ูู ุงูุนุฏุฏ ุงูุฐู ุฅุฐุง ุถุฑุจุชู ูู <span class="highlight-number">ูข</span> ูุฃุถูุช <span class="highlight-number">ูก</span> ูุตุจุญ ุงููุงุชุฌ <span class="highlight-number">ูง</span>ุ ุฐูููุงูุ ุงูุนุฏุฏ ูู <span class="highlight-number">ูฃ</span>.</p><p class='mt-2'><span class='math-eq'>ูข(ูฃ) + ูก = ูฆ + ูก = ูง</span></p>`
            },
            { 
              type: 'mcq', level: 'โญโญ', topic: 'multi-step', text: 'ุญู ุงููุนุงุฏูุฉ: <span class="math-eq">-ูก = ูฅ + ูขู</span>', 
              options: [ { display: '<span class="math-eq">-ูฃ</span>', value: '-ูฃ' }, { display: '<span class="math-eq">ูฃ</span>', value: 'ูฃ' }, { display: '<span class="math-eq">-ูข</span>', value: '-ูข' }, { display: '<span class="math-eq">ูข</span>', value: 'ูข' } ], 
              correct: '-ูฃ', 
              explanation: `<p class='mb-2'>ูุชุฎูุต ูู ุงูุฌูุน ุฃููุงู ุซู ุงูุถุฑุจ.</p><div class='text-right space-y-2'><p>ุฃููุงู: ูุทุฑุญ <span class="highlight-number">ูฅ</span> ูู ุงูุทุฑููู: <span class='math-eq'>-ูก <span class='highlight-change'>- ูฅ</span> = ูฅ + ูขู <span class='highlight-change'>- ูฅ</span></span></p><p>ุซุงููุงู: ูุจุณุท: <span class='math-eq'>-ูฆ = ูขู</span></p><p>ุซุงูุซุงู: ููุณู ุงูุทุฑููู ุนูู <span class="highlight-number">ูข</span>: <span class='math-eq flex justify-center items-center'><span class="fraction"><span>-ูฆ</span><span class="frac-bar"></span><span>ูข</span></span> = <span class="fraction"><span>ูขู</span><span class="frac-bar"></span><span>ูข</span></span></span></p><p>ุฑุงุจุนุงู: ุงูุญู ุงูููุงุฆู: <span class='math-eq'>-ูฃ = ู</span></p></div>`,
              smartExplanation: `<p>ูุฌุจ ุฃู ูููู <span class='math-eq'>ูขู</span> ุนุฏุฏุงู ุณุงูุจูุงู ููุฌุนู ุงููุฌููุน <span class="highlight-number">-ูก</span>. ุจุชุฌุฑุจุฉ ุงูุฎูุงุฑ (ุฃ):</p><p class='mt-2'><span class='math-eq'>ูฅ + ูข(-ูฃ) = ูฅ - ูฆ = -ูก</span>. ุฅุฐู ุงูุญู ุตุญูุญ.</p>`
            },
            { 
              type: 'mcq', level: 'โญโญ', topic: 'consecutive', text: 'ุฃูุฌุฏ ุซูุงุซุฉ ุฃุนุฏุงุฏ ุตุญูุญุฉ ูุชุชุงููุฉ ูุฌููุนูุง <span class="math-eq">ูฃูฃ</span>.', 
              options: [ { display: 'ูฉุ ูกูุ ูกูก', value: 'ูฉุ ูกูุ ูกูก' }, { display: 'ูกูกุ ูกูขุ ูกูฃ', value: 'ูกูกุ ูกูขุ ูกูฃ' }, { display: 'ูกูุ ูกูกุ ูกูข', value: 'ูกูุ ูกูกุ ูกูข' }, { display: 'ูฃูขุ ูฃูฃุ ูฃูค', value: 'ูฃูขุ ูฃูฃุ ูฃูค' } ], 
              correct: 'ูกูุ ูกูกุ ูกูข', 
              explanation: `<p class='mb-2'>ููุฑุถ ุงูุฃุนุฏุงุฏ: <span class="math-eq">ู</span>ุ <span class="math-eq">ู+ูก</span>ุ <span class="math-eq">ู+ูข</span>.</p><div class='text-right space-y-2'><p>ุฃููุงู: ุงููุนุงุฏูุฉ: <span class='math-eq'>ู + (ู+ูก) + (ู+ูข) = ูฃูฃ</span></p><p>ุซุงููุงู: ูุจุณุท ุจุฌูุน ุงูุญุฏูุฏ ุงููุชุดุงุจูุฉ: <span class='math-eq'>ูฃู + ูฃ = ูฃูฃ</span></p><p>ุซุงูุซุงู: ูุทุฑุญ <span class="highlight-number">ูฃ</span> ูู ุงูุทุฑููู: <span class='math-eq'>ูฃู + ูฃ <span class='highlight-change'>- ูฃ</span> = ูฃูฃ <span class='highlight-change'>- ูฃ</span></span></p><p>ุฑุงุจุนุงู: ูุจุณุท: <span class='math-eq'>ูฃู = ูฃู</span></p><p>ุฎุงูุณุงู: ููุณู ุนูู <span class="highlight-number">ูฃ</span>: <span class='math-eq'>ู = ูกู</span></p><p class='mt-2 p-2 bg-green-100 rounded-md'>ุฅุฐู ุงูุฃุนุฏุงุฏ ูู <span class="highlight-number">ูกู</span>ุ <span class="highlight-number">ูกูก</span>ุ <span class="highlight-number">ูกูข</span>.</p></div>`,
              smartExplanation: `<p>ุจูุง ุฃู ุงูุฃุนุฏุงุฏ ูุชุชุงููุฉุ ูุงูุนุฏุฏ ุงูุฃูุณุท ูู ูุชูุณุทูุง ุงูุญุณุงุจู.</p><p>ุงูุณู ุงููุฌููุน ุนูู ุนุฏุฏ ุงูุฃุนุฏุงุฏ: <span class='math-eq'>ูฃูฃ รท ูฃ = ูกูก</span>.</p><p>ุฅุฐู ุงูุนุฏุฏ ุงูุฃูุณุท ูู <span class="highlight-number">ูกูก</span>ุ ูุงูุฃุนุฏุงุฏ ูู <span class="highlight-number">ูกู</span>ุ <span class="highlight-number">ูกูก</span>ุ <span class="highlight-number">ูกูข</span>.</p>`
            },
            { 
              type: 'mcq', level: 'โญโญโญ', topic: 'multi-step', text: 'ุญู ุงููุนุงุฏูุฉ: <span class="math-eq flex justify-center items-center"><span class="fraction"><span>ู - ูฅ</span><span class="frac-bar"></span><span>-ูข</span></span> = ูจ</span>', 
              options: [ { display: '<span class="math-eq">-ูกูก</span>', value: '-ูกูก' }, { display: '<span class="math-eq">-ูขูก</span>', value: '-ูขูก' }, { display: '<span class="math-eq">ูขูก</span>', value: 'ูขูก' }, { display: '<span class="math-eq">ูกูก</span>', value: 'ูกูก' } ], 
              correct: '-ูกูก', 
              explanation: `<p class='mb-2'>ูุชุฎูุต ูู ุงููุณูุฉ ุฃููุงู ุซู ุงูุทุฑุญ.</p><div class='text-right space-y-2'>
                                <p>ุฃููุงู: ูุถุฑุจ ููุง ุงูุทุฑููู ูู <span class="math-eq">-ูข</span>:</p>
                                <p class="math-eq text-center flex justify-center items-center">
                                   <span class="fraction"><span>ู - ูฅ</span><span class="frac-bar"></span><span>-ูข</span></span> <span class="highlight-change">ร (-ูข)</span> = ูจ <span class="highlight-change">ร (-ูข)</span>
                                </p>
                                <p>ุซุงููุงู: ูุจุณุท:</p>
                                <p class="math-eq text-center">ู - ูฅ = -ูกูฆ</p>
                                <p>ุซุงูุซุงู: ูุถูู <span class="highlight-number">ูฅ</span> ูููุง ุงูุทุฑููู:</p>
                                <p class="math-eq text-center">ู - ูฅ <span class="highlight-change">+ ูฅ</span> = -ูกูฆ <span class="highlight-change">+ ูฅ</span></p>
                                <p>ุฑุงุจุนุงู: ุงูุญู ุงูููุงุฆู:</p>
                                <p class="math-eq text-center">ู = -ูกูก</p>
                            </div>`,
              smartExplanation: `<p>ูุง ูู ุงูุนุฏุฏ ุงูุฐู ุฅุฐุง ูุณูุชู ุนูู <span class="highlight-number">-ูข</span> ูุนุทู <span class="highlight-number">ูจ</span>ุ ุฐูููุงู ูู <span class="highlight-number">-ูกูฆ</span>.</p><p>ุฅุฐู <span class='math-eq'>ู - ูฅ = -ูกูฆ</span>.</p><p>ูุง ูู ุงูุนุฏุฏ ุงูุฐู ุฅุฐุง ุทุฑุญุช ููู <span class="highlight-number">ูฅ</span> ูุตุจุญ <span class="highlight-number">-ูกูฆ</span>ุ ูู <span class="highlight-number">-ูกูก</span>.</p>`
            },
            { 
              type: 'mcq', 
              level: 'โญโญโญ', 
              topic: 'consecutive-equation', 
              text: 'ุซูุงุซุฉ ุฃุนุฏุงุฏ <strong>ูุฑุฏูุฉ</strong> ูุชุชุงููุฉ ูุฌููุนูุง <span class="math-eq">ูงูฅ</span>. ูุง ุงููุนุงุฏูุฉ ุงูุชู ุชูุซู ูุฐู ุงููุณุฃูุฉุ (ุงูุฑุถ ุฃู ุฃุตุบุฑ ุนุฏุฏ ูู ู)', 
              options: [
                  { display: '<span class="math-eq">ู + (ู+ูก) + (ู+ูข) = ูงูฅ</span>', value: 'q1_opt1' },
                  { display: '<span class="math-eq">ู + (ู+ูข) + (ู+ูค) = ูงูฅ</span>', value: 'q1_opt2' },
                  { display: '<span class="math-eq">ูฃู = ูงูฅ</span>', value: 'q1_opt3' },
                  { display: '<span class="math-eq">ู(ู+ูข)(ู+ูค) = ูงูฅ</span>', value: 'q1_opt4' }
              ], 
              correct: 'q1_opt2', 
              explanation: `<p class='mb-2'>ูุฃู ุงูุฃุนุฏุงุฏ <strong>ูุฑุฏูุฉ</strong> ูุชุชุงููุฉุ ูุฅู ุงููุงุฑู ุจูู ูู ุนุฏุฏ ูุงูุฐู ูููู ูู <span class="highlight-number">ูข</span>. ุฅุฐุง ูุงู ุงูุนุฏุฏ ุงูุฃูู ูู <span class="math-eq">ู</span>ุ ูุงูุนุฏุฏ ุงูุซุงูู ูู <span class="math-eq">ู+ูข</span>ุ ูุงูุซุงูุซ ูู <span class="math-eq">ู+ูค</span>. ูุฌููุนูู ูู ุงููุนุงุฏูุฉ ุงูุตุญูุญุฉ.</p>`,
              smartExplanation: `<p>ูููุฉ "ูุฑุฏูุฉ ูุชุชุงููุฉ" ุชุนูู ุฃู ุงููุงุฑู ุจูู ุงูุฃุนุฏุงุฏ ูู <span class="highlight-number">ูข</span>. ูุฐููุ ูุฌุจ ุฃู ุชููู ุงูุฒูุงุฏุงุช (+ูขุ +ูค). ุงูุฎูุงุฑ (ุจ) ูู ุงููุญูุฏ ุงูุฐู ูุทุงุจู ูุฐุง ุงููุตู.</p>`
            },
            { 
              type: 'mcq', 
              level: 'โญโญ', 
              topic: 'consecutive-equation', 
              text: 'ูุง ุงููุนุงุฏูุฉ ุงูุชู ุชูุซู ุงููุณุฃูุฉ: \'ุซูุงุซุฉ ุฃุนุฏุงุฏ ุตุญูุญุฉ ูุชุชุงููุฉ ูุฌููุนูุง <span class="math-eq">ูฃูฃ</span>\'ุ', 
              options: [
                  { display: '<span class="math-eq">ูฃู = ูฃูฃ</span>', value: 'q2_opt1' },
                  { display: '<span class="math-eq">ู + (ู+ูข) + (ู+ูค) = ูฃูฃ</span>', value: 'q2_opt2' },
                  { display: '<span class="math-eq">ู + (ู+ูก) + (ู+ูข) = ูฃูฃ</span>', value: 'q2_opt3' },
                  { display: '<span class="math-eq">ู + (ู-ูก) + (ู-ูข) = ูฃูฃ</span>', value: 'q2_opt4' }
              ], 
              correct: 'q2_opt3', 
              explanation: `<p class='mb-2'>ูุฃู ุงูุฃุนุฏุงุฏ <strong>ุตุญูุญุฉ</strong> ูุชุชุงููุฉุ ูุฅู ุงููุงุฑู ุจูู ูู ุนุฏุฏ ูุงูุฐู ูููู ูู <span class="highlight-number">ูก</span>. ุฅุฐุง ูุงู ุงูุนุฏุฏ ุงูุฃูู ูู <span class="math-eq">ู</span>ุ ูุงูุนุฏุฏ ุงูุซุงูู ูู <span class="math-eq">ู+ูก</span>ุ ูุงูุซุงูุซ ูู <span class="math-eq">ู+ูข</span>. ูุฌููุนูู ูู ุงููุนุงุฏูุฉ ุงูุตุญูุญุฉ.</p><p>ุงููุนุงุฏูุฉ <span class="math-eq">ู + (ู+ูก) + (ู+ูข) = ูฃูฃ</span> ุชุจุณุท ุฅูู <span class="math-eq">ูฃู + ูฃ = ูฃูฃ</span>.</p>`,
              smartExplanation: `<p>ูููุฉ "ุตุญูุญุฉ ูุชุชุงููุฉ" ุชุนูู ุฃู ุงููุงุฑู ุจูู ุงูุฃุนุฏุงุฏ ูู <span class="highlight-number">ูก</span>. ูุฐููุ ูุฌุจ ุฃู ุชููู ุงูุฒูุงุฏุงุช (+ูกุ +ูข). ุงูุฎูุงุฑ (ุฌ) ูู ุงููุญูุฏ ุงูุฐู ูุทุงุจู ูุฐุง ุงููุตู.</p>`
            },
            { 
              type: 'mcq', 
              level: 'โญโญ', 
              topic: 'fraction-equation', 
              text: 'ุญู ุงููุนุงุฏูุฉ: <span class="math-eq"><span class="fraction"><span>ูข</span><span class="frac-bar"></span><span>ูฃ</span></span>ุณ + ูค = ูข</span>', 
              options: [
                  { display: '<span class="math-eq">-ูฃ</span>', value: '-ูฃ' },
                  { display: '<span class="math-eq">ูฃ</span>', value: 'ูฃ' },
                  { display: '<span class="math-eq">-ูฉ</span>', value: '-ูฉ' },
                  { display: '<span class="math-eq">ูฉ</span>', value: 'ูฉ' }
              ], 
              correct: '-ูฃ', 
              explanation: `<p class='mb-2'>ุฃููุงู ูุทุฑุญ <span class="highlight-number">ูค</span> ูู ุงูุทุฑููู: <span class="math-eq"><span class="fraction"><span>ูข</span><span class="frac-bar"></span><span>ูฃ</span></span>ุณ = -ูข</span>. ุซู ูุถุฑุจ ุงูุทุฑููู ูู ููููุจ ุงููุณุฑ ููู <span class="math-eq"><span class="fraction"><span>ูฃ</span><span class="frac-bar"></span><span>ูข</span></span></span>. ููููู ุงูุญู <span class="math-eq">ุณ = -ูข ร <span class="fraction"><span>ูฃ</span><span class="frac-bar"></span><span>ูข</span></span> = -ูฃ</span>.</p>`,
              smartExplanation: `<p>ูุฌุจ ุฃู ูููู ูุงุชุฌ <span class='math-eq'><span class="fraction"><span>ูข</span><span class="frac-bar"></span><span>ูฃ</span></span>ุณ</span> ูุณุงูู <span class="highlight-number">-ูข</span> ููู ูููู ุงููุฌููุน <span class="highlight-number">ูข</span>. ุจุชุฌุฑุจุฉ ุงูุฎูุงุฑ (ุฃ): <span class='math-eq'><span class="fraction"><span>ูข</span><span class="frac-bar"></span><span>ูฃ</span></span>(-ูฃ) = -ูข</span>. ุฅุฐู ุงูุญู ุตุญูุญ.</p>`
            },
            { 
              type: 'mcq', 
              level: 'โญโญโญ', 
              topic: 'distribution-equation', 
              text: 'ุญู ุงููุนุงุฏูุฉ: <span class="math-eq">ูฃ(ุณ - ูฅ) = ูกูข</span>', 
              options: [
                  { display: '<span class="math-eq">ูฉ</span>', value: 'ูฉ' },
                  { display: '<span class="math-eq">-ูก</span>', value: '-ูก' },
                  { display: '<span class="math-eq">ูฅ.ูฆ</span>', value: 'ูฅ.ูฆ' },
                  { display: '<span class="math-eq">ูขูง</span>', value: 'ูขูง' }
              ], 
              correct: 'ูฉ', 
              explanation: `<p class='mb-2'>ุฃููุงู ููุฒุน ุงูุถุฑุจ ุนูู ุงูููุณ: <span class="math-eq">ูฃุณ - ูกูฅ = ูกูข</span>. ุซู ูุถูู <span class="highlight-number">ูกูฅ</span> ููุทุฑููู: <span class="math-eq">ูฃุณ = ูขูง</span>. ุฃุฎูุฑุงู ููุณู ุนูู <span class="highlight-number">ูฃ</span> ููุฌุฏ ุฃู <span class="math-eq">ุณ = ูฉ</span>.</p>`,
              smartExplanation: `<p>ุจูุณูุฉ ุงูุทุฑููู ุนูู <span class="highlight-number">ูฃ</span>ุ ูุญุตู ุนูู <span class='math-eq'>ุณ - ูฅ = ูค</span>. ูู ุงููุงุถุญ ุฃู <span class='math-eq'>ุณ</span> ูุฌุจ ุฃู ุชุณุงูู <span class="highlight-number">ูฉ</span>.</p>`
            },
            {
              type: 'mcq',
              level: 'โญโญโญ',
              topic: 'real-life',
              text: 'ุงุดุชุฑู ุฃุญูุฏ ูู ูุงุฏู ุฑูุงุถู ุจุฑุณูู ุชุณุฌูู <span class="highlight-number">ูฅู</span> ุฑูุงูุงู ูุงุดุชุฑุงู ุดูุฑู <span class="highlight-number">ูขูฅ</span> ุฑูุงูุงู. ุฅุฐุง ูุงูุช ุงูุชูููุฉ ุงูุฅุฌูุงููุฉ ุงูุชู ุฏูุนูุง ุฃุญูุฏ ูู <span class="highlight-number">ูขูขูฅ</span> ุฑูุงูุงูุ ููุง ุนุฏุฏ ุงูุฃุดูุฑ ุงูุชู ุงุดุชุฑู ูููุงุ',
              options: [
                { display: '<span class="highlight-number">ูฆ</span> ุฃุดูุฑ', value: '6' },
                { display: '<span class="highlight-number">ูง</span> ุฃุดูุฑ', value: '7' },
                { display: '<span class="highlight-number">ูจ</span> ุฃุดูุฑ', value: '8' },
                { display: '<span class="highlight-number">ูฉ</span> ุฃุดูุฑ', value: '9' }
              ],
              correct: '7',
              explanation: `<p class='mb-2'>ุงููุนุงุฏูุฉ ูู: <span class='math-eq'>ูขูฅุณ + ูฅู = ูขูขูฅ</span>ุ ุญูุซ ุณ ูู ุนุฏุฏ ุงูุฃุดูุฑ.</p><p>ูุทุฑุญ <span class="highlight-number">ูฅู</span> ูู ุงูุทุฑููู: <span class='math-eq'>ูขูฅุณ = ูกูงูฅ</span>.</p><p>ููุณู ุงูุทุฑููู ุนูู <span class="highlight-number">ูขูฅ</span>: <span class='math-eq'>ุณ = ูง</span>.</p><p>ุฅุฐูุ ุงุดุชุฑู ุฃุญูุฏ ููุฏุฉ <span class="highlight-number">ูง</span> ุฃุดูุฑ.</p>`,
              smartExplanation: `<p>ุฃููุงู ูุฒูู ุฑุณูู ุงูุชุณุฌูู ุงูุซุงุจุชุฉ: <span class='math-eq'>ูขูขูฅ - ูฅู = ูกูงูฅ</span> ุฑูุงูุงู.</p><p>ุซู ููุณู ุงููุจูุบ ุงููุชุจูู ุนูู ุชูููุฉ ุงูุดูุฑ ุงููุงุญุฏ: <span class='math-eq'>ูกูงูฅ รท ูขูฅ = ูง</span> ุฃุดูุฑ.</p>`
            },
            {
              type: 'mcq',
              level: 'โญโญโญ',
              topic: 'distribution-negative',
              text: 'ุญู ุงููุนุงุฏูุฉ: <span class="math-eq">-ูข(ุณ + ูฃ) = -ูกูค</span>',
              options: [
                { display: '<span class="math-eq">ูค</span>', value: '4' },
                { display: '<span class="math-eq">-ูกู</span>', value: '-10' },
                { display: '<span class="math-eq">ูฅ</span>', value: '5' },
                { display: '<span class="math-eq">-ูฅ</span>', value: '-5' }
              ],
              correct: '4',
              explanation: `<p class='mb-2'>ุฃููุงูุ ููุฒุน <span class="highlight-number">-ูข</span> ุนูู ุงูููุณ: <span class='math-eq'>-ูขุณ - ูฆ = -ูกูค</span>.</p><p>ุซุงููุงูุ ูุถูู <span class="highlight-number">ูฆ</span> ููุทุฑููู: <span class='math-eq'>-ูขุณ = -ูจ</span>.</p><p>ุซุงูุซุงูุ ููุณู ุงูุทุฑููู ุนูู <span class="highlight-number">-ูข</span>: <span class='math-eq'>ุณ = ูค</span>.</p>`,
              smartExplanation: `<p>ุจูุณูุฉ ุงูุทุฑููู ุนูู <span class="highlight-number">-ูข</span>ุ ูุญุตู ุนูู <span class='math-eq'>ุณ + ูฃ = ูง</span>. ูู ุงููุงุถุญ ุฃู <span class='math-eq'>ุณ</span> ูุฌุจ ุฃู ุชุณุงูู <span class="highlight-number">ูค</span>.</p>`
            },
            {
              type: 'mcq',
              level: 'โญโญ',
              topic: 'fraction-equation',
              text: 'ุญู ุงููุนุงุฏูุฉ: <span class="math-eq">ูกู = <span class="fraction"><span>ุณ</span><span class="frac-bar"></span><span>ูค</span></span> + ูฃ</span>',
              options: [
                { display: '<span class="math-eq">ูขูจ</span>', value: '28' },
                { display: '<span class="math-eq">ูง</span>', value: '7' },
                { display: '<span class="math-eq">ูกูฃ</span>', value: '13' },
                { display: '<span class="math-eq">ูฅูข</span>', value: '52' }
              ],
              correct: '28',
              explanation: `<p class='mb-2'>ุฃููุงูุ ูุทุฑุญ <span class="highlight-number">ูฃ</span> ูู ุงูุทุฑููู: <span class='math-eq'>ูง = <span class="fraction"><span>ุณ</span><span class="frac-bar"></span><span>ูค</span></span></span>.</p><p>ุซุงููุงูุ ูุถุฑุจ ุงูุทุฑููู ูู <span class="highlight-number">ูค</span> ููุชุฎูุต ูู ุงููุณูุฉ: <span class='math-eq'>ูง ร ูค = ุณ</span>.</p><p>ุฅุฐูุ ุงูุญู ูู <span class='math-eq'>ุณ = ูขูจ</span>.</p>`,
              smartExplanation: `<p>ูุฌุจ ุฃู ูููู ุงููุณุฑ <span class='math-eq'><span class="fraction"><span>ุณ</span><span class="frac-bar"></span><span>ูค</span></span></span> ูุณุงูู <span class="highlight-number">ูง</span> ููู ูููู ุงููุฌููุน <span class="highlight-number">ูกู</span>.</p><p>ูุง ูู ุงูุนุฏุฏ ุงูุฐู ุฅุฐุง ูุณูุชู ุนูู <span class="highlight-number">ูค</span> ูุนุทู <span class="highlight-number">ูง</span>ุ ูู <span class="highlight-number">ูขูจ</span>.</p>`
            }
        ];
        const shuffled = [...questionBank].sort(() => 0.5 - Math.random()); const questionCount = Math.min(shuffled.length, 5); return shuffled.slice(0, questionCount); }
    document.addEventListener('DOMContentLoaded', () => {
        const urlParams = new URLSearchParams(window.location.search);
        const studentId = urlParams.get('studentId');
        const classId = urlParams.get('classId');

        const exampleContainers = document.querySelectorAll('[id^="interactive-container-"]');
        const state = {};
        exampleContainers.forEach(container => {
            const exampleId = container.id.split('-')[2];
            state[exampleId] = { currentIndex: -1, steps: container.querySelectorAll('.step-interactive'), placeholder: container.querySelector('.interactive-placeholder'), prevBtn: container.querySelector('.prev-btn'), nextBtn: container.querySelector('.next-btn'), resetBtn: container.querySelector('.reset-btn') };
            const resetExample = () => { state[exampleId].steps.forEach(step => step.classList.remove('active')); state[exampleId].currentIndex = -1; if (state[exampleId].placeholder) { state[exampleId].placeholder.classList.remove('hidden'); } updateButtons(); };
            const updateButtons = () => { const isFirstStep = state[exampleId].currentIndex <= -1; const isLastStep = state[exampleId].currentIndex >= state[exampleId].steps.length - 1; state[exampleId].prevBtn.disabled = isFirstStep; if (isLastStep) { state[exampleId].nextBtn.classList.add('hidden'); state[exampleId].resetBtn.classList.remove('hidden'); } else { state[exampleId].nextBtn.classList.remove('hidden'); state[exampleId].resetBtn.classList.add('hidden'); } };
            
            state[exampleId].nextBtn.addEventListener('click', () => {
                if (state[exampleId].currentIndex < state[exampleId].steps.length - 1) {
                    if (state[exampleId].currentIndex === -1 && state[exampleId].placeholder) {
                        state[exampleId].placeholder.classList.add('hidden');
                    }
                    state[exampleId].currentIndex++;
                    state[exampleId].steps[state[exampleId].currentIndex].classList.add('active');
                    updateButtons();
                }
            });
            state[exampleId].prevBtn.addEventListener('click', () => {
                if (state[exampleId].currentIndex > -1) {
                    state[exampleId].steps[state[exampleId].currentIndex].classList.remove('active');
                    state[exampleId].currentIndex--;
                     if (state[exampleId].currentIndex === -1 && state[exampleId].placeholder) {
                        state[exampleId].placeholder.classList.remove('hidden');
                    }
                    updateButtons();
                }
            });

            if(state[exampleId].resetBtn) { state[exampleId].resetBtn.addEventListener('click', resetExample); }
            updateButtons();
        });

        const student = getStudentFromStorage();
        const lessonTitleElement = document.getElementById('lesson-title');
        const lessonTitle = lessonTitleElement ? lessonTitleElement.textContent : null;
        buildHeader(student, lessonTitle, studentId, classId);
        buildFooter();
        const questions = generateQuiz();
        initializeQuiz(LESSON_ID, questions, student, studentId);
        const retakeBtn = document.getElementById('retake-quiz-btn');
        if(retakeBtn) { retakeBtn.addEventListener('click', () => { window.location.reload(); }); }
        
        const closeModalBtn = document.getElementById('closeModalBtn');
        if(closeModalBtn) closeModalBtn.addEventListener('click', closeModal);
        
        const closeSmartModalBtn = document.getElementById('closeSmartModalBtn');
        if(closeSmartModalBtn) closeSmartModalBtn.addEventListener('click', closeSmartModal);
    });
    </script>
</body>
</html>
