<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø§Ù„ØªØ´Ø®ÙŠØµÙŠØ©</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #3498db; --secondary: #2ecc71; --accent: #f1c40f;
            --light: #fdfdfd; --dark: #34495e; --bg-color: #ecf0f1;
            --card-bg: #ffffff; --text-color: #4a4a4a; --header-gradient: linear-gradient(135deg, var(--primary), var(--secondary));
            --score-high: #2ecc71; --score-medium: #f1c40f; --score-low: #e74c3c;
            --points-color: #9b59b6;
        }
        
        body { 
            font-family: 'Cairo', sans-serif; 
            background-color: var(--bg-color); 
            color: var(--text-color); 
            line-height: 1.7; 
            margin: 0;
            padding: 0;
        }

        .screen { display: none; }
        .screen.active { display: block; animation: zoomIn 0.6s ease-in-out; }

        @keyframes zoomIn { 
            from { opacity: 0; transform: scale(0.95); } 
            to { opacity: 1; transform: scale(1); } 
        }

        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px; 
        }

        header {
            background: var(--header-gradient); 
            color: white; 
            padding: 2.5rem 1rem; 
            text-align: center;
            border-radius: 0 0 35px 35px; 
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1); 
            margin-bottom: 2rem;
            position: relative; 
            overflow: hidden;
        }

        header::before {
            content: '\f1ec'; 
            font-family: 'Font Awesome 6 Free'; 
            font-weight: 900;
            position: absolute; 
            top: -20px; 
            left: -30px; 
            font-size: 150px; 
            opacity: 0.1; 
            transform: rotate(-15deg);
        }

        header::after {
            content: '\f518'; 
            font-family: 'Font Awesome 6 Free'; 
            font-weight: 900;
            position: absolute; 
            bottom: -30px; 
            right: -20px; 
            font-size: 150px; 
            opacity: 0.1; 
            transform: rotate(15deg);
        }

        header h1 { 
            font-size: 2.8rem; 
            font-weight: 800; 
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2); 
            margin: 0;
        }

        header p { 
            font-size: 1.3rem; 
            opacity: 0.9; 
            margin-top: 0.5rem; 
            margin-bottom: 0;
        }

        .welcome-container, .dashboard-container, .test-section { 
            background: var(--card-bg); 
            padding: 2.5rem; 
            border-radius: 20px; 
            box-shadow: 0 8px 25px rgba(0,0,0,0.08); 
        }

        .btn {
            background-color: var(--primary); 
            color: white; 
            padding: 1rem 3rem; 
            border: none;
            border-radius: 50px; 
            font-size: 1.2rem; 
            font-weight: 700; 
            cursor: pointer;
            transition: all 0.3s ease; 
            display: inline-flex; 
            align-items: center; 
            gap: 0.75rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 0.5rem;
            text-decoration: none;
        }

        .btn:hover { 
            transform: translateY(-4px); 
            box-shadow: 0 6px 15px rgba(0,0,0,0.2); 
        }

        .btn:active { 
            transform: translateY(-1px); 
        }

        .btn-secondary {
            background-color: #95a5a6;
        }

        .btn-secondary:hover {
            background-color: #7f8c8d;
        }

        .dashboard-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(340px, 1fr)); 
            gap: 2rem; 
            margin-top: 2rem; 
        }

        .quiz-card {
            background: var(--card-bg); 
            border-radius: 20px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.06); 
            transition: all 0.3s ease;
            display: flex; 
            flex-direction: column; 
            overflow: hidden;
        }

        .quiz-card:hover { 
            transform: translateY(-8px); 
            box-shadow: 0 12px 30px rgba(0,0,0,0.12); 
        }

        .quiz-card-header { 
            padding: 1.5rem; 
            background: var(--primary); 
            color: white; 
            text-align: center; 
        }

        .quiz-card-header h3 { 
            font-size: 1.6rem; 
            margin: 0; 
        }

        .quiz-card-body { 
            padding: 1.5rem; 
            flex-grow: 1; 
            text-align: center; 
        }

        .best-score-container { 
            margin-bottom: 1rem; 
            padding-bottom: 1rem; 
            border-bottom: 2px dashed #eee; 
        }

        .best-score-container h4 { 
            margin: 0; 
            color: var(--dark); 
            font-size: 1rem; 
        }

        .best-score-container p { 
            font-size: 2rem; 
            font-weight: 800; 
            color: var(--primary); 
            margin: 0.25rem 0 0; 
        }

        .levels-container { 
            display: flex; 
            justify-content: space-around; 
            align-items: flex-start; 
            margin-top: 1rem; 
        }

        .level-wrapper {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .level-bubble {
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center;
            width: 80px; 
            height: 80px; 
            border-radius: 50%; 
            border: 3px solid #eee;
            cursor: pointer; 
            transition: all 0.3s ease;
        }

        .level-bubble:hover { 
            transform: scale(1.1); 
            border-color: var(--primary); 
        }

        .level-bubble .level-name { 
            font-size: 0.9rem; 
            font-weight: 700; 
        }

        .level-bubble .level-score { 
            font-size: 1.1rem; 
            font-weight: 800; 
            display: flex; 
            align-items: center; 
            gap: 0.3rem; 
        }

        .level-bubble .level-score.not-completed { 
            color: #aaa; 
            font-size: 0.8rem; 
        }

        .level-bubble .score-high { color: var(--score-high); }
        .level-bubble .score-medium { color: var(--score-medium); }
        .level-bubble .score-low { color: var(--score-low); }

        .level-stars {
            position: absolute;
            bottom: -8px;
            left: -8px;
            font-size: 1rem;
            color: var(--accent);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
            transform: rotate(-20deg);
            letter-spacing: 1px;
            pointer-events: none;
        }

        .final-average { 
            margin: 2rem 0; 
            padding: 2.5rem; 
            background: var(--header-gradient); 
            color: white; 
            border-radius: 20px; 
            text-align: center; 
            display: none; 
        }

        .final-average h2 { 
            font-size: 2.2rem; 
            margin-bottom: 0.5rem; 
        }

        .final-average p { 
            font-size: 2.8rem; 
            font-weight: 800; 
        }
        
        .quiz-header {
            text-align: center; 
            margin-bottom: 2rem; 
        }

        .quiz-meta {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .question-counter, .time-counter { 
            font-size: 1.2rem; 
            font-weight: 600; 
            color: #777; 
            padding: 0.5rem 1rem; 
            background: #eee; 
            border-radius: 20px; 
            display: inline-block;
        }

        .time-counter.warning {
            background-color: #f39c12;
            color: white;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .question-text { 
            font-size: 2rem; 
            margin: 1rem 0; 
            min-height: 70px; 
            color: var(--dark); 
        }

        .options-grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 1.5rem; 
        }

        .option {
            background: var(--card-bg); 
            padding: 1.5rem; 
            border: 2px solid #ddd; 
            border-radius: 15px;
            cursor: pointer; 
            transition: all 0.3s ease; 
            font-size: 1.3rem;
            display: flex; 
            align-items: center; 
            justify-content: center;
        }

        .option:hover { 
            border-color: var(--primary); 
            transform: scale(1.05); 
        }

        .option.selected { 
            border-color: var(--secondary); 
            background-color: #e8f9f5; 
            transform: scale(1.05); 
        }

        .option.correct { 
            background-color: #d4edda; 
            border-color: var(--score-high); 
            transform: scale(1.05); 
            animation: correct-answer 0.5s ease; 
        }

        .option.incorrect { 
            background-color: #f8d7da; 
            border-color: var(--score-low); 
            animation: incorrect-answer 0.5s ease; 
        }

        @keyframes correct-answer { 
            0%, 100% { transform: scale(1.05); } 
            50% { transform: scale(1.1); } 
        }

        @keyframes incorrect-answer { 
            0%, 100% { transform: translateX(0); } 
            25% { transform: translateX(-10px); } 
            75% { transform: translateX(10px); } 
        }

        .quiz-nav { 
            margin-top: 2rem; 
            display: flex; 
            justify-content: center;
            gap: 1rem;
        }

        .explanation { 
            margin-top: 2rem; 
            padding: 1.5rem; 
            background-color: #fffbe6; 
            border-right: 5px solid var(--accent); 
            border-radius: 10px; 
            text-align: right; 
            display: none; 
        }

        .explanation h4 { 
            font-size: 1.3rem; 
            color: var(--accent); 
            margin-bottom: 0.5rem; 
        }

        .result-box { 
            text-align: center; 
            padding: 3rem; 
            position: relative; 
        }

        .result-box .result-icon { 
            font-size: 8rem; 
            color: var(--accent); 
            margin-bottom: 1rem; 
            animation: trophy-animation 1s ease-out; 
        }

        @keyframes trophy-animation { 
            from { transform: translateY(-50px) scale(0.5); opacity: 0; } 
            to { transform: translateY(0) scale(1); opacity: 1; } 
        }

        .result-box h2 { 
            font-size: 2.8rem; 
            color: var(--primary); 
        }

        .result-box p { 
            font-size: 3.5rem; 
            font-weight: 800; 
            color: var(--secondary); 
            margin: 1rem 0; 
        }

        .points-earned {
            font-size: 1.5rem;
            color: var(--points-color);
            margin: 1rem 0;
            font-weight: bold;
        }

        .fraction { 
            display: inline-flex; 
            flex-direction: column; 
            align-items: center; 
            vertical-align: middle; 
            margin: 0 0.2em; 
            line-height: 1; 
        }

        .fraction .numerator { 
            border-bottom: 2px solid; 
            padding: 0 0.2em; 
        }

        .fraction .denominator { 
            padding: 0.1em 0.2em; 
        }

        .footer {
            background-color: var(--dark);
            color: white;
            padding: 1.5rem 0;
            text-align: center;
            margin-top: 2rem;
        }

        .footer .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        @media (max-width: 768px) {
            .options-grid {
                grid-template-columns: 1fr;
            }
            
            header h1 {
                font-size: 2rem;
            }
            
            header p {
                font-size: 1.1rem;
            }
            
            .quiz-card {
                margin-bottom: 1.5rem;
            }
            
            .btn {
                padding: 0.8rem 1.5rem;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="main-content">
        <!-- This screen is now just a fallback -->
        <div id="welcome-screen" class="screen active">
             <header><h1><i class="fas fa-rocket"></i> Ø§Ù†Ø·Ù„Ù‚ ÙÙŠ Ø±Ø­Ù„Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª!</h1><p>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…Ù†ØµØ© ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</p></header>
            <div class="container"><div class="welcome-container" style="text-align: center;">
                <h2>Ø®Ø·Ø£!</h2><p>Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø±Ù‚Ù… Ø§Ù„Ø·Ø§Ù„Ø¨. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©.</p>
            </div></div>
        </div>
        
        <div id="dashboard-screen" class="screen">
            <header><h1 id="dashboard-title"></h1><p id="dashboard-subtitle">Ø§Ø®ØªØ± Ù…Ù‡Ø§Ø±Ø© Ù„ØªØ¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</p></header>
            <div class="container">
                <div class="final-average" id="final-average-box"></div>
                <div class="dashboard-grid" id="dashboard-grid"></div>
            </div>
        </div>

        <div id="quiz-screen" class="screen">
             <header><h1 id="quiz-title"></h1></header>
            <div class="container"><div class="test-section">
                <div class="quiz-header">
                    <div class="quiz-meta">
                        <p class="question-counter" id="question-counter"></p>
                        <p class="time-counter" id="time-counter"></p>
                    </div>
                    <p class="question-text" id="question-text"></p>
                </div>
                <div class="options-grid" id="options-grid"></div>
                <div class="explanation" id="explanation-box"><h4><i class="fas fa-lightbulb"></i> Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø­Ù„:</h4><p id="explanation-text"></p></div>
                <div class="quiz-nav">
                    <button id="next-question-btn" class="btn"><i class="fas fa-arrow-left"></i> Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ</button>
                </div>
            </div></div>
        </div>

        <div id="result-screen" class="screen">
            <header><h1>Ù†ØªÙŠØ¬Ø© Ø§Ù„ØªØ­Ø¯ÙŠ</h1></header>
            <div class="container"><div class="welcome-container result-box">
                <i id="result-icon" class="fas"></i>
                <h2 id="result-title"></h2>
                <p id="result-score"></p>
                <p id="result-points" class="points-earned"></p>
                <button id="back-to-dashboard-btn" class="btn"><i class="fas fa-th-large"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª</button>
                <button id="retry-from-result-btn" class="btn btn-secondary"><i class="fas fa-redo"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
            </div></div>
        </div>
    </div>
    <footer class="footer"><div class="container"><p>&copy; Ù¢Ù Ù¢Ù¤ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø§Ù„ØªØ´Ø®ÙŠØµÙŠ | Ø¥Ø¹Ø¯Ø§Ø¯: Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ø¨Ù„Ø§Ù†</p></div></footer>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- CONFIGURATION ---
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzrf1-At3Pq7i39bGV3F1iD3-b0G-WWyRi5cgpKeQjyn_N5fh2EmGhoyRKUsbLd-F_UJQ/exec";
        
        // --- DOM Elements ---
        const screens = { 
            welcome: document.getElementById('welcome-screen'), 
            dashboard: document.getElementById('dashboard-screen'), 
            quiz: document.getElementById('quiz-screen'), 
            result: document.getElementById('result-screen') 
        };
        const dashboardGrid = document.getElementById('dashboard-grid');
        const dashboardTitle = document.getElementById('dashboard-title');
        const quizTitle = document.getElementById('quiz-title');
        const questionCounter = document.getElementById('question-counter');
        const timeCounter = document.getElementById('time-counter');
        const questionText = document.getElementById('question-text');
        const optionsGrid = document.getElementById('options-grid');
        const nextQuestionBtn = document.getElementById('next-question-btn');
        const resultTitle = document.getElementById('result-title');
        const resultScore = document.getElementById('result-score');
        const resultIcon = document.getElementById('result-icon');
        const resultPoints = document.getElementById('result-points');
        const backToDashboardBtn = document.getElementById('back-to-dashboard-btn');
        const retryFromResultBtn = document.getElementById('retry-from-result-btn');
        const finalAverageBox = document.getElementById('final-average-box');
        const explanationBox = document.getElementById('explanation-box');
        const explanationText = document.getElementById('explanation-text');

        // --- State ---
        let studentId = '';
        let currentQuizId = null;
        let currentDifficulty = null;
        let currentQuestionIndex = 0;
        let currentModel = [];
        let score = 0;
        let quizData = {};
        let timer = null;
        let timeLeft = 0;

        // --- Data (Questions) ---
        const quizzes = {
            arithmetic: {
                title: 'Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ ÙˆØ§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø­Ø³Ø§Ø¨ÙŠØ©',
                levels: {
                    easy: [
                        [{ q: 'Ù†Ø§ØªØ¬ Ø¬Ù…Ø¹ Ù¢ + Ù¥ ÙŠØ³Ø§ÙˆÙŠ:', o: ['Ù¦', 'Ù§', 'Ù¨', 'Ù©'], a: 1, exp: 'Ø¹Ù†Ø¯ Ø¥Ø¶Ø§ÙØ© Ù¥ Ø¥Ù„Ù‰ Ù¢ØŒ Ù†Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ù§.' }, { q: 'Ø£ÙŠ Ø¹Ø¯Ø¯ ÙŠØ£ØªÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø¹Ø¯Ø¯ Ù©ØŸ', o: ['Ù¨', 'Ù¡Ù¡', 'Ù§', 'Ù¡Ù '], a: 3, exp: 'ÙÙŠ Ø®Ø· Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ØŒ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø°ÙŠ ÙŠÙ„ÙŠ Ù© Ù…Ø¨Ø§Ø´Ø±Ø© Ù‡Ùˆ Ù¡Ù .' }, { q: 'ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„ØªÙØ§Ø­Ø§Øª ÙÙŠ Ø§Ù„ØµÙˆØ±Ø©: ğŸğŸğŸğŸ', o: ['Ø«Ù„Ø§Ø«Ø©', 'Ø®Ù…Ø³Ø©', 'Ø£Ø±Ø¨Ø¹Ø©', 'Ø³ØªØ©'], a: 2, exp: 'Ø¨Ø¨Ø³Ø§Ø·Ø© Ù†Ø¹Ø¯ Ø§Ù„ØªÙØ§Ø­Ø§Øª Ù„Ù†Ø¬Ø¯ Ø£Ù†Ù‡Ø§ Ø£Ø±Ø¨Ø¹.' }, { q: 'Ù†Ø§ØªØ¬ Ø·Ø±Ø­ Ù¨ - Ù£ ÙŠØ³Ø§ÙˆÙŠ:', o: ['Ù¥', 'Ù¦', 'Ù¤', 'Ù§'], a: 0, exp: 'Ø¹Ù†Ø¯Ù…Ø§ Ù†Ø£Ø®Ø° Ù£ Ù…Ù† Ù¨ØŒ ÙŠØªØ¨Ù‚Ù‰ Ù„Ø¯ÙŠÙ†Ø§ Ù¥.' }],
                    ],
                    medium: [
                        [{ q: 'Ù†Ø§ØªØ¬ Ø¶Ø±Ø¨ Ù¦ Ã— Ù§ ÙŠØ³Ø§ÙˆÙŠ:', o: ['Ù¡Ù£', 'Ù¤Ù¨', 'Ù£Ù¦', 'Ù¤Ù¢'], a: 3, exp: 'Ù…Ù† Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¶Ø±Ø¨ØŒ Ù†Ø¹Ù„Ù… Ø£Ù† Ø­Ø§ØµÙ„ Ø¶Ø±Ø¨ Ù¦ ÙÙŠ Ù§ Ù‡Ùˆ Ù¤Ù¢.' }, { q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙÙ‚ÙˆØ¯ ÙÙŠ Ø§Ù„Ù†Ù…Ø·: Ù¥ØŒ Ù¡Ù ØŒ Ù¡Ù¥ØŒ __ØŒ Ù¢Ù¥ØŸ', o: ['Ù¡Ù¦', 'Ù¢Ù ', 'Ù¡Ù¨', 'Ù¢Ù¤'], a: 1, exp: 'Ù‡Ø°Ø§ Ø§Ù„Ù†Ù…Ø· ÙŠÙ…Ø«Ù„ Ø§Ù„Ù‚ÙØ² Ø¨Ù…Ù‚Ø¯Ø§Ø± Ù¥ ÙÙŠ ÙƒÙ„ Ù…Ø±Ø©. Ø¨Ø¹Ø¯ Ù¡Ù¥ØŒ ÙŠØ£ØªÙŠ Ø§Ù„Ø¹Ø¯Ø¯ Ù¢Ù .' }, { q: 'Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø¯ÙŠÙƒ Ù£Ù  Ø±ÙŠØ§Ù„Ø§Ù‹ØŒ ÙˆØ§Ø´ØªØ±ÙŠØª Ù„Ø¹Ø¨Ø© Ø¨Ø³Ø¹Ø± Ù¡Ù¢ Ø±ÙŠØ§Ù„Ø§Ù‹ØŒ ÙƒÙ… ÙŠØªØ¨Ù‚Ù‰ Ù…Ø¹ÙƒØŸ', o: ['Ù¡Ù¨ Ø±ÙŠØ§Ù„', 'Ù¢Ù¨ Ø±ÙŠØ§Ù„', 'Ù¤Ù¢ Ø±ÙŠØ§Ù„', 'Ù¡Ù¥ Ø±ÙŠØ§Ù„'], a: 0, exp: 'Ù†Ù‚ÙˆÙ… Ø¨Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø·Ø±Ø­: Ù£Ù  - Ù¡Ù¢ = Ù¡Ù¨ Ø±ÙŠØ§Ù„Ø§Ù‹.' }, { q: 'Ø§Ù„ÙƒØ³Ø± Ø§Ù„Ø°ÙŠ ÙŠÙ…Ø«Ù„ Ø§Ù„Ù†ØµÙ Ù‡Ùˆ:', o: ['<span class="fraction"><span class="numerator">Ù¡</span><span class="denominator">Ù¤</span></span>', '<span class="fraction"><span class="numerator">Ù¡</span><span class="denominator">Ù£</span></span>', '<span class="fraction"><span class="numerator">Ù¡</span><span class="denominator">Ù¢</span></span>', '<span class="fraction"><span class="numerator">Ù£</span><span class="denominator">Ù¤</span></span>'], a: 2, exp: 'Ø§Ù„ÙƒØ³Ø± Ù¡/Ù¢ Ù‡Ùˆ Ø§Ù„Ø°ÙŠ ÙŠÙ…Ø«Ù„ Ù†ØµÙ Ø§Ù„Ø´ÙŠØ¡ Ø¨Ø§Ù„Ø¶Ø¨Ø·.' }],
                    ],
                    hard: [
                        [{ q: 'Ù…Ø§ Ù‡Ùˆ Ù†Ø§ØªØ¬ Ù‚Ø³Ù…Ø© Ù¤Ù¥Ù¥ Ã· Ù¥ ØŸ', o: ['Ù©Ù¡', 'Ù¨Ù¡', 'Ù©Ù¥', 'Ù¡Ù Ù¡'], a: 0, exp: 'Ù¤Ù¥ Ù‚Ø³Ù…Ø© Ù¥ Ù‡ÙŠ Ù©ØŒ Ùˆ Ù¥ Ù‚Ø³Ù…Ø© Ù¥ Ù‡ÙŠ Ù¡. Ø¥Ø°Ù† Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù‡ÙŠ Ù©Ù¡.' }, { q: 'Ù†Ø§ØªØ¬ Ø·Ø±Ø­ Ù©.Ù¥ - Ù£.Ù¢ ÙŠØ³Ø§ÙˆÙŠ:', o: ['Ù¦.Ù§', 'Ù¦.Ù¥', 'Ù§.Ù£', 'Ù¦.Ù£'], a: 3, exp: 'Ù†Ø·Ø±Ø­ Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„Ø¹Ø´Ø±ÙŠØ© (Ù¥-Ù¢=Ù£) Ø«Ù… Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØµØ­ÙŠØ­Ø© (Ù©-Ù£=Ù¦)ØŒ ÙØªÙƒÙˆÙ† Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù¦.Ù£.' }, { q: 'Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ù¢Ù¤ Ø·Ø§Ù„Ø¨Ø§Ù‹ ÙÙŠ Ø§Ù„ÙØµÙ„ØŒ Ùˆ <span class="fraction"><span class="numerator">Ù¡</span><span class="denominator">Ù¤</span></span> Ù…Ù†Ù‡Ù… ØºØ§Ø¦Ø¨ÙˆÙ†ØŒ ÙÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„ØºØ§Ø¦Ø¨ÙŠÙ†ØŸ', o: ['Ù¤', 'Ù¨', 'Ù¦', 'Ù¡Ù¢'], a: 2, exp: 'Ù„Ø¥ÙŠØ¬Ø§Ø¯ Ø±Ø¨Ø¹ Ø¹Ø¯Ø¯ØŒ Ù†Ù‚Ø³Ù…Ù‡ Ø¹Ù„Ù‰ Ù¤. Ù¢Ù¤ Ã· Ù¤ = Ù¦ Ø·Ù„Ø§Ø¨.' }, { q: 'Ù…Ø§ Ù‡Ùˆ Ù†Ø§ØªØ¬ (Ù¤ + Ù¦) Ã— Ù£ ØŸ', o: ['Ù¢Ù¢', 'Ù¡Ù£', 'Ù¡Ù¨', 'Ù£Ù '], a: 3, exp: 'Ù†ØªØ¨Ø¹ ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§ØªØŒ ÙÙ†Ø­Ø³Ø¨ Ù…Ø§ Ø¨Ø¯Ø§Ø®Ù„ Ø§Ù„Ø£Ù‚ÙˆØ§Ø³ Ø£ÙˆÙ„Ø§Ù‹: (Ù¤+Ù¦) = Ù¡Ù . Ø«Ù… Ù†Ø¶Ø±Ø¨: Ù¡Ù  Ã— Ù£ = Ù£Ù .' }],
                    ]
                }
            },
            geometry: {
                title: 'Ø§Ù„Ù‡Ù†Ø¯Ø³Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©',
                levels: {
                    easy: [
                        [{ q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ù‡Ø°Ø§ Ø§Ù„Ø´ÙƒÙ„: ğŸŸ¥ ØŸ', o: ['Ø¯Ø§Ø¦Ø±Ø©', 'Ù…Ø«Ù„Ø«', 'Ù…Ø±Ø¨Ø¹', 'Ù†Ø¬Ù…Ø©'], a: 2, exp: 'Ù‡Ø°Ø§ Ø§Ù„Ø´ÙƒÙ„ Ù„Ù‡ Ø£Ø±Ø¨Ø¹Ø© Ø£Ø¶Ù„Ø§Ø¹ Ù…ØªØ³Ø§ÙˆÙŠØ© ÙˆØ£Ø±Ø¨Ø¹ Ø²ÙˆØ§ÙŠØ§ Ù‚Ø§Ø¦Ù…Ø©ØŒ Ù„Ø°Ø§ Ù‡Ùˆ Ù…Ø±Ø¨Ø¹.' }, { q: 'ÙƒÙ… Ø¹Ø¯Ø¯ Ø£Ø¶Ù„Ø§Ø¹ Ø§Ù„Ù…Ø«Ù„Ø«ØŸ', o: ['Ø«Ù„Ø§Ø«Ø©', 'Ø£Ø±Ø¨Ø¹Ø©', 'Ø®Ù…Ø³Ø©', 'Ø³ØªØ©'], a: 0, exp: 'Ø§Ù„Ù…Ø«Ù„Ø«ØŒ ÙƒÙ…Ø§ ÙŠØªØ¶Ø­ Ù…Ù† Ø§Ø³Ù…Ù‡ØŒ Ù„Ù‡ Ø«Ù„Ø§Ø«Ø© Ø£Ø¶Ù„Ø§Ø¹.' }, { q: 'Ø£ÙŠ Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ ÙŠØ´Ø¨Ù‡ Ø§Ù„Ø¯Ø§Ø¦Ø±Ø©ØŸ', o: ['Ø¨Ø§Ø¨', 'ÙƒØªØ§Ø¨', 'Ø¹Ø¬Ù„Ø© Ø§Ù„Ø³ÙŠØ§Ø±Ø©', 'Ø·Ø§ÙˆÙ„Ø©'], a: 2, exp: 'Ø¹Ø¬Ù„Ø© Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ù‡ÙŠ Ø£ÙØ¶Ù„ Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„Ø¯Ø§Ø¦Ø±ÙŠ Ù…Ù† Ø¨ÙŠÙ† Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª.' }, { q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„Ø°ÙŠ Ù„ÙŠØ³ Ù„Ù‡ Ø²ÙˆØ§ÙŠØ§ Ø­Ø§Ø¯Ø©ØŸ', o: ['Ø§Ù„Ù…Ø«Ù„Ø«', 'Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„', 'Ø§Ù„Ù†Ø¬Ù…Ø©', 'Ø§Ù„Ø³Ù‡Ù…'], a: 1, exp: 'Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø²ÙˆØ§ÙŠØ§Ù‡ Ù‚Ø§Ø¦Ù…Ø© (Ù©Ù  Ø¯Ø±Ø¬Ø©)ØŒ ÙˆÙ„ÙŠØ³Øª Ø­Ø§Ø¯Ø©.' }]
                    ],
                    medium: [
                        [{ q: 'Ù…Ø§ Ù‡Ùˆ Ù…Ø­ÙŠØ· Ù…Ø±Ø¨Ø¹ Ø·ÙˆÙ„ Ø¶Ù„Ø¹Ù‡ Ù£ Ø³Ù…ØŸ', o: ['Ù¦ Ø³Ù…', 'Ù© Ø³Ù…', 'Ù¡Ù¢ Ø³Ù…', 'Ù£ Ø³Ù…'], a: 2, exp: 'Ù…Ø­ÙŠØ· Ø§Ù„Ù…Ø±Ø¨Ø¹ = Ø·ÙˆÙ„ Ø§Ù„Ø¶Ù„Ø¹ Ã— Ù¤. Ø¥Ø°Ù† Ù£ Ã— Ù¤ = Ù¡Ù¢ Ø³Ù….' }, { q: 'ÙƒÙ… Ø¹Ø¯Ø¯ Ø±Ø¤ÙˆØ³ Ø§Ù„Ù…ÙƒØ¹Ø¨ØŸ', o: ['Ù¤', 'Ù¦', 'Ù¨', 'Ù¡Ù¢'], a: 2, exp: 'Ø§Ù„Ù…ÙƒØ¹Ø¨ Ù„Ù‡ Ù¨ Ø±Ø¤ÙˆØ³ (Ø²ÙˆØ§ÙŠØ§).' }, { q: 'Ø§Ù„Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªÙŠ ØªØ´Ø¨Ù‡ Ø²Ø§ÙˆÙŠØ© ÙˆØ±Ù‚Ø© Ø§Ù„ÙƒØªØ§Ø¨ ØªØ³Ù…Ù‰ Ø²Ø§ÙˆÙŠØ©:', o: ['Ø­Ø§Ø¯Ø©', 'Ù…Ù†ÙØ±Ø¬Ø©', 'Ù…Ø³ØªÙ‚ÙŠÙ…Ø©', 'Ù‚Ø§Ø¦Ù…Ø©'], a: 3, exp: 'Ø²Ø§ÙˆÙŠØ© Ø±ÙƒÙ† Ø§Ù„ÙƒØªØ§Ø¨ Ù‡ÙŠ Ù…Ø«Ø§Ù„ Ù…Ù…ØªØ§Ø² Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªÙŠ Ù‚ÙŠØ§Ø³Ù‡Ø§ Ù©Ù  Ø¯Ø±Ø¬Ø©.' }, { q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…Ø¬Ø³Ù… Ø§Ù„Ø°ÙŠ ÙŠØ´Ø¨Ù‡ Ø¹Ù„Ø¨Ø© Ø§Ù„Ø£Ø­Ø°ÙŠØ©ØŸ', o: ['Ù…ÙƒØ¹Ø¨', 'Ù…ØªÙˆØ§Ø²ÙŠ Ù…Ø³ØªØ·ÙŠÙ„Ø§Øª', 'Ù‡Ø±Ù…', 'Ø£Ø³Ø·ÙˆØ§Ù†Ø©'], a: 1, exp: 'Ø¹Ù„Ø¨Ø© Ø§Ù„Ø£Ø­Ø°ÙŠØ© Ù‡ÙŠ Ù…Ø«Ø§Ù„ Ø´Ø§Ø¦Ø¹ Ø¹Ù„Ù‰ Ù…Ø¬Ø³Ù… Ù…ØªÙˆØ§Ø²ÙŠ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„Ø§Øª.' }]
                    ],
                    hard: [
                        [{ q: 'Ù…Ø§ Ù‡ÙŠ Ù…Ø³Ø§Ø­Ø© Ù…Ø³ØªØ·ÙŠÙ„ Ø·ÙˆÙ„Ù‡ Ù¡Ù  Ø³Ù… ÙˆØ¹Ø±Ø¶Ù‡ Ù¥ Ø³Ù…ØŸ', o: ['Ù¡Ù¥ Ø³Ù…Â²', 'Ù£Ù  Ø³Ù…Â²', 'Ù¥Ù  Ø³Ù…Â²', 'Ù¡Ù Ù  Ø³Ù…Â²'], a: 2, exp: 'Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„ = Ø§Ù„Ø·ÙˆÙ„ Ã— Ø§Ù„Ø¹Ø±Ø¶. Ø¥Ø°Ù† Ù¡Ù  Ã— Ù¥ = Ù¥Ù  Ø³Ù…Â².' }, { q: 'Ù…Ø§ Ù‡Ùˆ Ù…Ø¬Ù…ÙˆØ¹ Ø²ÙˆØ§ÙŠØ§ Ø£ÙŠ Ø´ÙƒÙ„ Ø±Ø¨Ø§Ø¹ÙŠØŸ', o: ['Ù©Ù  Ø¯Ø±Ø¬Ø©', 'Ù¡Ù¨Ù  Ø¯Ø±Ø¬Ø©', 'Ù¢Ù§Ù  Ø¯Ø±Ø¬Ø©', 'Ù£Ù¦Ù  Ø¯Ø±Ø¬Ø©'], a: 3, exp: 'Ù…Ø¬Ù…ÙˆØ¹ Ù‚ÙŠØ§Ø³Ø§Øª Ø§Ù„Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© Ù„Ø£ÙŠ Ø´ÙƒÙ„ Ø±Ø¨Ø§Ø¹ÙŠ (Ù…Ø«Ù„ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø£Ùˆ Ø§Ù„Ù…Ø³ØªØ·ÙŠÙ„) Ù‡Ùˆ Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ù£Ù¦Ù  Ø¯Ø±Ø¬Ø©.' }, { q: 'Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø­ÙŠØ· Ù…Ø«Ù„Ø« Ù…ØªØ³Ø§ÙˆÙŠ Ø§Ù„Ø£Ø¶Ù„Ø§Ø¹ Ù‡Ùˆ Ù¢Ù¡ Ø³Ù…ØŒ ÙÙ…Ø§ Ø·ÙˆÙ„ ÙƒÙ„ Ø¶Ù„Ø¹ØŸ', o: ['Ù£ Ø³Ù…', 'Ù§ Ø³Ù…', 'Ù¢Ù¡ Ø³Ù…', 'Ù¦Ù£ Ø³Ù…'], a: 1, exp: 'Ø¨Ù…Ø§ Ø£Ù† Ø§Ù„Ø£Ø¶Ù„Ø§Ø¹ Ù…ØªØ³Ø§ÙˆÙŠØ©ØŒ Ù†Ù‚Ø³Ù… Ø§Ù„Ù…Ø­ÙŠØ· Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¶Ù„Ø§Ø¹ (Ù£). Ù¢Ù¡ Ã· Ù£ = Ù§ Ø³Ù….' }, { q: 'Ù…Ø§ Ù‡Ùˆ Ø­Ø¬Ù… Ù…ÙƒØ¹Ø¨ Ø·ÙˆÙ„ Ø­Ø±ÙÙ‡ Ù¤ Ø³Ù…ØŸ', o: ['Ù¡Ù¢ Ø³Ù…Â³', 'Ù¡Ù¦ Ø³Ù…Â³', 'Ù£Ù¢ Ø³Ù…Â³', 'Ù¦Ù¤ Ø³Ù…Â³'], a: 3, exp: 'Ø­Ø¬Ù… Ø§Ù„Ù…ÙƒØ¹Ø¨ = Ø·ÙˆÙ„ Ø§Ù„Ø­Ø±Ù Ã— Ù†ÙØ³Ù‡ Ã— Ù†ÙØ³Ù‡. Ø¥Ø°Ù† Ù¤ Ã— Ù¤ Ã— Ù¤ = Ù¦Ù¤ Ø³Ù…Â³.' }]
                    ]
                }
            },
            algebra: {
                title: 'Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ø¬Ø¨Ø±ÙŠ',
                levels: {
                    easy: [
                        [{ q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙÙ‚ÙˆØ¯ ÙÙŠ Ø§Ù„Ù†Ù…Ø·: Ù¢ØŒ Ù¤ØŒ Ù¦ØŒ __ØŒ Ù¡Ù ØŸ', o: ['Ù§', 'Ù¨', 'Ù©', 'Ù¥'], a: 1, exp: 'Ø§Ù„Ù†Ù…Ø· ÙŠØ²ÙŠØ¯ Ø¨Ù…Ù‚Ø¯Ø§Ø± Ù¢ ÙÙŠ ÙƒÙ„ Ù…Ø±Ø©. Ø¨Ø¹Ø¯ Ù¦ØŒ ÙŠØ£ØªÙŠ Ø§Ù„Ø¹Ø¯Ø¯ Ù¨.' }, { q: 'Ø¥Ø°Ø§ ÙƒØ§Ù† â¬œ + Ù£ = Ù¥ØŒ ÙÙ…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ø¯Ø¯ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø±Ø¨Ø¹ØŸ', o: ['Ù¡', 'Ù¢', 'Ù£', 'Ù¤'], a: 1, exp: 'Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø°ÙŠ Ø¥Ø°Ø§ Ø£Ø¶ÙÙ†Ø§ Ø¥Ù„ÙŠÙ‡ Ù£ ÙŠØµØ¨Ø­ Ø§Ù„Ù†Ø§ØªØ¬ Ù¥ Ù‡Ùˆ Ù¢.' }, { q: 'Ø¥Ø°Ø§ ÙƒØ§Ù† Ù„Ø¯ÙŠÙƒ Ù£ ØµÙ†Ø§Ø¯ÙŠÙ‚ØŒ ÙˆÙÙŠ ÙƒÙ„ ØµÙ†Ø¯ÙˆÙ‚ Ù¤ ÙƒØ±Ø§ØªØŒ ÙÙ…Ø§ Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒØ±Ø§ØªØŸ', o: ['Ù§', 'Ù¡Ù ', 'Ù¡Ù¢', 'Ù©'], a: 2, exp: 'Ù‡Ø°Ù‡ Ø¹Ù…Ù„ÙŠØ© Ø¶Ø±Ø¨ Ù…ØªÙƒØ±Ø±: Ù£ Ã— Ù¤ = Ù¡Ù¢ ÙƒØ±Ø©.' }, { q: 'Ø£ÙƒÙ…Ù„ Ø§Ù„Ù†Ù…Ø·: â–²ØŒ â–¼ØŒ â–²ØŒ â–¼ØŒ __ØŸ', o: ['â–²', 'â–¼', 'â– ', 'â—'], a: 0, exp: 'Ø§Ù„Ù†Ù…Ø· ÙŠØªÙ†Ø§ÙˆØ¨ Ø¨ÙŠÙ† Ø³Ù‡Ù… Ù„Ù„Ø£Ø¹Ù„Ù‰ ÙˆØ³Ù‡Ù… Ù„Ù„Ø£Ø³ÙÙ„. Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ù‡Ù… Ù„Ù„Ø£Ø³ÙÙ„ØŒ ÙŠØ£ØªÙŠ Ø³Ù‡Ù… Ù„Ù„Ø£Ø¹Ù„Ù‰.' }]
                    ],
                    medium: [
                        [{ q: 'Ø­Ù„ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø©: Ø³ + Ù¡Ù  = Ù¡Ù§', o: ['Ø³ = Ù¢Ù§', 'Ø³ = Ù¡Ù§', 'Ø³ = Ù§', 'Ø³ = Ù¡Ù '], a: 2, exp: 'Ù„Ø¥ÙŠØ¬Ø§Ø¯ Ù‚ÙŠÙ…Ø© Ø³ØŒ Ù†Ø·Ø±Ø­ Ù¡Ù  Ù…Ù† Ø§Ù„Ø·Ø±ÙÙŠÙ†. Ø³ = Ù¡Ù§ - Ù¡Ù  = Ù§.' }, { q: 'Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø£ = Ù¥ØŒ ÙÙ…Ø§ Ù‚ÙŠÙ…Ø© Ù¤ Ã— Ø£ ØŸ', o: ['Ù©', 'Ù¤Ù¥', 'Ù¡', 'Ù¢Ù '], a: 3, exp: 'Ù†Ø¹ÙˆØ¶ Ø¹Ù† Ø£ Ø¨Ø§Ù„Ø±Ù‚Ù… Ù¥ØŒ ÙØªØµØ¨Ø­ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù¤ Ã— Ù¥ = Ù¢Ù .' }, { q: 'Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø°ÙŠ Ø¥Ø°Ø§ Ø·Ø±Ø­Ù†Ø§ Ù…Ù†Ù‡ Ù¦ ÙƒØ§Ù† Ø§Ù„Ù†Ø§ØªØ¬ Ù©ØŸ', o: ['Ù£', 'Ù¡Ù¥', 'Ù¥Ù¤', 'Ù©Ù¦'], a: 1, exp: 'Ù†Ø­Ù„Ù‡Ø§ Ø¨Ø´ÙƒÙ„ Ø¹ÙƒØ³ÙŠ: Ù© + Ù¦ = Ù¡Ù¥. Ø§Ù„Ø¹Ø¯Ø¯ Ù‡Ùˆ Ù¡Ù¥.' }, { q: 'Ø£ÙƒÙ…Ù„ Ø§Ù„Ù†Ù…Ø·: Ù£ØŒ Ù¦ØŒ Ù©ØŒ Ù¡Ù¢ØŒ __ØŸ', o: ['Ù¡Ù£', 'Ù¡Ù¤', 'Ù¡Ù¥', 'Ù¡Ù¦'], a: 2, exp: 'Ø§Ù„Ù†Ù…Ø· ÙŠØ²ÙŠØ¯ Ø¨Ù…Ù‚Ø¯Ø§Ø± Ù£ ÙÙŠ ÙƒÙ„ Ù…Ø±Ø© (Ù…Ø¶Ø§Ø¹ÙØ§Øª Ø§Ù„Ø¹Ø¯Ø¯ Ù£). Ø¨Ø¹Ø¯ Ù¡Ù¢ØŒ ÙŠØ£ØªÙŠ Ø§Ù„Ø¹Ø¯Ø¯ Ù¡Ù¥.' }]
                    ],
                    hard: [
                        [{ q: 'Ø­Ù„ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø©: Ù£Øµ = Ù¢Ù¡', o: ['Øµ = Ù¡Ù¨', 'Øµ = Ù§', 'Øµ = Ù¢Ù¤', 'Øµ = Ù£'], a: 1, exp: 'Ù„Ø¥ÙŠØ¬Ø§Ø¯ Ù‚ÙŠÙ…Ø© ØµØŒ Ù†Ù‚Ø³Ù… Ø§Ù„Ø·Ø±ÙÙŠÙ† Ø¹Ù„Ù‰ Ù£. Øµ = Ù¢Ù¡ Ã· Ù£ = Ù§.' }, { q: 'Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø¨ = Ù¤ØŒ ÙÙ…Ø§ Ù‚ÙŠÙ…Ø© (Ù¥ Ã— Ø¨) - Ù¥ ØŸ', o: ['Ù¡Ù¥', 'Ù¢Ù¥', 'Ù¢Ù ', 'Ù¡Ù '], a: 0, exp: 'Ù†ØªØ¨Ø¹ ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª: Ø§Ù„Ø¶Ø±Ø¨ Ø£ÙˆÙ„Ø§Ù‹ (Ù¥Ã—Ù¤=Ù¢Ù )ØŒ Ø«Ù… Ø§Ù„Ø·Ø±Ø­ (Ù¢Ù -Ù¥=Ù¡Ù¥).' }, { q: 'Ø¥Ø°Ø§ ÙƒØ§Ù† Ø³/Ù¢ = Ù¨ØŒ ÙÙ…Ø§ Ù‚ÙŠÙ…Ø© Ø³ØŸ', o: ['Ù¤', 'Ù¡Ù ', 'Ù¦', 'Ù¡Ù¦'], a: 3, exp: 'Ù„Ø¥ÙŠØ¬Ø§Ø¯ Ù‚ÙŠÙ…Ø© Ø³ØŒ Ù†Ø¶Ø±Ø¨ Ø§Ù„Ø·Ø±ÙÙŠÙ† ÙÙŠ Ù¢. Ø³ = Ù¨ Ã— Ù¢ = Ù¡Ù¦.' }, { q: 'Ø£ÙƒÙ…Ù„ Ø§Ù„Ù†Ù…Ø·: Ù¡ØŒ Ù¤ØŒ Ù©ØŒ Ù¡Ù¦ØŒ __ØŸ', o: ['Ù¢Ù ', 'Ù¢Ù¤', 'Ù¢Ù¥', 'Ù£Ù¢'], a: 2, exp: 'Ù‡Ø°Ø§ Ø§Ù„Ù†Ù…Ø· ÙŠÙ…Ø«Ù„ Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ (Ù¡Ã—Ù¡ØŒ Ù¢Ã—Ù¢ØŒ Ù£Ã—Ù£ØŒ Ù¤Ã—Ù¤). Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ØªØ§Ù„ÙŠ Ù‡Ùˆ Ù¥Ã—Ù¥ = Ù¢Ù¥.' }]
                    ]
                }
            },
        };

        // --- Functions ---
        function toArabicNumerals(str) {
            if (str === null || str === undefined) return '';
            const arabicNumerals = ['Ù ', 'Ù¡', 'Ù¢', 'Ù£', 'Ù¤', 'Ù¥', 'Ù¦', 'Ù§', 'Ù¨', 'Ù©'];
            return String(str).replace(/[0-9]/g, d => arabicNumerals[parseInt(d)]);
        }
        
        function processContent(content) {
            let processed = toArabicNumerals(content);
            processed = processed.replace(/([Ù -Ù©]+)\/([Ù -Ù©]+)/g, '<span class="fraction"><span class="numerator">$1</span><span class="denominator">$2</span></span>');
            return processed;
        }

        function showScreen(screenId) {
            Object.values(screens).forEach(screen => screen.classList.remove('active'));
            screens[screenId].classList.add('active');
        }

        /**
         * Loads existing quiz data from student's record or initializes it.
         */
        function loadQuizData(studentData) {
            if (studentData && studentData.diagnostics) {
                 Object.keys(quizzes).forEach(key => {
                    const skillId = `d_${key}`;
                    const levelData = studentData.diagnostics[skillId];
                    quizData[key] = {
                        title: quizzes[key].title,
                        levels: {
                            // Only one level per skill in diagnostic
                            hard: { score: levelData ? levelData.grade : null, completed: !!levelData }
                        }
                    };
                });
            } else {
                // Initialize for a new test
                Object.keys(quizzes).forEach(key => {
                    quizData[key] = {
                        title: quizzes[key].title,
                        levels: {
                            hard: { score: null, completed: false }
                        }
                    };
                });
            }
        }
        
        /**
         * Saves a single grade to Google Sheets.
         */
        async function saveGradeToSheet(itemId, grade) {
            if (!studentId) return;
            const url = `${SCRIPT_URL}?action=saveGrade&studentId=${studentId}&itemId=${itemId}&grade=${grade}`;
            try {
                const response = await fetch(url);
                const result = await response.json();
                console.log(`Saved ${itemId}:`, result);
            } catch (error) {
                console.error(`Failed to save ${itemId}:`, error);
            }
        }

        function getScoreStyle(score) {
            if (score >= 80) return { class: 'score-high', icon: 'fa-trophy' };
            if (score >= 50) return { class: 'score-medium', icon: 'fa-smile' };
            return { class: 'score-low', icon: 'fa-frown' };
        }

        /**
         * Renders the dashboard with all the skills/quizzes.
         */
        function renderDashboard() {
            dashboardTitle.textContent = `Ù…Ù‚ÙŠØ§Ø³ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©`;
            dashboardGrid.innerHTML = '';
            let completedQuizzesCount = 0;
            let totalScore = 0;
            
            Object.keys(quizzes).forEach(key => {
                const quiz = quizzes[key];
                const data = quizData[key];
                const card = document.createElement('div');
                card.className = 'quiz-card';
                
                // In diagnostic, there's only one level, 'hard'
                const levelData = data.levels.hard;
                let scoreHTML = `<div class="level-score not-completed">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</div>`;
                if (levelData.completed) {
                    completedQuizzesCount++;
                    totalScore += levelData.score;
                    const style = getScoreStyle(levelData.score);
                    scoreHTML = `<div class="level-score ${style.class}"><i class="fas ${style.icon}"></i> ${toArabicNumerals(levelData.score)}%</div>`;
                }
                
                const levelHTML = `<div class="levels-container">
                                      <div class="level-wrapper" data-quiz-id="${key}" data-difficulty="hard">
                                          <div class="level-bubble">
                                              ${scoreHTML}
                                          </div>
                                      </div>
                                   </div>`;

                card.innerHTML = `<div class="quiz-card-header"><h3>${quiz.title}</h3></div><div class="quiz-card-body">${levelHTML}</div>`;
                dashboardGrid.appendChild(card);
            });
            
            // If all quizzes are completed, show the final average and save it
            if (completedQuizzesCount === Object.keys(quizzes).length) {
                const average = Math.round(totalScore / completedQuizzesCount);
                finalAverageBox.innerHTML = `<h2><i class="fas fa-medal"></i> Ø§ÙƒØªÙ…Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø´Ø§Ù…Ù„!</h2><p>Ù…Ø¹Ø¯Ù„Ùƒ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${toArabicNumerals(average)}%</p>
                <a href="index.html" target="_top" class="btn"><i class="fas fa-home"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ù†ØµØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>`;
                finalAverageBox.style.display = 'block';
                
                // Save the overall score
                saveGradeToSheet('d_test_overall', average);
            } else {
                finalAverageBox.style.display = 'none';
            }

            dashboardGrid.addEventListener('click', (e) => {
                const bubble = e.target.closest('.level-wrapper');
                if (bubble) {
                    startQuiz(bubble.dataset.quizId, bubble.dataset.difficulty);
                }
            });
        }

        function startQuiz(quizId, difficulty) {
            currentQuizId = quizId;
            currentDifficulty = difficulty;
            currentQuestionIndex = 0;
            score = 0;
            
            const models = quizzes[currentQuizId].levels[currentDifficulty];
            const modelIndex = Math.floor(Math.random() * models.length);
            currentModel = models[modelIndex];

            quizTitle.textContent = `${quizzes[currentQuizId].title}`;
            showScreen('quiz');
            loadQuestion();
        }

        function startTimer() {
            clearInterval(timer);
            timeLeft = 30; // 30 seconds per question
            updateTimerDisplay();
            
            timer = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if(timeLeft <= 0) {
                    clearInterval(timer);
                    handleTimeOut();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            timeCounter.textContent = `Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ${toArabicNumerals(timeLeft)} Ø«Ø§Ù†ÙŠØ©`;
            timeCounter.classList.toggle('warning', timeLeft <= 10);
        }

        function handleTimeOut() {
            Array.from(optionsGrid.children).forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            const question = currentModel[currentQuestionIndex];
            const correctIndex = question.a;
            
            optionsGrid.children[correctIndex].classList.add('correct');
            explanationText.innerHTML = processContent(question.exp);
            explanationBox.style.display = 'block';
            
            nextQuestionBtn.style.display = 'inline-flex';
        }

        function loadQuestion() {
            clearInterval(timer);
            explanationBox.style.display = 'none';
            nextQuestionBtn.style.display = 'none';
            const question = currentModel[currentQuestionIndex];
            
            questionCounter.textContent = `Ø§Ù„Ø³Ø¤Ø§Ù„ ${toArabicNumerals(currentQuestionIndex + 1)} Ù…Ù† ${toArabicNumerals(currentModel.length)}`;
            questionText.innerHTML = processContent(question.q);
            optionsGrid.innerHTML = '';

            question.o.forEach((optionText, index) => {
                const option = document.createElement('div');
                option.className = 'option';
                option.innerHTML = processContent(optionText);
                option.dataset.index = index;
                option.addEventListener('click', selectOption);
                optionsGrid.appendChild(option);
            });
            
            startTimer();
        }

        function selectOption(e) {
            clearInterval(timer);
            const selectedOption = e.target.closest('.option');
            const selectedIndex = parseInt(selectedOption.dataset.index);
            const question = currentModel[currentQuestionIndex];
            const correctIndex = question.a;

            Array.from(optionsGrid.children).forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            if (selectedIndex === correctIndex) {
                score++;
                selectedOption.classList.add('correct');
            } else {
                selectedOption.classList.add('incorrect');
                optionsGrid.children[correctIndex].classList.add('correct');
                explanationText.innerHTML = processContent(question.exp);
                explanationBox.style.display = 'block';
            }
            
            nextQuestionBtn.style.display = 'inline-flex';
        }

        function showQuizResult() {
            const totalQuestions = currentModel.length;
            const percentageScore = Math.round((score / totalQuestions) * 100);
            
            const currentLevelData = quizData[currentQuizId].levels[currentDifficulty];
            currentLevelData.score = percentageScore; 
            currentLevelData.completed = true;
            
            // Save individual skill score to sheet
            const skillId = `d_${currentQuizId}`;
            saveGradeToSheet(skillId, percentageScore);
            
            resultTitle.textContent = `Ù†ØªÙŠØ¬ØªÙƒ ÙÙŠ Ù…Ù‡Ø§Ø±Ø© - ${quizzes[currentQuizId].title}`;
            resultScore.textContent = `${toArabicNumerals(percentageScore)}%`;
            resultPoints.textContent = `Ø£Ø¬Ø¨Øª Ø¹Ù„Ù‰ ${toArabicNumerals(score)} Ù…Ù† ${toArabicNumerals(totalQuestions)} Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.`;
            
            const style = getScoreStyle(percentageScore);
            resultIcon.className = `fas ${style.icon} result-icon`;
            resultIcon.style.color = style.class === 'score-high' ? 'var(--score-high)' : (style.class === 'score-medium' ? 'var(--score-medium)' : 'var(--score-low)');

            showScreen('result');
        }

        // --- Event Listeners ---
        nextQuestionBtn.addEventListener('click', () => {
            currentQuestionIndex++;
            if (currentQuestionIndex < currentModel.length) {
                loadQuestion();
            } else {
                showQuizResult();
            }
        });

        retryFromResultBtn.addEventListener('click', () => {
            startQuiz(currentQuizId, currentDifficulty);
        });

        backToDashboardBtn.addEventListener('click', () => {
            showScreen('dashboard');
            renderDashboard();
        });

        /**
         * Main initialization function.
         */
        async function init() {
            const urlParams = new URLSearchParams(window.location.search);
            studentId = urlParams.get('studentId');

            if (!studentId) {
                showScreen('welcome'); // Show error screen if no student ID
                return;
            }
            
            // Fetch student data to get their name and previous diagnostic scores
            try {
                const response = await fetch(`${SCRIPT_URL}?action=getStudentData&studentId=${studentId}`);
                const result = await response.json();
                if (result.status === 'success' && result.data) {
                    loadQuizData(result.data);
                    renderDashboard();
                    showScreen('dashboard');
                } else {
                    // If student not found, still allow the test but without a name
                    loadQuizData(null);
                    renderDashboard();
                    showScreen('dashboard');
                }
            } catch (error) {
                console.error("Failed to fetch student data:", error);
                loadQuizData(null);
                renderDashboard();
                showScreen('dashboard');
            }
        }

        init();
    });
    </script>
</body>
</html>
