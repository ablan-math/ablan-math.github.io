<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงูุฏุฑุณ ูข-ูข: ุงูุฏูุงู | ููุตุฉ ุงูุฑูุงุถูุงุช ุงูุชูุงุนููุฉ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; }
        .hidden { display: none; }
        .step-box { border-right: 4px solid #1d4ed8; }
        .vocab-term { background-color: #ffefc5; padding: 2px 6px; border-radius: 4px; font-weight: bold; }
        .option-label { display: block; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; cursor: pointer; transition: all 0.2s ease-in-out; }
        .option-label:hover { border-color: #3b82f6; background-color: #eff6ff; }
        input[type="radio"]:checked + .option-label { border-color: #2563eb; background-color: #dbeafe; box-shadow: 0 0 0 2px #bfdbfe; }
        input[type="radio"] { display: none; }
        .feedback-correct { color: #16a34a; }
        .feedback-incorrect { color: #dc2626; }
        .highlight-change { color: #ef4444; font-weight: bold; }
        
        /* === ุชุนุฏูู ุงูุฑููุฒ ุงูุฑูุงุถูุฉ === */
        .math-eq {
            font-family: "Courier New", monospace; /* ุฎุท ุนุฑูุถ ููุชุจุงุนุฏ */
            font-size: 1.1rem; /* ุชูุจูุฑ ุญุฌู ุงูุฎุท */
            font-weight: bold;
            color: #4338ca;
            background-color: #f3f4f6; /* ุฎูููุฉ ุฑูุงุฏูุฉ ูุงุชุญุฉ */
            border: 1px solid #d1d5db; /* ุฅุทุงุฑ ุฎููู */
            padding: 2px 8px; /* ููุงูุด ุฏุงุฎููุฉ */
            border-radius: 6px; /* ุฒูุงูุง ุฏุงุฆุฑูุฉ */
            display: inline-block;
            vertical-align: middle; /* ูุญุงุฐุงุฉ ุฃูุถู ูุน ุงููุต */
        }
        
        .fraction { display: inline-flex; flex-direction: column; text-align: center; vertical-align: middle; margin: 0 0.2em; }
        .fraction > span { display: block; padding: 0 0.4em; }
        .fraction > .frac-bar { border-top: 2px solid #4338ca; }
        
        /* Classes for interactive example */
        .example-diagram {
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        .example-diagram.dimmed {
            opacity: 0.4;
        }
        .example-diagram.active {
            opacity: 1;
            transform: scale(1.03);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .step-interactive { display: none; opacity: 0; transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out; transform: translateY(10px); }
        .step-interactive.active { display: block; opacity: 1; transform: translateY(0); }
    </style>
</head>
<body class="bg-gray-100">
    <div id="app-container" class="grid grid-template-rows: auto 1fr auto; min-height: 100vh;">
        <header id="main-header" class="bg-white shadow-md sticky top-0 z-50"></header>
        <main class="container mx-auto max-w-4xl my-8">
            <div class="p-6 bg-white rounded-xl shadow-lg">
                <header class="flex justify-between items-center mb-8 border-b pb-4 border-gray-200">
                    <h1 id="lesson-title" class="text-3xl font-bold text-blue-800">ุงูุฏุฑุณ ูข-ูข: ุงูุฏูุงู</h1>
                    <a href="../index.html" target="_top" class="text-sm text-blue-600 hover:underline">&larr; ุงูุนูุฏุฉ ุฅูู ุงูููุฑุณ</a>
                </header>
                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">๐ก ุฃููุงู: ุงูููููู ุงูุฃุณุงุณู</h2>
                    <div class="p-4 bg-blue-50 rounded-lg space-y-3">
                        <p><span class="vocab-term">ุงูุฏุงูุฉ</span> ูู ุนูุงูุฉ ุฎุงุตุฉ ุชุฑุจุท ูู ุนูุตุฑ ูู ุงููุฌุงู ุจุนูุตุฑ <strong class="text-red-600">ูุงุญุฏ ููุท</strong> ูู ุงููุฏู. ูุฐุง ูุนูู ุฃู ูู ูููุฉ ูู <span class="math-eq">ุณ</span> ูุฌุจ ุฃู ุชุฑุชุจุท ุจูููุฉ ูุงุญุฏุฉ ููุท ูู <span class="math-eq">ุต</span>.</p>
                    </div>
                </section>
                
                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">๐ฏ ุซุงููุงู: ุฃูุซูุฉ ุชูุงุนููุฉ</h2>
                    <div class="p-6 bg-gray-50 rounded-lg">
                        <div class="flex flex-col space-y-8">
                            <div id="interactive-container-1" class="p-4 bg-white rounded-lg shadow">
                                <p class="text-lg font-semibold mb-4">ูุซุงู ูก: ุชุญุฏูุฏ ุงูุฏูุงู ูู ุงููุฎุทุทุงุช ุงูุณูููุฉ</p>
                                <div id="diagram-container" class="grid grid-cols-2 md:grid-cols-4 gap-4 min-h-[250px] items-start">
                                    <div class="interactive-placeholder text-center text-gray-500 p-4 md:col-span-4"><p>ุงุถุบุท "ุงูุชุงูู" ูุจุฏุก ุฎุทูุงุช ุงูุญู</p></div>
                                    
                                    <div id="ex1-col" class="example-diagram flex flex-col items-center p-2 bg-gray-50 rounded-lg">
                                        <h4 class="font-bold mb-2">ุงููุซุงู ุงูุฃูู</h4>
                                        <svg viewBox="0 0 100 80" class="w-full h-32 bg-white border rounded-lg"><defs><marker id="ex1-arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#3b82f6" /></marker></defs><rect x="65" y="5" width="30" height="70" rx="5" stroke="#60a5fa" fill="#eff6ff" /><text x="80" y="15" font-size="7" font-weight="bold" text-anchor="middle">ุงููุฌุงู</text><text x="80" y="30" font-size="7" text-anchor="middle">-ูข</text><text x="80" y="45" font-size="7" text-anchor="middle">ูฃ</text><text x="80" y="60" font-size="7" text-anchor="middle">ูค</text><rect x="5" y="5" width="30" height="70" rx="5" stroke="#34d399" fill="#f0fdf4" /><text x="20" y="15" font-size="7" font-weight="bold" text-anchor="middle">ุงููุฏู</text><text x="20" y="30" font-size="7" text-anchor="middle">-ูฃ</text><text x="20" y="45" font-size="7" text-anchor="middle">ูฆ</text><text x="20" y="60" font-size="7" text-anchor="middle">ูฉ</text><path d="M 65 30 Q 50 30 35 30" stroke="#3b82f6" stroke-width="0.5" fill="none" marker-end="url(#ex1-arrow)" /><path d="M 65 45 Q 50 52.5 35 60" stroke="#3b82f6" stroke-width="0.5" fill="none" marker-end="url(#ex1-arrow)" /><path d="M 65 60 Q 50 52.5 35 45" stroke="#3b82f6" stroke-width="0.5" fill="none" marker-end="url(#ex1-arrow)" /></svg>
                                        <div id="ex1-analysis" class="hidden mt-2 p-2 w-full bg-green-100 rounded-md text-green-800 text-sm text-center"><strong>ูุนูุ ุฏุงูุฉ:</strong> ูู ุนูุตุฑ ูู ุงููุฌุงู ุงุฑุชุจุท ุจุนูุตุฑ ูุงุญุฏ ููุท.</div>
                                    </div>

                                    <div id="ex2-col" class="example-diagram flex flex-col items-center p-2 bg-gray-50 rounded-lg">
                                        <h4 class="font-bold mb-2">ุงููุซุงู ุงูุซุงูู</h4>
                                        <div id="ex2-initial">
                                            <svg viewBox="0 0 100 80" class="w-full h-32 bg-white border rounded-lg"><defs><marker id="ex2-arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#3b82f6" /></marker></defs><rect x="65" y="5" width="30" height="70" rx="5" stroke="#60a5fa" fill="#eff6ff" /><text x="80" y="15" font-size="7" font-weight="bold" text-anchor="middle">ุงููุฌุงู</text><text x="80" y="30" font-size="7" text-anchor="middle">ูก</text><text x="80" y="45" font-size="7" text-anchor="middle">ูข</text><text x="80" y="60" font-size="7" text-anchor="middle">ูฃ</text><rect x="5" y="15" width="30" height="55" rx="5" stroke="#34d399" fill="#f0fdf4" /><text x="20" y="25" font-size="7" font-weight="bold" text-anchor="middle">ุงููุฏู</text><text x="20" y="40" font-size="7" text-anchor="middle">ูค</text><text x="20" y="55" font-size="7" text-anchor="middle">ูฅ</text><path d="M 65 30 Q 50 35 35 40" stroke="#3b82f6" stroke-width="0.5" fill="none" marker-end="url(#ex2-arrow)" /><path d="M 65 30 Q 50 45 35 55" stroke="#3b82f6" stroke-width="0.5" fill="none" marker-end="url(#ex2-arrow)" /><path d="M 65 45 Q 50 50 35 55" stroke="#3b82f6" stroke-width="0.5" fill="none" marker-end="url(#ex2-arrow)" /></svg>
                                        </div>
                                        <div id="ex2-analysis" class="hidden w-full">
                                            <svg viewBox="0 0 100 80" class="w-full h-32 bg-white border rounded-lg"><defs><marker id="ex2-arrow-red" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#ef4444" /></marker><marker id="ex2-arrow-blue" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#3b82f6" /></marker></defs><rect x="65" y="5" width="30" height="70" rx="5" stroke="#60a5fa" fill="#eff6ff" /><text x="80" y="15" font-size="7" font-weight="bold" text-anchor="middle">ุงููุฌุงู</text><text x="80" y="30" font-size="7" text-anchor="middle">ูก</text><text x="80" y="45" font-size="7" text-anchor="middle">ูข</text><text x="80" y="60" font-size="7" text-anchor="middle">ูฃ</text><rect x="5" y="15" width="30" height="55" rx="5" stroke="#34d399" fill="#f0fdf4" /><text x="20" y="25" font-size="7" font-weight="bold" text-anchor="middle">ุงููุฏู</text><text x="20" y="40" font-size="7" text-anchor="middle">ูค</text><text x="20" y="55" font-size="7" text-anchor="middle">ูฅ</text><path d="M 65 30 Q 50 35 35 40" stroke="#ef4444" stroke-width="0.5" fill="none" marker-end="url(#ex2-arrow-red)" /><path d="M 65 30 Q 50 45 35 55" stroke="#ef4444" stroke-width="0.5" fill="none" marker-end="url(#ex2-arrow-red)" /><path d="M 65 45 Q 50 50 35 55" stroke="#3b82f6" stroke-width="0.5" fill="none" marker-end="url(#ex2-arrow-blue)" /></svg>
                                            <div class="mt-2 p-2 w-full bg-red-100 rounded-md text-red-800 text-sm text-center"><strong>ููุณุช ุฏุงูุฉ:</strong> ุงูุนูุตุฑ <strong class="highlight-change">ูก</strong> ุงุฑุชุจุท ุจุนูุตุฑูู.</div>
                                        </div>
                                    </div>

                                    <div id="ex3-col" class="example-diagram flex flex-col items-center p-2 bg-gray-50 rounded-lg">
                                        <h4 class="font-bold mb-2">ุงููุซุงู ุงูุซุงูุซ</h4>
                                        <svg viewBox="0 0 100 80" class="w-full h-32 bg-white border rounded-lg"><defs><marker id="ex3-arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#3b82f6" /></marker></defs><rect x="65" y="5" width="30" height="70" rx="5" stroke="#60a5fa" fill="#eff6ff" /><text x="80" y="15" font-size="7" font-weight="bold" text-anchor="middle">ุงููุฌุงู</text><text x="80" y="30" font-size="7" text-anchor="middle">ูก</text><text x="80" y="45" font-size="7" text-anchor="middle">ูข</text><text x="80" y="60" font-size="7" text-anchor="middle">ูฃ</text><rect x="5" y="25" width="30" height="30" rx="5" stroke="#34d399" fill="#f0fdf4" /><text x="20" y="35" font-size="7" font-weight="bold" text-anchor="middle">ุงููุฏู</text><text x="20" y="50" font-size="7" text-anchor="middle">ูฅ</text><path d="M 65 30 Q 50 40 35 50" stroke="#3b82f6" stroke-width="0.5" fill="none" marker-end="url(#ex3-arrow)" /><path d="M 65 45 Q 50 47.5 35 50" stroke="#3b82f6" stroke-width="0.5" fill="none" marker-end="url(#ex3-arrow)" /><path d="M 65 60 Q 50 52.5 35 50" stroke="#3b82f6" stroke-width="0.5" fill="none" marker-end="url(#ex3-arrow)" /></svg>
                                        <div id="ex3-analysis" class="hidden mt-2 p-2 w-full bg-green-100 rounded-md text-green-800 text-sm text-center"><strong>ูุนูุ ุฏุงูุฉ:</strong> ูุง ููู ุงุฑุชุจุงุท ุฃูุซุฑ ูู ุนูุตุฑ ุจููุณ ุงููุฏู.</div>
                                    </div>
                                    
                                    <div id="ex4-col" class="example-diagram flex flex-col items-center p-2 bg-gray-50 rounded-lg">
                                        <h4 class="font-bold mb-2">ุงููุซุงู ุงูุฑุงุจุน</h4>
                                        <svg viewBox="0 0 100 80" class="w-full h-32 bg-white border rounded-lg"><defs><marker id="ex4-arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#3b82f6" /></marker></defs><rect x="65" y="5" width="30" height="70" rx="5" stroke="#60a5fa" fill="#eff6ff" /><text x="80" y="15" font-size="7" font-weight="bold" text-anchor="middle">ุงููุฌุงู</text><text x="80" y="30" font-size="7" text-anchor="middle">ุฃ</text><text x="80" y="45" font-size="7" text-anchor="middle">ุจ</text><text x="80" y="60" font-size="7" text-anchor="middle">ุฌ</text><rect x="5" y="15" width="30" height="55" rx="5" stroke="#34d399" fill="#f0fdf4" /><text x="20" y="25" font-size="7" font-weight="bold" text-anchor="middle">ุงููุฏู</text><text x="20" y="40" font-size="7" text-anchor="middle">ูก</text><text x="20" y="55" font-size="7" text-anchor="middle">ูข</text><path d="M 65 30 Q 50 35 35 40" stroke="#3b82f6" stroke-width="0.5" fill="none" marker-end="url(#ex4-arrow)" /><path d="M 65 60 Q 50 57.5 35 55" stroke="#3b82f6" stroke-width="0.5" fill="none" marker-end="url(#ex4-arrow)" /></svg>
                                        <div id="ex4-analysis" class="hidden mt-2 p-2 w-full bg-red-100 rounded-md text-red-800 text-sm text-center"><strong>ููุณุช ุฏุงูุฉ:</strong> ุงูุนูุตุฑ <strong class="highlight-change">'ุจ'</strong> ูู ุงููุฌุงู ูู ูุฑุชุจุท ุจุฃู ุนูุตุฑ.</div>
                                    </div>
                                </div>
                                <div class="flex justify-between mt-6">
                                    <button data-example="1" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">ุฑุฌูุน</button>
                                    <div>
                                        <button data-example="1" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">ุงูุชุงูู</button>
                                        <button data-example="1" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">ุฅุนุงุฏุฉ</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">๐ฏ ุซุงูุซุงู: ุฃูุซูุฉ ุชูุงุนููุฉ ุฅุถุงููุฉ</h2>
                    <div class="p-6 bg-gray-50 rounded-lg">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <!-- Example 2: Tables -->
                            <div id="interactive-container-2" class="p-4 bg-white rounded-lg shadow">
                                    <p class="text-lg font-semibold mb-4">ูุซุงู ูข: ุชุญุฏูุฏ ุงูุฏูุงู ูู ุงูุฌุฏุงูู</p>
                                    <div class="problem-statement p-4 bg-gray-50 rounded-lg step-box mb-4">
                                        <h4 class="font-bold">ุงูุฌุฏุงูู (ูุซุงู ุฃ)</h4>
                                        <p>ูู ุงูุฌุฏูู ุงูุชุงูู ููุซู ุฏุงูุฉุ</p>
                                        <div class="p-3"><table class="w-full border-collapse border border-slate-400"><thead><tr class="bg-gray-200"><th class="p-2 border border-slate-300">ุณ</th><th class="p-2 border border-slate-300">ุต</th></tr></thead><tbody><tr><td class="border border-slate-300 p-1">ูก</td><td class="border border-slate-300 p-1">ูฅ</td></tr><tr><td class="border border-slate-300 p-1">ูฃ</td><td class="border border-slate-300 p-1">-ูค</td></tr><tr><td class="border border-slate-300 p-1">ูก</td><td class="border border-slate-300 p-1">-ูค</td></tr></tbody></table></div>
                                    </div>
                                    <div class="steps-container space-y-4">
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box">
                                            <h4 class="font-bold">ุชุญููู ุงูุฌุฏูู (ูุซุงู ุฃ)</h4>
                                            <div class="p-3"><table class="w-full border-collapse border border-slate-400"><thead><tr class="bg-gray-200"><th class="p-2 border border-slate-300">ุณ</th><th class="p-2 border border-slate-300">ุต</th></tr></thead><tbody><tr><td class="border border-slate-300 p-1"><span class="highlight-change">ูก</span></td><td class="border border-slate-300 p-1">ูฅ</td></tr><tr><td class="border border-slate-300 p-1">ูฃ</td><td class="border border-slate-300 p-1">-ูค</td></tr><tr><td class="border border-slate-300 p-1"><span class="highlight-change">ูก</span></td><td class="border border-slate-300 p-1">-ูค</td></tr></tbody></table></div>
                                            <p class="mt-2 p-2 bg-red-100 rounded-md text-red-800 text-sm"><strong>ููุณุช ุฏุงูุฉ:</strong> ุงูุนูุตุฑ ูก ูู ุงููุฌุงู ุงุฑุชุจุท ุจู ูฅ ู -ูค.</p>
                                        </div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box">
                                            <h4 class="font-bold">ุงูุฌุฏุงูู (ูุซุงู ุจ)</h4>
                                            <p>ูู ุงูุฌุฏูู ุงูุชุงูู ููุซู ุฏุงูุฉุ</p>
                                            <div class="p-3"><table class="w-full border-collapse border border-slate-400"><thead><tr class="bg-gray-200"><th class="p-2 border border-slate-300">ุณ</th><th class="p-2 border border-slate-300">ุต</th></tr></thead><tbody><tr><td class="border border-slate-300 p-1">ูข</td><td class="border border-slate-300 p-1">ูก</td></tr><tr><td class="border border-slate-300 p-1">ูฃ</td><td class="border border-slate-300 p-1">-ูข</td></tr><tr><td class="border border-slate-300 p-1">ูค</td><td class="border border-slate-300 p-1">ูก</td></tr></tbody></table></div>
                                        </div>
                                        <div class="step-interactive p-4 bg-white rounded-lg border-4 border-green-500">
                                            <h4 class="font-bold">ุชุญููู ุงูุฌุฏูู (ูุซุงู ุจ)</h4>
                                            <div class="p-3"><table class="w-full border-collapse border border-slate-400 bg-white"><thead><tr class="bg-gray-200"><th class="p-2 border border-slate-300">ุณ</th><th class="p-2 border border-slate-300">ุต</th></tr></thead><tbody><tr><td class="border border-slate-300 p-1">ูข</td><td class="border border-slate-300 p-1">ูก</td></tr><tr><td class="border border-slate-300 p-1">ูฃ</td><td class="border border-slate-300 p-1">-ูข</td></tr><tr><td class="border border-slate-300 p-1">ูค</td><td class="border border-slate-300 p-1">ูก</td></tr></tbody></table></div>
                                            <p class="mt-2 p-2 bg-green-100 rounded-md text-green-800 text-sm"><strong>ูุนูุ ุฏุงูุฉ:</strong> ูู ุนูุตุฑ ูู ุงููุฌุงู {ูข, ูฃ, ูค} ูู ูุฎุฑุฌุฉ ูุงุญุฏุฉ ููุท.</p>
                                        </div>
                                    </div>
                                    <div class="flex justify-between mt-6">
                                        <button data-example="2" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">ุฑุฌูุน</button>
                                        <div>
                                            <button data-example="2" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">ุงูุชุงูู</button>
                                            <button data-example="2" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">ุฅุนุงุฏุฉ</button>
                                        </div>
                                    </div>
                            </div>
                            <!-- Example 3: Ordered Pairs -->
                            <div id="interactive-container-3" class="p-4 bg-white rounded-lg shadow">
                                    <p class="text-lg font-semibold mb-4">ูุซุงู ูฃ: ุชุญุฏูุฏ ุงูุฏูุงู ูู ุงูุฃุฒูุงุฌ ุงููุฑุชุจุฉ</p>
                                    <div class="problem-statement p-4 bg-gray-50 rounded-lg step-box mb-4">
                                        <h4 class="font-bold">ุงูุฃุฒูุงุฌ ุงููุฑุชุจุฉ</h4>
                                        <p>ุญุฏุฏ ุฃู ูู ุงููุฌููุนุงุช ุงูุชุงููุฉ ุชูุซู ุฏุงูุฉ:</p>
                                        <div class="space-y-4 mt-2">
                                            <div class="p-2 bg-white rounded shadow"><p class="font-semibold">ุงููุฌููุนุฉ ุงูุฃููู:</p><p class="math-eq text-sm">{(ูข,ูก), (ูฃ,-ูข), (ูค,ูก), (ูฅ,-ูข)}</p></div>
                                            <div class="p-2 bg-white rounded shadow"><p class="font-semibold">ุงููุฌููุนุฉ ุงูุซุงููุฉ:</p><p class="math-eq text-sm">{(ูก,ูฅ), (ูข,ูฆ), (ูก,ูง), (ูฃ,ูจ)}</p></div>
                                        </div>
                                    </div>
                                    <div class="steps-container space-y-4">
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box">
                                            <h4 class="font-bold">ุชุญููู ุงููุฌููุนุฉ ุงูุฃููู</h4>
                                            <div class="p-2 bg-white rounded shadow">
                                                <p class="font-semibold">ุงููุฌููุนุฉ ุงูุฃููู:</p>
                                                <p class="math-eq text-sm">{(<span class="text-blue-600 font-bold">ูข</span>,ูก), (<span class="text-blue-600 font-bold">ูฃ</span>,-ูข), (<span class="text-blue-600 font-bold">ูค</span>,ูก), (<span class="text-blue-600 font-bold">ูฅ</span>,-ูข)}</p>
                                                <p class="mt-2 p-2 bg-green-100 rounded-md text-green-800 text-sm"><strong>ูุนูุ ุฏุงูุฉ:</strong> ูู ุนูุตุฑ ูู ุงููุฌุงู {ูข, ูฃ, ูค, ูฅ} ูู ูุชูุฑุฑ.</p>
                                            </div>
                                        </div>
                                        <div class="step-interactive p-4 bg-white rounded-lg border-4 border-red-500">
                                            <h4 class="font-bold">ุชุญููู ุงููุฌููุนุฉ ุงูุซุงููุฉ (ุงูุญู ุงูููุงุฆู)</h4>
                                            <div class="p-2 bg-white rounded shadow">
                                                <p class="font-semibold">ุงููุฌููุนุฉ ุงูุซุงููุฉ:</p>
                                                <p class="math-eq text-sm">{(<span class="highlight-change">ูก</span>,ูฅ), (ูข,ูฆ), (<span class="highlight-change">ูก</span>,ูง), (ูฃ,ูจ)}</p>
                                                <p class="mt-2 p-2 bg-red-100 rounded-md text-red-800 text-sm"><strong>ููุณุช ุฏุงูุฉ:</strong> ุงูุนูุตุฑ ูก ูู ุงููุฌุงู ุงุฑุชุจุท ุจูููุชูู ูุฎุชููุชูู (ูฅ ู ูง).</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex justify-between mt-6">
                                        <button data-example="3" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">ุฑุฌูุน</button>
                                        <div>
                                            <button data-example="3" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">ุงูุชุงูู</button>
                                            <button data-example="3" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">ุฅุนุงุฏุฉ</button>
                                        </div>
                                    </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">๐ ุฑุงุจุนุงู: ุงุฎุชุจุงุฑ ุงูุฎุท ุงูุฑุฃุณู ุงููุชุญุฑู</h2>
                    <div class="p-6 bg-gray-50 rounded-lg space-y-4">
                        <p>ููููู ุงุณุชุนูุงู <span class="vocab-term">ุงุฎุชุจุงุฑ ุงูุฎุท ุงูุฑุฃุณู</span> ููุชุญูู ููุง ุฅุฐุง ูุงู ุงูุชูุซูู ุงูุจูุงูู ููุซู ุฏุงูุฉ ุฃู ูุง. ูุฅุฐุง ูุทุน ุงูุฎุท ุงูุฑุฃุณู ุงูุชูุซูู ุงูุจูุงูู ูู ุฃูุซุฑ ูู ููุทุฉุ ูุฅู ุงูุนูุงูุฉ ูุง ุชูุซู ุฏุงูุฉ.</p>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center mt-6">
                            <div class="p-2 bg-white rounded-lg shadow">
                                <h4 class="font-semibold mb-2">ูุซุงู (ุฃ)</h4>
                                <canvas id="vlt-canvas-1" class="w-full h-40 bg-white border rounded-lg"></canvas>
                                <p id="vlt-status-1" class="text-sm mt-2 font-semibold"></p>
                            </div>
                            <div class="p-2 bg-white rounded-lg shadow">
                                <h4 class="font-semibold mb-2">ูุซุงู (ุจ)</h4>
                                <canvas id="vlt-canvas-2" class="w-full h-40 bg-white border rounded-lg"></canvas>
                                <p id="vlt-status-2" class="text-sm mt-2 font-semibold"></p>
                            </div>
                            <div class="p-2 bg-white rounded-lg shadow">
                                <h4 class="font-semibold mb-2">ูุซุงู (ุฌ)</h4>
                                <canvas id="vlt-canvas-3" class="w-full h-40 bg-white border rounded-lg"></canvas>
                                <p id="vlt-status-3" class="text-sm mt-2 font-semibold"></p>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">๐ ุฎุงูุณุงู: ุงูุฏูุงู ุงููุชุตูุฉ ูุงููููุตูุฉ</h2>
                    <div class="p-6 bg-gray-50 rounded-lg space-y-4">
                        <p>ุชูุณูู ุงูุฏุงูุฉ ุงูุชู ุชููุซููู ุจูุงูููุง ุจููุงุท ุบูุฑ ูุชุตูุฉ <span class="vocab-term">ุฏุงูุฉ ูููุตูุฉ</span>.</p>
                        <p>ุฃูุง ุงูุฏุงูุฉ ุงูุชู ุชููุซููู ุจุฎุท ุฃู ููุญูู ุฏูู ุงููุทุงุน ูุชูุณูู <span class="vocab-term">ุฏุงูุฉ ูุชุตูุฉ</span>.</p>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center mt-6">
                            <div class="p-2 bg-white rounded-lg shadow">
                                <h4 class="font-semibold mb-2">ุฏุงูุฉ ูุชุตูุฉ</h4>
                                <svg viewBox="-5 -5 10 10" class="w-full h-32 bg-white border rounded-lg"><path d="M -4 3 L 0 -3 L 4 3" stroke="#3b82f6" stroke-width="0.3" fill="none"/></svg>
                                <p class="text-xs mt-2 text-gray-600">ุงูุฑุณู ุนุจุงุฑุฉ ุนู ุฎุทูุท ูุชุตูุฉ.</p>
                            </div>
                            <div class="p-2 bg-white rounded-lg shadow">
                                <h4 class="font-semibold mb-2">ุฏุงูุฉ ูููุตูุฉ</h4>
                                <svg viewBox="-5 -5 10 10" class="w-full h-32 bg-white border rounded-lg">
                                    <circle cx="-3" cy="1" r="0.3" fill="#3b82f6" />
                                    <circle cx="-1" cy="-2" r="0.3" fill="#3b82f6" />
                                    <circle cx="1.5" cy="2" r="0.3" fill="#3b82f6" />
                                    <circle cx="4" cy="-1" r="0.3" fill="#3b82f6" />
                                </svg>
                                <p class="text-xs mt-2 text-gray-600">ุงูุฑุณู ุนุจุงุฑุฉ ุนู ููุงุท ูููุตูุฉ.</p>
                            </div>
                            <div class="p-2 bg-white rounded-lg shadow">
                                <h4 class="font-semibold mb-2">ุฏุงูุฉ ูุชุตูุฉ</h4>
                                <svg viewBox="-5 -5 10 10" class="w-full h-32 bg-white border rounded-lg"><path d="M -4 -2 Q 0 4 4 -2" stroke="#3b82f6" stroke-width="0.3" fill="none"/></svg>
                                <p class="text-xs mt-2 text-gray-600">ุงูุฑุณู ุนุจุงุฑุฉ ุนู ููุญูู ูุชุตู.</p>
                            </div>
                             <div class="p-2 bg-white rounded-lg shadow">
                                <h4 class="font-semibold mb-2">ุฏุงูุฉ ุบูุฑ ูุชุตูุฉ</h4>
                                <svg viewBox="-5 -5 10 10" class="w-full h-32 bg-white border rounded-lg">
                                    <path d="M -4 -1 Q -1 3 0.5 3" stroke="#3b82f6" stroke-width="0.3" fill="none"/>
                                    <path d="M 1.5 3 Q 3 3 4 -1" stroke="#3b82f6" stroke-width="0.3" fill="none"/>
                                    <circle cx="1" cy="3" r="0.3" fill="white" stroke="#3b82f6" stroke-width="0.2" />
                                </svg>
                                <p class="text-xs mt-2 text-gray-600">ููุญูู ุจู ุงููุทุงุน (ูุฌูุฉ) ูู ุงูููุชุตู.</p>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="mt-12">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-bold text-gray-800">โ๏ธ ุณุงุฏุณุงู: ุญุงู ุฏูุฑู! ุงุฎุชุจุฑ ูููู</h2>
                        <div id="attempts-counter" class="text-sm font-bold text-gray-600"></div>
                    </div>
                    <form id="quizForm" class="p-6 bg-gray-50 rounded-lg space-y-8"></form>
                    <div id="quiz-results" class="hidden mt-6 p-4 rounded-lg text-center">
                        <h3 class="text-xl font-bold">ูุชูุฌุชู ุงูููุงุฆูุฉ</h3>
                        <p id="quiz-score" class="text-4xl font-bold my-2"></p>
                        <div id="save-status" class="mt-4 text-sm font-semibold"></div>
                        <button id="retake-quiz-btn" class="hidden mt-4 bg-blue-600 text-white font-medium py-2 px-6 rounded-lg hover:bg-blue-700">ุฅุนุงุฏุฉ ุงูุงุฎุชุจุงุฑ</button>
                    </div>
                </section>
            </div>
        </main>
        <footer id="main-footer" class="bg-gray-200 py-4"></footer>
    </div>
    <div id="explanationModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-lg shadow-2xl p-6 max-w-lg w-full">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modal-title" class="text-xl font-bold">๐ก ุดุฑุญ ุงูุฅุฌุงุจุฉ</h3>
                <button id="closeModalBtn" class="p-2 -m-2 rounded-full hover:bg-gray-200">
                    <svg class="h-6 w-6 text-gray-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <div id="explanationText" class="text-gray-700 max-h-[60vh] overflow-y-auto"></div>
        </div>
    </div>
    <script>
    // --- ุฏูุงู ูุดุชุฑูุฉ ---
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzrf1-At3Pq7i39bGV3F1iD3-b0G-WWyRi5cgpKeQjyn_N5fh2EmGhoyRKUsbLd-F_UJQ/exec";
    const MAX_ATTEMPTS = 3;
    let currentQuestions = []; 
    function getStudentFromStorage() { const studentDataString = localStorage.getItem('currentStudent'); if (studentDataString) { try { return JSON.parse(studentDataString); } catch (e) { return null; } } return null; }
    function buildHeader(studentData, lessonTitle = null) { const headerContainer = document.getElementById('main-header'); if (!headerContainer) return; let titleHtml; if (lessonTitle) { titleHtml = `<div><h2 class="text-sm text-gray-500 leading-tight">ููุตุฉ ุงูุฑูุงุถูุงุช ุงูุชูุงุนููุฉ</h2><h1 class="text-xl font-bold text-indigo-700 leading-tight">${lessonTitle}</h1></div>`; } else { titleHtml = `<a href="../index.html" target="_top"><h1 class="text-2xl font-bold text-blue-800">ููุตุฉ ุงูุฑูุงุถูุงุช ุงูุชูุงุนููุฉ</h1></a>`; } let userInfoHtml = ''; if (studentData) { userInfoHtml = `<div class="flex items-center gap-4"><span class="font-semibold">ุฃููุงูุ ${studentData.name}</span><a href="../index.html" target="_top" id="logout-link" class="bg-red-500 text-white py-1 px-3 rounded-lg hover:bg-red-600">ุฎุฑูุฌ</a></div>`; } else { userInfoHtml = `<p class="text-lg text-gray-600">ุฒุงุฆุฑ</p>`; } headerContainer.innerHTML = `<div class="container mx-auto px-6 py-4 flex justify-between items-center">${titleHtml}${userInfoHtml}</div>`; const logoutLink = headerContainer.querySelector('#logout-link'); if(logoutLink) { logoutLink.addEventListener('click', () => { localStorage.removeItem('currentStudent'); }); } }
    function buildFooter() { const footerContainer = document.getElementById('main-footer'); if (!footerContainer) return; footerContainer.innerHTML = `<div class="container mx-auto px-6"><p class="text-center text-gray-600 text-sm">ยฉ 2024 ุฌููุน ุงูุญููู ูุญููุธุฉ | ุชุตููู ูุชุทููุฑ: ุฃ. ุนุจุฏุงูุนุฒูุฒ ุฎุงูุฏ ุงูุนุจูุงู</p></div>`; }
    function initializeQuiz(lessonId, questions, studentData) { currentQuestions = questions; const quizForm = document.getElementById('quizForm'); if (!quizForm) return; if (questions.length === 0) { quizForm.innerHTML = `<p class="text-center text-gray-600">ูุง ุชูุฌุฏ ุฃุณุฆูุฉ ูุชุงุญุฉ ููุฐุง ุงูุฏุฑุณ ุญุงููุงู.</p>`; return; } let attemptsLeft; if (studentData) { const studentLessonData = studentData.lessons?.[lessonId] || { attempts: 0 }; attemptsLeft = MAX_ATTEMPTS - studentLessonData.attempts; } else { attemptsLeft = 1; } const attemptsCounter = document.getElementById('attempts-counter'); if (attemptsCounter) { attemptsCounter.innerHTML = `ุงููุญุงููุงุช ุงููุชุจููุฉ: <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full">${attemptsLeft}</span>`; } const quizHtml = questions.map((q, index) => { const optionsHTML = q.options.map((opt, optIndex) => `<div><input type="radio" name="q${index}" value="${opt.value}" id="q${index}_opt${optIndex}" class="hidden"><label for="q${index}_opt${optIndex}" class="option-label">${opt.display}</label></div>`).join(''); const smartExplanationButton = q.smartExplanation ? `<button type="button" data-question-index="${index}" class="smart-explain-btn hidden mt-2 text-xs text-purple-600 font-bold hover:underline">ุงูุญู ุงูุฐูู ๐ง</button>` : ''; return `<div class="p-4 border-2 border-gray-200 rounded-lg bg-white"><p class="font-bold text-lg">${index + 1}. <span class="text-yellow-500">${q.level}</span> ${q.text}</p>${q.graph || ''}<div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mt-3">${optionsHTML}</div><div id="feedback-q${index}" class="mt-2 text-sm font-bold"></div><div class="flex items-center space-x-4">${smartExplanationButton}<button type="button" data-question-index="${index}" class="explain-btn hidden mt-2 text-xs text-blue-600 hover:underline">ุงุนุฑู ููุงุฐุงุ</button></div></div>`; }).join(''); quizForm.innerHTML = quizHtml + `<button type="submit" id="submit-quiz-btn" class="w-full text-white bg-green-600 hover:bg-green-700 font-medium rounded-lg text-lg px-5 py-3 mt-8">ุชุญูู ูู ุฅุฌุงุจุงุชู</button>`; if (attemptsLeft <= 0) { const submitBtn = quizForm.querySelector('#submit-quiz-btn'); submitBtn.disabled = true; submitBtn.textContent = 'ูุง ุชูุฌุฏ ูุญุงููุงุช ูุชุจููุฉ'; submitBtn.classList.add('bg-gray-400', 'hover:bg-gray-400'); } quizForm.onsubmit = (e) => { e.preventDefault(); let score = 0; questions.forEach((q, index) => { const userAnswer = e.target.elements[`q${index}`]?.value; const feedbackEl = document.getElementById(`feedback-q${index}`); if (userAnswer === q.correct) { score++; feedbackEl.textContent = 'โ ุฅุฌุงุจุฉ ุตุญูุญุฉ!'; feedbackEl.className = 'mt-2 text-sm font-bold text-green-600'; } else { feedbackEl.textContent = `โ ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ.`; feedbackEl.className = 'mt-2 text-sm font-bold text-red-600'; } quizForm.querySelector(`[data-question-index="${index}"].explain-btn`).classList.remove('hidden'); const smartBtn = quizForm.querySelector(`[data-question-index="${index}"].smart-explain-btn`); if(smartBtn) smartBtn.classList.remove('hidden'); }); const finalGrade = Math.round((score / questions.length) * 10); const resultsDiv = document.getElementById('quiz-results'); resultsDiv.classList.remove('hidden'); document.getElementById('quiz-score').textContent = `${finalGrade} / 10`; if (studentData) { saveGrade(lessonId, finalGrade, studentData.id); if (attemptsLeft - 1 > 0) { document.getElementById('retake-quiz-btn').classList.remove('hidden'); } } else { document.getElementById('save-status').textContent = 'ุชู ุนุฑุถ ูุชูุฌุชู. ุณุฌู ุงูุฏุฎูู ูุญูุธ ุชูุฏูู.'; } e.target.querySelector('#submit-quiz-btn').disabled = true; }; }
    function saveGrade(lessonId, grade, studentId) { if (!studentId) return; const saveStatus = document.getElementById('save-status'); saveStatus.textContent = 'ุฌุงุฑู ุญูุธ ูุชูุฌุชู...'; const url = `${SCRIPT_URL}?action=saveGrade&studentId=${studentId}&lessonId=${lessonId}&grade=${grade}`; fetch(url) .then(res => res.json()) .then(result => { if (result.status === 'success') { saveStatus.textContent = 'โ ุชู ุญูุธ ูุชูุฌุชู ุจูุฌุงุญ! ุณุชุธูุฑ ูู ููุญุฉ ุงูุชุญูู ุนูุฏ ุงูุนูุฏุฉ.'; const studentData = JSON.parse(localStorage.getItem('currentStudent')); if (!studentData.lessons) studentData.lessons = {}; if (!studentData.lessons[lessonId] || studentData.lessons[lessonId].grade < grade) { studentData.lessons[lessonId] = { grade: grade, attempts: (studentData.lessons[lessonId]?.attempts || 0) + 1 }; } else { studentData.lessons[lessonId].attempts++; } localStorage.setItem('currentStudent', JSON.stringify(studentData)); } else { throw new Error(result.message); } }) .catch(error => { saveStatus.textContent = 'โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุงูุฏุฑุฌุฉ.'; console.error("Save Grade Error:", error); }); }
    function showExplanation(questionIndex, type = 'regular') { const modal = document.getElementById('explanationModal'); const modalTitle = document.getElementById('modal-title'); const explanationText = document.getElementById('explanationText'); const question = currentQuestions[questionIndex]; if(modal && explanationText && modalTitle && question) { if (type === 'smart' && question.smartExplanation) { modalTitle.textContent = '๐ง ุงูุญู ุงูุฐูู'; explanationText.innerHTML = question.smartExplanation; } else { modalTitle.textContent = '๐ก ุดุฑุญ ุงูุฅุฌุงุจุฉ'; explanationText.innerHTML = question.explanation; } modal.classList.remove('hidden'); } }
    function closeModal() { const modal = document.getElementById('explanationModal'); if(modal) modal.classList.add('hidden'); }
    
    // --- ูุดุบู ุงูููุฏ ุงูุฎุงุต ุจุงูุฏุฑุณ ---
    const LESSON_ID = 'c2_l2'; 
    function generateQuiz() {
        const questionBank = [
             { type: 'mcq', level: 'โญโญ', topic: 'linear-function', text: 'ุฃู ูู ุงููุนุงุฏูุงุช ุงูุชุงููุฉ ุชูุซู ุฏุงูุฉ ุฎุทูุฉุ', 
                options: [ 
                    { display: '<span class="math-eq">ุต = ูฅุณ - ูข</span>', value: 'A' },
                    { display: '<span class="math-eq">ุต = ุณ<sup>ูข</sup></span>', value: 'B' },
                    { display: '<span class="math-eq">ุต = |ุณ|</span>', value: 'C' },
                    { display: '<span class="math-eq">ุต = <span class="fraction"><span>ูก</span><span class="frac-bar"></span><span>ุณ</span></span></span>', value: 'D' }
                ], 
                correct: 'A', 
                explanation: `<p class='mb-2'>ุงูุฏุงูุฉ ุงูุฎุทูุฉ ูู ุงูุชู ูููู ูููุง ุงููุชุบูุฑ 'ุณ' ูุฑููุนุงู ููุฃุณ ูก (ุฃู ู). ุงููุนุงุฏูุฉ <span class='math-eq'>ุต = ูฅุณ - ูข</span> ูู ุฏุงูุฉ ุฎุทูุฉ. ุฃูุง ุงูุฎูุงุฑุงุช ุงูุฃุฎุฑู (<span class='math-eq'>ุต = ุณ<sup>ูข</sup></span>ุ <span class='math-eq'>ุต = |ุณ|</span>ุ ู <span class='math-eq'>ุต = <span class="fraction"><span>ูก</span><span class="frac-bar"></span><span>ุณ</span></span></span>) ูููุณุช ุฎุทูุฉ.</p>`,
                smartExplanation: `<p>ุจุจุณุงุทุฉุ ุงูุฏุงูุฉ ุงูุฎุทูุฉ ูุง ุชุญุชูู ุนูู ุฃุณุณ (ูุซู ุณ<sup>ูข</sup>) ุฃู ุฑููุฒ ุฎุงุตุฉ (ูุซู |ุณ|) ุฃู ูุชุบูุฑ ูู ุงูููุงู. ุงูุฎูุงุฑ (ุฃ) ูู ุงููุญูุฏ ุงูุฐู ูุญูู ูุฐุง ุงูุดุฑุท.</p>`
             },
             { type: 'mcq', level: 'โญโญ', topic: 'linear-function', text: 'ุฃู ูู ุงููุนุงุฏูุงุช ุงูุชุงููุฉ <strong>ูุง</strong> ุชูุซู ุฏุงูุฉ ุฎุทูุฉุ', 
                options: [ { display: '<span class="math-eq">ุต = ุณ + ูง</span>', value: 'A' }, { display: '<span class="math-eq">ุต = ุณ<sup>ูฃ</sup> + ูก</span>', value: 'B' }, { display: '<span class="math-eq">ุต = ูฃุณ</span>', value: 'C' }, { display: '<span class="math-eq">ุต = ูกู</span>', value: 'D' } ], 
                correct: 'B', 
                explanation: `<p class='mb-2'>ุงูุฏุงูุฉ <span class='math-eq'>ุต = ุณ<sup>ูฃ</sup> + ูก</span> ููุณุช ุฎุทูุฉ ูุฃู ุงููุชุบูุฑ 'ุณ' ูุฑููุน ููุฃุณ ูฃ (ุฏุงูุฉ ุชูุนูุจูุฉ). ุจุงูู ุงูุฎูุงุฑุงุช ุชูุซู ุฏูุงูุงู ุฎุทูุฉ.</p>`,
                smartExplanation: `<p>ุงุจุญุซ ุนู ุงููุนุงุฏูุฉ ุงูุชู ุชุญุชูู ุนูู ุฃุณ ุฃุนูู ูู ูก. ุงูุฎูุงุฑ (ุจ) ูุญุชูู ุนูู ุณ<sup>ูฃ</sup>ุ ุฅุฐู ูู ููุณุช ุฏุงูุฉ ุฎุทูุฉ.</p>`
             },
             { type: 'mcq', level: 'โญ', topic: 'is-function', text: 'ูู ุงูุนูุงูุฉ <span class="math-eq">{ (ูฅุ ูฃ)ุ (ูงุ ูข)ุ (ูฅุ ูก) }</span> ุชูุซู ุฏุงูุฉุ', 
                options: [ { display: 'ูุนู', value: 'ูุนู' }, { display: 'ูุง', value: 'ูุง' } ], 
                correct: 'ูุง', 
                explanation: `<p class='mb-2'>ูุงุ ูุฃู ุงูุนูุตุฑ <span class="math-eq">ูฅ</span> ูู ุงููุฌุงู ุงุฑุชุจุท ุจุนูุตุฑูู ูุฎุชูููู ูู ุงููุฏู (<span class="math-eq">ูฃ</span> ู <span class="math-eq">ูก</span>).</p>`,
                smartExplanation: `<p>ุจูุฌุฑุฏ ุงููุธุฑุ ููุงุญุธ ุชูุฑุงุฑ ุงูุฑูู ูฅ ูู ุงูุฅุญุฏุงุซู ุงูุฃูู (ุงูุณููู) ูุน ุฅุญุฏุงุซู ุซุงูู (ุตุงุฏู) ูุฎุชูู. ุฅุฐู ูู ููุณุช ุฏุงูุฉ.</p>`
             },
             { type: 'mcq', level: 'โญโญ', topic: 'vertical-line-test', text: 'ุฃู ูู ุงูุชูุซููุงุช ุงูุจูุงููุฉ ุงูุชุงููุฉ ูุง ููุซู ุฏุงูุฉุ', 
                graph: `<div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center mt-6">
                            <div class="p-2 bg-white rounded-lg shadow">
                                <h4 class="font-semibold mb-2">ุงูุฎูุงุฑ (ุฃ)</h4>
                                <svg viewBox="-5 -5 10 10" class="w-full h-32 bg-white border rounded-lg"><path d="M -4 4 Q 0 -4 4 4" stroke="#3b82f6" stroke-width="0.3" fill="none"/></svg>
                            </div>
                            <div class="p-2 bg-white rounded-lg shadow">
                                <h4 class="font-semibold mb-2">ุงูุฎูุงุฑ (ุจ)</h4>
                                <svg viewBox="-5 -5 10 10" class="w-full h-32 bg-white border rounded-lg"><path d="M 4 4 L -2 0 L 4 -4" stroke="#3b82f6" stroke-width="0.3" fill="none"/></svg>
                            </div>
                            <div class="p-2 bg-white rounded-lg shadow">
                                <h4 class="font-semibold mb-2">ุงูุฎูุงุฑ (ุฌ)</h4>
                                <svg viewBox="-5 -5 10 10" class="w-full h-32 bg-white border rounded-lg"><line x1="-4" y1="-2" x2="0" y2="-2" stroke="#3b82f6" stroke-width="0.3"/><circle cx="0" cy="-2" r="0.3" fill="white" stroke="#3b82f6" stroke-width="0.2" /><line x1="0" y1="2" x2="4" y2="2" stroke="#3b82f6" stroke-width="0.3"/><circle cx="0" cy="2" r="0.3" fill="#3b82f6" /></svg>
                            </div>
                        </div>`,
                options: [ { display: 'ุฃ', value: 'A' }, { display: 'ุจ', value: 'B' }, { display: 'ุฌ', value: 'C' } ], 
                correct: 'B', 
                explanation: `<p class='mb-2'>ุงูุฎูุงุฑ (ุจ) ูู ุงูุฐู ูุง ููุซู ุฏุงูุฉ. ุนูุฏ ุชุทุจูู ุงุฎุชุจุงุฑ ุงูุฎุท ุงูุฑุฃุณูุ ูุฌุฏ ุฃู ุงูุฎุท ุงูุฑุฃุณู ูููู ุฃู ููุทุน ุงูุชูุซูู ุงูุจูุงูู ูู ุฃูุซุฑ ูู ููุทุฉ ูุงุญุฏุฉุ ููุง ูุนูู ุฃู ููุงู ูููุฉ ูู 'ุณ' ุชุฑุชุจุท ุจุฃูุซุฑ ูู ูููุฉ ูู 'ุต'.</p>`
             },
             { type: 'mcq', level: 'โญโญโญ', topic: 'function-value', text: 'ุฅุฐุง ูุงูุช <span class="math-eq">ุฏ(ุณ) = ูขุณ - ูจ</span>ุ ููุง ูููุฉ <span class="math-eq">ุฏ(ูฆ)</span>ุ', 
                options: [ { display: '<span class="math-eq">ูค</span>', value: 'ูค' }, { display: '<span class="math-eq">ูกูข</span>', value: 'ูกูข' }, { display: '<span class="math-eq">-ูค</span>', value: '-ูค' }, { display: '<span class="math-eq">ูขู</span>', value: 'ูขู' } ], 
                correct: 'ูค', 
                explanation: `<p class='mb-2'>ูุฅูุฌุงุฏ ูููุฉ ุฏ(ูฆ)ุ ูุนูุถ ุนู ูู <span class="math-eq">ุณ</span> ุจุงูุฑูู <span class="math-eq">ูฆ</span> ูู ุงููุนุงุฏูุฉ.</p><div class='text-right space-y-2 p-2 bg-gray-100 rounded-md'><p>ุงููุนุงุฏูุฉ: <span class='math-eq'>ุฏ(ุณ) = ูขุณ - ูจ</span></p><p>ุงูุชุนููุถ: <span class='math-eq'>ุฏ(ูฆ) = ูข(ูฆ) - ูจ</span></p><p>ุงูุถุฑุจ: <span class='math-eq'>ุฏ(ูฆ) = ูกูข - ูจ</span></p><p>ุงููุงุชุฌ: <span class='math-eq'>ุฏ(ูฆ) = ูค</span></p></div>`,
                smartExplanation: `<p>ุฐูููุงู: ูข ุถุฑุจ ูฆ ูุณุงูู ูกูขุ ุซู ูกูข ูุงูุต ูจ ูุณุงูู ูค.</p>`
             },
             { type: 'mcq', level: 'โญโญ', topic: 'is-function', text: 'ุฃู ุงูุฌุฏุงูู ุงูุชุงููุฉ ููุซู ุฏุงูุฉุ', 
                options: [ { display: '<table class="w-full text-center border"><thead><tr><th class="border p-1">ุณ</th><th class="border p-1">ุต</th></tr></thead><tbody><tr><td class="border p-1">ูก</td><td class="border p-1">ูฃ</td></tr><tr><td class="border p-1">ูข</td><td class="border p-1">ูค</td></tr><tr><td class="border p-1">ูก</td><td class="border p-1">ูฅ</td></tr></tbody></table>', value: 'A' }, { display: '<table class="w-full text-center border"><thead><tr><th class="border p-1">ุณ</th><th class="border p-1">ุต</th></tr></thead><tbody><tr><td class="border p-1">-ูก</td><td class="border p-1">ูฅ</td></tr><tr><td class="border p-1">ู</td><td class="border p-1">ูฅ</td></tr><tr><td class="border p-1">ูก</td><td class="border p-1">ูฅ</td></tr></tbody></table>', value: 'B' } ], 
                correct: 'B', 
                explanation: `<p class='mb-2'>ุงูุฌุฏูู (ุจ) ููุซู ุฏุงูุฉ ูุฃู ูู ูููุฉ ูู ุณ (ุงููุฌุงู) ููุง ูููุฉ ูุงุญุฏุฉ ููุท ูู ุต (ุงููุฏู). ุฃูุง ูู ุงูุฌุฏูู (ุฃ)ุ ุงููููุฉ ูก ูู ุงููุฌุงู ุงุฑุชุจุทุช ุจูููุชูู ูุฎุชููุชูู (ูฃ ู ูฅ).</p>`,
                smartExplanation: `<p>ุงุจุญุซ ุนู ุชูุฑุงุฑ ูู ุนููุฏ 'ุณ'. ุงูุฌุฏูู (ุฃ) ููุฑุฑ ุงูุฑูู ูกุ ุฅุฐู ูู ููุณ ุฏุงูุฉ. ุงูุฌุฏูู (ุจ) ูุง ููุฑุฑ ุฃู ุฑูู ูู ุนููุฏ 'ุณ'ุ ุฅุฐู ูู ุฏุงูุฉ.</p>`
             },
             { type: 'mcq', level: 'โญ', topic: 'domain-range', text: 'ูุง ูู ูุฏู ุงูุฏุงูุฉ <span class="math-eq">{ (ู, ูก), (ูก, ูข), (ูข, ูฃ) }</span>ุ',
                 options: [ 
                     { display: '<span class="math-eq">{ู, ูก, ูข}</span>', value: 'A' }, 
                     { display: '<span class="math-eq">{ูก, ูข, ูฃ}</span>', value: 'B' },
                     { display: '<span class="math-eq">{ู, ูฃ}</span>', value: 'C' },
                     { display: '<span class="math-eq">{ู, ูก, ูข, ูฃ}</span>', value: 'D' }
                 ],
                 correct: 'B',
                 explanation: `<p class='mb-2'>ุงููุฏู ูู ูุฌููุนุฉ ูู ุงูุฅุญุฏุงุซูุงุช ุงูุซุงููุฉ (ููู ุต) ูู ุงูุฃุฒูุงุฌ ุงููุฑุชุจุฉ. ูู ูุฐู ุงูุญุงูุฉุ ููู ุต ูู ูกุ ูขุ ู ูฃ. ูุฐููุ ุงููุฏู ูู {ูก, ูข, ูฃ}. ุงูุฎูุงุฑ {ู, ูก, ูข} ููุซู ุงููุฌุงู.</p>`
             },
             { type: 'mcq', level: 'โญโญ', topic: 'domain-graph', text: 'ูู ุฎูุงู ุงูุฑุณู ุงูุจูุงูู ุงูุชุงููุ ูุง ูู ูุฌุงู ุงูุฏุงูุฉุ',
                options: [ { display: '<span class="math-eq">[-ูฃ, ูค]</span>', value: 'A' }, { display: '<span class="math-eq">[-ูข, ูฃ]</span>', value: 'B' }, { display: 'ูู ุงูุฃุนุฏุงุฏ ุงูุญููููุฉ', value: 'C' }, { display: '<span class="math-eq">[-ูข, ูค]</span>', value: 'D' } ],
                correct: 'A',
                explanation: `<p class='mb-2'>ุงููุฌุงู ูู ูุฌููุนุฉ ูู ููู 'ุณ' ุงูููููุฉ ุงูุชู ูุบุทููุง ุงูุฑุณู ุงูุจูุงูู. ููุงุญุธ ุฃู ุงูุฎุท ูุจุฏุฃ ูู <span class='math-eq'>ุณ = -ูฃ</span> (ููุทุฉ ูุบููุฉ) ูููุชูู ุนูุฏ <span class='math-eq'>ุณ = ูค</span> (ููุทุฉ ูุบููุฉ). ูุฐููุ ุงููุฌุงู ูู ุงููุชุฑุฉ ุงููุบููุฉ ูู -ูฃ ุฅูู ูคุ ูุงูุชู ุชูุชุจ ุนูู ุงูุตูุฑุฉ <span class='math-eq'>[-ูฃ, ูค]</span>.</p>`,
                graph: `<svg viewBox="-5 -5 10 10" class="w-full h-40 bg-white border rounded-lg mt-2">
                                <!-- Grid lines -->
                                <line x1="-5" y1="-4" x2="5" y2="-4" stroke="#e5e7eb" stroke-width="0.1" /><line x1="-5" y1="-3" x2="5" y2="-3" stroke="#e5e7eb" stroke-width="0.1" /><line x1="-5" y1="-2" x2="5" y2="-2" stroke="#e5e7eb" stroke-width="0.1" /><line x1="-5" y1="-1" x2="5" y2="-1" stroke="#e5e7eb" stroke-width="0.1" /><line x1="-5" y1="1" x2="5" y2="1" stroke="#e5e7eb" stroke-width="0.1" /><line x1="-5" y1="2" x2="5" y2="2" stroke="#e5e7eb" stroke-width="0.1" /><line x1="-5" y1="3" x2="5" y2="3" stroke="#e5e7eb" stroke-width="0.1" /><line x1="-5" y1="4" x2="5" y2="4" stroke="#e5e7eb" stroke-width="0.1" />
                                <line x1="-4" y1="-5" x2="-4" y2="5" stroke="#e5e7eb" stroke-width="0.1" /><line x1="-3" y1="-5" x2="-3" y2="5" stroke="#e5e7eb" stroke-width="0.1" /><line x1="-2" y1="-5" x2="-2" y2="5" stroke="#e5e7eb" stroke-width="0.1" /><line x1="-1" y1="-5" x2="-1" y2="5" stroke="#e5e7eb" stroke-width="0.1" /><line x1="1" y1="-5" x2="1" y2="5" stroke="#e5e7eb" stroke-width="0.1" /><line x1="2" y1="-5" x2="2" y2="5" stroke="#e5e7eb" stroke-width="0.1" /><line x1="3" y1="-5" x2="3" y2="5" stroke="#e5e7eb" stroke-width="0.1" /><line x1="4" y1="-5" x2="4" y2="5" stroke="#e5e7eb" stroke-width="0.1" />
                                <!-- Axes -->
                                <line x1="-5" y1="0" x2="5" y2="0" stroke="#9ca3af" stroke-width="0.2"/><line x1="0" y1="-5" x2="0" y2="5" stroke="#9ca3af" stroke-width="0.2"/>
                                <text x="4.5" y="-0.5" font-size="0.8" fill="#9ca3af">ุณ</text><text x="0.5" y="-4.5" font-size="0.8" fill="#9ca3af">ุต</text>
                                <!-- Function line -->
                                <line x1="-3" y1="-2" x2="4" y2="3" stroke="#3b82f6" stroke-width="0.4"/><circle cx="-3" cy="-2" r="0.3" fill="#3b82f6" /><circle cx="4" cy="3" r="0.3" fill="#3b82f6" />
                              </svg>`
             },
             { type: 'mcq', level: 'โญโญ', topic: 'arrow-diagram', text: 'ูู ุงููุฎุทุท ุงูุณููู ุงูุชุงูู ููุซู ุฏุงูุฉุ',
                options: [ { display: 'ูุนู', value: 'ูุนู' }, { display: 'ูุง', value: 'ูุง' } ],
                correct: 'ูุนู',
                explanation: `<p class='mb-2'>ูุนูุ ูุฐู ุงูุนูุงูุฉ ุชูุซู ุฏุงูุฉ. ุงูุดุฑุท ุงูุฃุณุงุณู ููุฏุงูุฉ ูู ุฃู ูู ุนูุตุฑ ูู <strong>ุงููุฌุงู</strong> ูุฌุจ ุฃู ูุฎุฑุฌ ููู ุณูู <strong>ูุงุญุฏ ููุท</strong>. ูู ูุฐุง ุงููุซุงูุ ูู ุนูุตุฑ ูู ุนูุงุตุฑ ุงููุฌุงู (ุฃุ ุจุ ุฌ) ูุฎุฑุฌ ููู ุณูู ูุงุญุฏ ุจุงูุถุจุทุ ููุฐุง ูุญูู ุดุฑุท ุงูุฏุงูุฉ. ูุง ููู ุฃู ุนูุตุฑูู ูู ุงููุฌุงู (ุฃ ู ุจ) ูุดูุฑุงู ุฅูู ููุณ ุงูุนูุตุฑ ูู ุงููุฏู.</p>`,
                graph: `<svg viewBox="0 0 120 100" class="w-full h-40 bg-white border rounded-lg mt-2"><defs><marker id="q-arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#3b82f6" /></marker></defs>
                                <rect x="75" y="5" width="40" height="90" rx="5" stroke="#60a5fa" fill="#eff6ff" /><text x="95" y="20" font-size="9" font-weight="bold" text-anchor="middle">ุงููุฌุงู</text>
                                <text x="95" y="40" font-size="9" text-anchor="middle">ุฃ</text><text x="95" y="60" font-size="9" text-anchor="middle">ุจ</text><text x="95" y="80" font-size="9" text-anchor="middle">ุฌ</text>
                                <rect x="5" y="15" width="40" height="70" rx="5" stroke="#34d399" fill="#f0fdf4" /><text x="25" y="30" font-size="9" font-weight="bold" text-anchor="middle">ุงููุฏู</text>
                                <text x="25" y="50" font-size="9" text-anchor="middle">ูก</text><text x="25" y="70" font-size="9" text-anchor="middle">ูข</text>
                                <path d="M 75 40 Q 60 45 45 50" stroke="#3b82f6" stroke-width="0.5" fill="none" marker-end="url(#q-arrow)" />
                                <path d="M 75 60 Q 60 55 45 50" stroke="#3b82f6" stroke-width="0.5" fill="none" marker-end="url(#q-arrow)" />
                                <path d="M 75 80 Q 60 75 45 70" stroke="#3b82f6" stroke-width="0.5" fill="none" marker-end="url(#q-arrow)" />
                              </svg>`
             },
             { type: 'mcq', level: 'โญโญ', topic: 'arrow-diagram', text: 'ูู ุงููุฎุทุท ุงูุณููู ุงูุชุงูู ููุซู ุฏุงูุฉุ',
                options: [ { display: 'ูุนู', value: 'ูุนู' }, { display: 'ูุง', value: 'ูุง' } ],
                correct: 'ูุง',
                explanation: `<p class='mb-2'>ูุงุ ูุฐู ุงูุนูุงูุฉ <strong>ููุณุช ุฏุงูุฉ</strong>. ุงูุณุจุจ ูู ุฃู ุงูุนูุตุฑ <strong class="text-red-600">'ุณ'</strong> ูู ุงููุฌุงู ูุฏ ุฎุฑุฌ ููู ุณููุงูุ ุฃุญุฏููุง ูุดูุฑ ุฅูู 'ูกู' ูุงูุขุฎุฑ ุฅูู 'ูขู' ูู ุงููุฏู. ูุฐุง ูุฎุงูู ุงูุดุฑุท ุงูุฃุณุงุณู ููุฏุงูุฉ ุงูุฐู ููุต ุนูู ุฃู ูู ุนูุตุฑ ูู ุงููุฌุงู ูุฌุจ ุฃู ูุฑุชุจุท ุจุนูุตุฑ <strong>ูุงุญุฏ ููุท</strong> ูู ุงููุฏู.</p>`,
                graph: `<svg viewBox="0 0 120 100" class="w-full h-40 bg-white border rounded-lg mt-2"><defs><marker id="q-arrow2" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#3b82f6" /></marker></defs>
                                <rect x="75" y="5" width="40" height="90" rx="5" stroke="#60a5fa" fill="#eff6ff" /><text x="95" y="20" font-size="9" font-weight="bold" text-anchor="middle">ุงููุฌุงู</text>
                                <text x="95" y="40" font-size="9" text-anchor="middle">ุณ</text><text x="95" y="60" font-size="9" text-anchor="middle">ุต</text><text x="95" y="80" font-size="9" text-anchor="middle">ุน</text>
                                <rect x="5" y="5" width="40" height="90" rx="5" stroke="#34d399" fill="#f0fdf4" /><text x="25" y="20" font-size="9" font-weight="bold" text-anchor="middle">ุงููุฏู</text>
                                <text x="25" y="40" font-size="9" text-anchor="middle">ูกู</text><text x="25" y="60" font-size="9" text-anchor="middle">ูขู</text><text x="25" y="80" font-size="9" text-anchor="middle">ูฃู</text>
                                <path d="M 75 40 Q 60 40 45 40" stroke="#ef4444" stroke-width="0.5" fill="none" marker-end="url(#q-arrow2)" />
                                <path d="M 75 40 Q 60 50 45 60" stroke="#ef4444" stroke-width="0.5" fill="none" marker-end="url(#q-arrow2)" />
                                <path d="M 75 60 Q 60 70 45 80" stroke="#3b82f6" stroke-width="0.5" fill="none" marker-end="url(#q-arrow2)" />
                              </svg>`
             },
             { type: 'mcq', level: 'โญโญโญ', topic: 'real-life', text: "ุฅุฐุง ูุงูุช ุชูููุฉ ุงุณุชุฆุฌุงุฑ ุณูุงุฑุฉ ุชูุญุณุจ ุจุงููุนุงุฏูุฉ <span class='math-eq'>ุช(ู) = ูฉูู + ูฅู</span>ุ ุญูุซ <span class='math-eq'>ุช</span> ูู ุงูุชูููุฉ ุงูุฅุฌูุงููุฉ ุจุงูุฑูุงู ู <span class='math-eq'>ู</span> ูู ุนุฏุฏ ุงูุฃูุงู. ูุง ูู ุชูููุฉ ุงุณุชุฆุฌุงุฑ ุงูุณูุงุฑุฉ ููุฏุฉ ูฃ ุฃูุงูุ",
                options: [ { display: 'ูฃูขู ุฑูุงู', value: '320' }, { display: 'ูขูงู ุฑูุงู', value: '270' }, { display: 'ูกูคู ุฑูุงู', value: '140' }, { display: 'ูฃูฆู ุฑูุงู', value: '360' } ],
                correct: '320',
                explanation: `<p class='mb-2'>ูุฅูุฌุงุฏ ุงูุชูููุฉุ ูุนูุถ ุนู ุนุฏุฏ ุงูุฃูุงู (ู) ุจุงูุฑูู ูฃ ูู ุงููุนุงุฏูุฉ: <span class='math-eq'>ุช(ูฃ) = ูฉู(ูฃ) + ูฅู</span>. ุฃููุงูุ ูุถุฑุจ ูฉู ูู ูฃ ููุญุตู ุนูู ูขูงู. ุซู ูุถูู ูฅู. <span class='math-eq'>ูขูงู + ูฅู = ูฃูขู</span>. ุฅุฐูุ ุงูุชูููุฉ ูู ูฃูขู ุฑูุงู.</p>`,
                smartExplanation: `<p>ุฐูููุงู: ุชูููุฉ ูฃ ุฃูุงู ูู (ูฃ ร ูฉู) = ูขูงูุ ุฒุงุฆุฏ ุงูุฑุณูู ุงูุซุงุจุชุฉ ูฅูุ ุงููุฌููุน ูฃูขู.</p>`
             },
             { type: 'mcq', level: 'โญโญโญ', topic: 'real-life', text: "ุชุณุชุฎุฏู ุงูุฏุงูุฉ <span class='math-eq'>ู(ุณ) = ูก.ูจุณ + ูฃูข</span> ูุชุญููู ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ูู ูุฆููุฉ (ุณ) ุฅูู ููุฑููุงูุช (ู). ุฅุฐุง ูุงูุช ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ูขู ุฏุฑุฌุฉ ูุฆููุฉุ ููู ุชููู ุจุงูููุฑููุงูุชุ",
                options: [ { display: 'ูฆูจยฐ ู', value: '68' }, { display: 'ูฅูขยฐ ู', value: '52' }, { display: 'ูฃูฆยฐ ู', value: '36' }, { display: 'ูงูขยฐ ู', value: '72' } ],
                correct: '68',
                explanation: `<p class='mb-2'>ูุนูุถ ุนู ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ุงููุฆููุฉ (ุณ) ุจุงูุฑูู ูขู: <span class='math-eq'>ู(ูขู) = ูก.ูจ(ูขู) + ูฃูข</span>. ูุถุฑุจ ูก.ูจ ูู ูขู ููุญุตู ุนูู ูฃูฆ. ุซู ูุถูู ูฃูข. <span class='math-eq'>ูฃูฆ + ูฃูข = ูฆูจ</span>. ุฅุฐูุ ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ูู ูฆูจยฐ ููุฑููุงูุช.</p>`,
                smartExplanation: `<p>ุฐูููุงู: ูก.ูจ ุถุฑุจ ูขู ูู ููุณู ูกูจ ุถุฑุจ ูข = ูฃูฆ. ุซู ูฃูฆ ุฒุงุฆุฏ ูฃูข ูุณุงูู ูฆูจ.</p>`
             }
        ];
        const shuffled = [...questionBank].sort(() => 0.5 - Math.random());
        const questionCount = Math.min(shuffled.length, 5);
        return shuffled.slice(0, questionCount);
    }
    document.addEventListener('DOMContentLoaded', () => {
        const student = getStudentFromStorage();
        const lessonTitleElement = document.getElementById('lesson-title');
        const lessonTitle = lessonTitleElement ? lessonTitleElement.textContent : null;
        buildHeader(student, lessonTitle);
        buildFooter();
        const questions = generateQuiz();
        initializeQuiz(LESSON_ID, questions, student);
        
        // --- Interactive Examples Logic ---
        const exampleContainers = document.querySelectorAll('[id^="interactive-container-"]');
        exampleContainers.forEach(container => {
            const exampleId = container.id.split('-')[2];
            if (exampleId === '1') {
                // Logic for Arrow Diagrams (Horizontal)
                const state = {
                    currentIndex: -1,
                    prevBtn: container.querySelector('.prev-btn'),
                    nextBtn: container.querySelector('.next-btn'),
                    resetBtn: container.querySelector('.reset-btn'),
                    diagrams: container.querySelectorAll('.example-diagram'),
                    placeholder: container.querySelector('.interactive-placeholder')
                };

                const updateButtons = () => {
                    const isFirstStep = state.currentIndex <= -1;
                    const isLastStep = state.currentIndex >= state.diagrams.length - 1;
                    state.prevBtn.disabled = isFirstStep;
                    
                    if (isLastStep) {
                        state.nextBtn.classList.add('hidden');
                        state.resetBtn.classList.remove('hidden');
                    } else {
                        state.nextBtn.classList.remove('hidden');
                        state.resetBtn.classList.add('hidden');
                    }
                };

                const resetExample = () => {
                    state.currentIndex = -1;
                    state.placeholder.classList.add('hidden');
                    state.diagrams.forEach(el => {
                        el.classList.remove('hidden');
                        el.classList.add('dimmed');
                        el.classList.remove('active');
                        
                        const analysis = el.querySelector('[id$="-analysis"]');
                        if (analysis) analysis.classList.add('hidden');

                        if (el.id === 'ex2-col') {
                            const ex2initial = el.querySelector('#ex2-initial');
                            const ex2analysis = el.querySelector('#ex2-analysis');
                            if (ex2initial) ex2initial.classList.remove('hidden');
                            if (ex2analysis) ex2analysis.classList.add('hidden');
                        }
                    });
                    updateButtons();
                };

                state.nextBtn.addEventListener('click', () => {
                    if (state.currentIndex < state.diagrams.length - 1) {
                        state.currentIndex++;
                        const currentDiagram = state.diagrams[state.currentIndex];
                        currentDiagram.classList.remove('dimmed');
                        currentDiagram.classList.add('active');
                        
                        const analysis = currentDiagram.querySelector('[id$="-analysis"]');
                        if (analysis) analysis.classList.remove('hidden');

                        if (currentDiagram.id === 'ex2-col') {
                            const ex2initial = currentDiagram.querySelector('#ex2-initial');
                            if (ex2initial) ex2initial.classList.add('hidden');
                        }
                        updateButtons();
                    }
                });

                state.prevBtn.addEventListener('click', () => {
                    if (state.currentIndex > -1) {
                        const currentDiagram = state.diagrams[state.currentIndex];
                        currentDiagram.classList.add('dimmed');
                        currentDiagram.classList.remove('active');

                        const analysis = currentDiagram.querySelector('[id$="-analysis"]');
                        if (analysis) analysis.classList.add('hidden');
                        
                        if (currentDiagram.id === 'ex2-col') {
                            const ex2initial = currentDiagram.querySelector('#ex2-initial');
                            if (ex2initial) ex2initial.classList.remove('hidden');
                        }

                        state.currentIndex--;
                        updateButtons();
                    }
                });

                state.resetBtn.addEventListener('click', resetExample);
                
                resetExample();

            } else if (exampleId === '3') {
                 // Logic for Example 3 (Additive steps)
                const state = { 
                    currentIndex: -1, 
                    steps: container.querySelectorAll('.step-interactive'), 
                    problemStatement: container.querySelector('.problem-statement'),
                    prevBtn: container.querySelector('.prev-btn'), 
                    nextBtn: container.querySelector('.next-btn'), 
                    resetBtn: container.querySelector('.reset-btn') 
                };

                const updateButtons = () => {
                    if (!state.nextBtn) return;
                    const isFirstStep = state.currentIndex <= -1;
                    const isLastStep = state.currentIndex >= state.steps.length - 1;
                    state.prevBtn.disabled = isFirstStep;
                    
                    if (isLastStep) {
                        state.nextBtn.classList.add('hidden');
                        state.resetBtn.classList.remove('hidden');
                    } else {
                        state.nextBtn.classList.remove('hidden');
                        state.resetBtn.classList.add('hidden');
                    }
                };

                const updateView = () => {
                    const inProgress = state.currentIndex !== -1;
                    if (state.problemStatement) {
                        state.problemStatement.classList.toggle('hidden', inProgress);
                    }
                    
                    state.steps.forEach((step, index) => {
                        if (index <= state.currentIndex) {
                            step.classList.add('active');
                        } else {
                            step.classList.remove('active');
                        }
                    });
                    updateButtons();
                };
                
                const resetExample = () => {
                    state.currentIndex = -1;
                    updateView();
                };

                state.nextBtn.addEventListener('click', () => {
                    if (state.currentIndex < state.steps.length - 1) {
                        state.currentIndex++;
                        updateView();
                    }
                });

                state.prevBtn.addEventListener('click', () => {
                    if (state.currentIndex > -1) {
                        state.currentIndex--;
                        updateView();
                    }
                });

                if (state.resetBtn) {
                    state.resetBtn.addEventListener('click', resetExample);
                }

                resetExample();
            } else {
                // Logic for Example 2 and other vertical examples (Replacement)
                const state = { 
                    currentIndex: -1, 
                    steps: container.querySelectorAll('.step-interactive'), 
                    problemStatement: container.querySelector('.problem-statement'),
                    prevBtn: container.querySelector('.prev-btn'), 
                    nextBtn: container.querySelector('.next-btn'), 
                    resetBtn: container.querySelector('.reset-btn') 
                };

                const updateButtons = () => {
                    if (!state.nextBtn) return;
                    const isFirstStep = state.currentIndex <= -1;
                    const isLastStep = state.currentIndex >= state.steps.length - 1;
                    state.prevBtn.disabled = isFirstStep;

                    if (isLastStep) {
                        state.nextBtn.classList.add('hidden');
                        state.resetBtn.classList.remove('hidden');
                    } else {
                        state.nextBtn.classList.remove('hidden');
                        state.resetBtn.classList.add('hidden');
                    }
                };
                
                const updateView = () => {
                    const inProgress = state.currentIndex !== -1;
                    if (state.problemStatement) {
                        state.problemStatement.classList.toggle('hidden', inProgress);
                    }

                    state.steps.forEach((step, index) => {
                        step.classList.toggle('active', index === state.currentIndex);
                    });
                    updateButtons();
                };

                const resetExample = () => {
                    state.currentIndex = -1;
                    updateView();
                };

                state.nextBtn.addEventListener('click', () => {
                    if (state.currentIndex < state.steps.length - 1) {
                        state.currentIndex++;
                        updateView();
                    }
                });

                state.prevBtn.addEventListener('click', () => {
                    if (state.currentIndex > -1) {
                        state.currentIndex--;
                        updateView();
                    }
                });

                if (state.resetBtn) {
                    state.resetBtn.addEventListener('click', resetExample);
                }
                
                resetExample();
            }
        });
        
        // --- Vertical Line Test Canvas Logic ---
        const vltCanvases = [
            { id: 'vlt-canvas-1', statusId: 'vlt-status-1', type: 'parabola' },
            { id: 'vlt-canvas-2', statusId: 'vlt-status-2', type: 'sideways-parabola' },
            { id: 'vlt-canvas-3', statusId: 'vlt-status-3', type: 'step' }
        ];

        vltCanvases.forEach(vlt => {
            const canvas = document.getElementById(vlt.id);
            const statusEl = document.getElementById(vlt.statusId);
            if (!canvas || !statusEl) return;
            const ctx = canvas.getContext('2d');
            let lineX = 0;
            let direction = 1;
            let animationFrameId = null;

            function draw() {
                const width = canvas.width;
                const height = canvas.height;
                const midX = width / 2;
                const midY = height / 2;
                const scale = 20;

                ctx.clearRect(0, 0, width, height);

                // Draw axes
                ctx.beginPath();
                ctx.moveTo(0, midY);
                ctx.lineTo(width, midY);
                ctx.moveTo(midX, 0);
                ctx.lineTo(midX, height);
                ctx.strokeStyle = '#cbd5e1';
                ctx.stroke();
                
                // Draw function graph
                ctx.beginPath();
                ctx.strokeStyle = '#3b82f6';
                ctx.lineWidth = 2;

                if (vlt.type === 'parabola') {
                    for (let i = 0; i < width; i++) {
                        const x = (i - midX) / scale;
                        const y = -(0.25 * x * x - 2) * scale + midY;
                        if (i === 0) ctx.moveTo(i, y); else ctx.lineTo(i, y);
                    }
                } else if (vlt.type === 'sideways-parabola') {
                    for (let i = 0; i < height; i++) {
                        const y = (i - midY) / scale;
                        const x = (-0.5 * y * y + 3) * scale + midX;
                        if (i === 0) ctx.moveTo(x, i); else ctx.lineTo(x, i);
                    }
                } else if (vlt.type === 'step') {
                    ctx.moveTo(0, midY + 2 * scale);
                    ctx.lineTo(midX, midY + 2 * scale);
                    ctx.moveTo(midX, midY - 2 * scale);
                    ctx.lineTo(width, midY - 2 * scale);
                }
                ctx.stroke();

                if (vlt.type === 'step') {
                    ctx.beginPath();
                    ctx.arc(midX, midY - 2 * scale, 4, 0, 2 * Math.PI);
                    ctx.fillStyle = 'white';
                    ctx.fill();
                    ctx.stroke();
                    ctx.beginPath();
                    ctx.arc(midX, midY + 2 * scale, 4, 0, 2 * Math.PI);
                    ctx.fillStyle = '#3b82f6';
                    ctx.fill();
                }

                // Draw vertical line
                ctx.beginPath();
                ctx.moveTo(lineX, 0);
                ctx.lineTo(lineX, height);
                ctx.strokeStyle = 'rgba(220, 38, 38, 0.7)';
                ctx.setLineDash([5, 5]);
                ctx.stroke();
                ctx.setLineDash([]);

                // Check intersections
                let intersections = [];
                const xVal = (lineX - midX) / scale;

                if (vlt.type === 'parabola') {
                    const y = -(0.25 * xVal * xVal - 2) * scale + midY;
                    intersections.push({ x: lineX, y: y });
                } else if (vlt.type === 'sideways-parabola') {
                    const innerSqrt = 2 * (3 - xVal);
                    if (innerSqrt >= 0) {
                        const y1 = -Math.sqrt(innerSqrt) * scale + midY;
                        const y2 = Math.sqrt(innerSqrt) * scale + midY;
                        intersections.push({ x: lineX, y: y1 });
                        intersections.push({ x: lineX, y: y2 });
                    }
                } else if (vlt.type === 'step') {
                    if (xVal < 0) {
                        intersections.push({ x: lineX, y: midY + 2 * scale });
                    } else {
                        intersections.push({ x: lineX, y: midY - 2 * scale });
                    }
                }
                
                // Draw intersection points and update status
                ctx.fillStyle = '#dc2626';
                intersections.forEach(p => {
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, 5, 0, 2 * Math.PI);
                    ctx.fill();
                });

                if (intersections.length > 1) {
                    statusEl.textContent = `ููุงุท ุงูุชูุงุทุน: ${intersections.length} (ููุณุช ุฏุงูุฉ)`;
                    statusEl.className = 'text-sm mt-2 font-semibold text-red-600';
                } else if (intersections.length === 1) {
                    statusEl.textContent = 'ููุงุท ุงูุชูุงุทุน: ูก (ุฏุงูุฉ)';
                    statusEl.className = 'text-sm mt-2 font-semibold text-green-600';
                } else {
                    statusEl.textContent = 'ููุงุท ุงูุชูุงุทุน: ู';
                    statusEl.className = 'text-sm mt-2 font-semibold text-gray-600';
                }

                // Animate line
                lineX += direction * 0.5;
                if (lineX > width || lineX < 0) {
                    direction *= -1;
                }
            }

            function animate() {
                draw();
                animationFrameId = requestAnimationFrame(animate);
            }
            
            function resizeCanvas() {
                if (animationFrameId) {
                    cancelAnimationFrame(animationFrameId);
                }
                const container = canvas.parentElement;
                canvas.width = container.clientWidth;
                canvas.height = container.clientHeight;
                animate();
            }
            window.addEventListener('resize', resizeCanvas);
            resizeCanvas();
        });

        const retakeBtn = document.getElementById('retake-quiz-btn');
        if(retakeBtn) { retakeBtn.addEventListener('click', () => { window.location.reload(); }); }
        const closeModalBtn = document.getElementById('closeModalBtn');
        if(closeModalBtn) { closeModalBtn.addEventListener('click', closeModal); }
        
        document.querySelector('#quizForm').addEventListener('click', function(event) {
            if (event.target.classList.contains('explain-btn')) {
                const index = event.target.getAttribute('data-question-index');
                showExplanation(index, 'regular');
            }
            if (event.target.classList.contains('smart-explain-btn')) {
                const index = event.target.getAttribute('data-question-index');
                showExplanation(index, 'smart');
            }
        });
    });
    </script>
</body>
</html>
