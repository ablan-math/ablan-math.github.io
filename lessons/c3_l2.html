<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงูุฏุฑุณ ูฃ-ูข: ูุชุงุจุฉ ุงููุนุงุฏูุงุช ุจุตูุบุฉ ุงูููู ูุงูููุทุน | ููุตุฉ ุงูุฑูุงุถูุงุช ุงูุชูุงุนููุฉ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; }
        .hidden { display: none; }
        .vocab-term { background-color: #ffefc5; padding: 2px 6px; border-radius: 4px; font-weight: bold; }
        .option-label { display: block; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; cursor: pointer; transition: all 0.2s ease-in-out; }
        .option-label:hover { border-color: #3b82f6; background-color: #eff6ff; }
        input[type="radio"]:checked + .option-label { border-color: #2563eb; background-color: #dbeafe; box-shadow: 0 0 0 2px #bfdbfe; }
        input[type="radio"] { display: none; }
        .feedback-correct { color: #16a34a; }
        .feedback-incorrect { color: #dc2626; }
        
        .math-eq {
            font-family: "Courier New", monospace;
            font-size: 1.2rem;
            font-weight: bold;
            color: #4338ca;
            background-color: #f3f4f6;
            border: 1px solid #d1d5db;
            padding: 2px 8px;
            border-radius: 6px;
            display: inline-block;
            vertical-align: middle;
        }
        
        .fraction { display: inline-flex; flex-direction: column; text-align: center; vertical-align: middle; margin: 0 0.2em; }
        .fraction > span { display: block; padding: 0 0.4em; }
        .fraction > span:last-child { border-top: 2px solid #4338ca; }

        /* ุฃููุงุท ูุถุงูุฉ ูู ุงูุฏุฑุณ ุงููุฏูู ูุถูุงู ุนูู ุงูุฃูุซูุฉ */
        .nav-btn:disabled {
            background-color: #9ca3af;
            cursor: not-allowed;
        }
        .explanation-step { 
            padding-right: 12px; 
            margin-bottom: 1rem; 
            border-right: 3px solid #1d4ed8; 
            transition: opacity 0.5s ease-in-out; 
        }
        .explanation-step:last-child { margin-bottom: 0; }
    </style>
</head>
<body class="bg-gray-100">
    <div id="app-container" class="grid grid-template-rows: auto 1fr auto; min-height: 100vh;">
        <header id="main-header" class="bg-white shadow-md sticky top-0 z-50"></header>
        <main class="container mx-auto max-w-4xl my-8">
            <div class="p-6 bg-white rounded-xl shadow-lg">
                <header class="flex justify-between items-center mb-8 border-b pb-4 border-gray-200">
                    <h1 id="lesson-title" class="text-3xl font-bold text-blue-800">ุงูุฏุฑุณ ูฃ-ูข: ูุชุงุจุฉ ุงููุนุงุฏูุงุช ุจุตูุบุฉ ุงูููู ูุงูููุทุน</h1>
                    <a href="../index.html" target="_top" class="text-sm text-blue-600 hover:underline">&larr; ุงูุนูุฏุฉ ุฅูู ุงูููุฑุณ</a>
                </header>
                
                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">๐ก ุฃููุงู: ุงูููุงููู ุงูุฃุณุงุณูุฉ</h2>
                    <div class="p-6 bg-blue-50 rounded-lg space-y-6">
                        <div>
                            <h3 class="text-xl font-semibold text-blue-700 mb-2">ูุชุงุจุฉ ูุนุงุฏูุฉ ูุณุชููู ุจูุนุฑูุฉ ูููู ูููุทุฉ ููุฑ ุจูุง</h3>
                            <p>ุฅุฐุง ุนููู ููู ุงููุณุชููู (ู) ูููุทุฉ ููุฑ ุจูุง (ุณโ, ุตโ)ุ ูููููุง ูุชุงุจุฉ ูุนุงุฏูุชู ุจุตูุบุฉ ุงูููู ูุงูููุทุน <span class="math-eq">ุต = ู ุณ + ุจ</span> ุจุงุชุจุงุน ุงูุฎุทูุงุช ุงูุชุงููุฉ:</p>
                            <div class="mt-4 space-y-4">
                                <div class="bg-white p-3 rounded-lg border">
                                    <p><strong>ุงูุฎุทูุฉ 1:</strong> ุนูุถ ุจุงูููู (ู) ูุฅุญุฏุงุซูุงุช ุงูููุทุฉ (ุณโุ ุตโ) ูู ุงููุนุงุฏูุฉ <span class="math-eq">ุต = ู ุณ + ุจ</span>.</p>
                                     <p><strong>ุงูุฎุทูุฉ 2:</strong> ุญู ุงููุนุงุฏูุฉ ูุฅูุฌุงุฏ ูููุฉ ุงูููุทุน ุงูุตุงุฏู (ุจ).</p>
                                     <p><strong>ุงูุฎุทูุฉ 3:</strong> ุงูุชุจ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ ุจุชุนููุถ ุงูููู (ู) ูุงูููุทุน ุงูุตุงุฏู (ุจ).</p>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold text-blue-700 mb-2">ูุชุงุจุฉ ูุนุงุฏูุฉ ูุณุชููู ุจูุนุฑูุฉ ููุทุชูู ููุฑ ุจููุง</h3>
                            <p>ุฅุฐุง ุนูููุช ููุทุชุงู ููุฑ ุจููุง ุงููุณุชูููุ ูููููุง ูุชุงุจุฉ ูุนุงุฏูุชู ุจุงุชุจุงุน ุงูุฎุทูุงุช ุงูุชุงููุฉ:</p>
                             <div class="mt-4 p-4 bg-white rounded-lg border space-y-2">
                                 <p><strong>ุงูุฎุทูุฉ 1:</strong> ุฃูุฌุฏ ููู ุงููุณุชููู (ู) ุจุงุณุชุฎุฏุงู ุงูููุทุชูู ูุตูุบุฉ ุงูููู.</p>
                                 <p class="text-center my-2 p-3 bg-indigo-50 rounded-md text-xl math-eq">
                                     ู = <span class="fraction"><span>ุตโ - ุตโ</span><span>ุณโ - ุณโ</span></span>
                                 </p>
                                 <p><strong>ุงูุฎุทูุฉ 2:</strong> ุงุฎุชุฑ ุฅุญุฏู ุงูููุทุชููุ ุซู ุงุชุจุน ููุณ ุฎุทูุงุช ุงูุทุฑููุฉ ุงูุณุงุจูุฉ ูุฅูุฌุงุฏ ุงูููุทุน ุงูุตุงุฏู (ุจ) ููุชุงุจุฉ ุงููุนุงุฏูุฉ.</p>
                             </div>
                        </div>
                         <div>
                            <h3 class="text-xl font-semibold text-blue-700 mb-2">ููุฑุฏุงุช ุฌุฏูุฏุฉ: ุงูุชูุจุค ุงูุฎุทู</h3>
                            <p>ููุณุชุฎุฏู <span class="vocab-term">ุงูุชูุจุค ุงูุฎุทู</span> ูุนูู ุชูุจุคุงุช ุญูู ููู ุชูุน ุฎุงุฑุฌ ูุทุงู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงููุชููุฑุฉ. ูุฐูู ุนู ุทุฑูู ุฅูุฌุงุฏ ูุนุงุฏูุฉ ุงูุฎุท ุงููุณุชููู ุงูุชู ุชูุซู ุงูุนูุงูุฉ ุจูู ูุชุบูุฑููุ ุซู ุงุณุชุฎุฏุงู ูุฐู ุงููุนุงุฏูุฉ ูุชูุฏูุฑ ูููุฉ ูุฌูููุฉ.</p>
                        </div>
                    </div>
                </section>
                
                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">๐ฏ ุซุงููุงู: ุฃูุซูุฉ ุชูุงุนููุฉ</h2>
                    
                    <!-- ุฃูุซูุฉ: ุฅูุฌุงุฏ ุงููุนุงุฏูุฉ ูู ููู ูููุทุฉ -->
                    <div class="p-6 bg-gray-50 rounded-lg space-y-4 mb-8">
                        <h3 class="text-xl font-bold text-gray-700 mb-4 border-b pb-2">ุงูููุน ุงูุฃูู: ุฅูุฌุงุฏ ุงููุนุงุฏูุฉ ูู ููู ูููุทุฉ</h3>
                        <div class="flex flex-col md:flex-row gap-6">
                            <!-- ุงููุซุงู ุงูุฃูู (ุฃ) -->
                            <div class="flex-1">
                                <p class="mb-2"><b>ูุซุงู ูก (ุฃ):</b> ุงูุชุจ ูุนุงุฏูุฉ ุงููุณุชููู ุงูุฐู ูููู <span class="text-red-600 font-bold">ูค</span> ูููุฑ ุจุงูููุทุฉ (<span class="text-red-600 font-bold">ูข</span>ุ <span class="text-blue-600 font-bold">ูฅ</span>).</p>
                                <div class="border p-4 rounded-lg bg-white h-full flex flex-col">
                                    <div class="bg-gray-100 p-4 rounded-lg border flex-grow">
                                        <div id="interactive-explanation-1a" class="text-right"></div>
                                    </div>
                                    <div class="mt-4 flex justify-between items-center">
                                        <button id="interactive-back-1a" class="nav-btn bg-gray-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-gray-600 text-sm">ุฑุฌูุน</button>
                                        <span class="text-sm font-bold text-gray-600">ุงูุฎุทูุฉ <span id="interactive-step-counter-1a">0</span> / 3</span>
                                        <button id="interactive-next-1a" class="nav-btn bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg hover:bg-indigo-700 text-sm">ุงูุชุงูู</button>
                                    </div>
                                </div>
                            </div>

                            <!-- ุงููุซุงู ุงูุฃูู (ุจ) -->
                            <div class="flex-1">
                                <p class="mb-2"><b>ูุซุงู ูก (ุจ):</b> ุงูุชุจ ูุนุงุฏูุฉ ุงููุณุชููู ุงูุฐู ูููู <span class="text-red-600 font-bold">-ูข</span> ูููุฑ ุจุงูููุทุฉ (<span class="text-red-600 font-bold">-ูก</span>ุ <span class="text-blue-600 font-bold">ูฆ</span>).</p>
                                <div class="border p-4 rounded-lg bg-white h-full flex flex-col">
                                    <div class="bg-gray-100 p-4 rounded-lg border flex-grow">
                                        <div id="interactive-explanation-1b" class="text-right"></div>
                                    </div>
                                    <div class="mt-4 flex justify-between items-center">
                                        <button id="interactive-back-1b" class="nav-btn bg-gray-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-gray-600 text-sm">ุฑุฌูุน</button>
                                        <span class="text-sm font-bold text-gray-600">ุงูุฎุทูุฉ <span id="interactive-step-counter-1b">0</span> / 3</span>
                                        <button id="interactive-next-1b" class="nav-btn bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg hover:bg-indigo-700 text-sm">ุงูุชุงูู</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ุฃูุซูุฉ: ุฅูุฌุงุฏ ุงููุนุงุฏูุฉ ูู ููุทุชูู -->
                    <div class="p-6 bg-gray-50 rounded-lg space-y-4 mb-8">
                        <h3 class="text-xl font-bold text-gray-700 mb-4 border-b pb-2">ุงูููุน ุงูุซุงูู: ุฅูุฌุงุฏ ุงููุนุงุฏูุฉ ูู ููุทุชูู</h3>
                        <div class="flex flex-col md:flex-row gap-6">
                            <!-- ุงููุซุงู ุงูุซุงูู (ุฃ) -->
                             <div class="flex-1">
                                <p class="mb-2"><b>ูุซุงู ูข (ุฃ):</b> ุงูุชุจ ูุนุงุฏูุฉ ุงููุณุชููู ุงููุงุฑ ุจุงูููุทุชูู (<span class="text-red-600 font-bold">ูก</span>ุ <span class="text-blue-600 font-bold">ูข</span>) ู (<span class="text-red-600 font-bold">ูฃ</span>ุ <span class="text-blue-600 font-bold">ูจ</span>).</p>
                                <div class="border p-4 rounded-lg bg-white h-full flex flex-col">
                                    <div class="bg-gray-100 p-4 rounded-lg border flex-grow">
                                        <div id="interactive-explanation-2a" class="text-right"></div>
                                    </div>
                                    <div class="mt-4 flex justify-between items-center">
                                        <button id="interactive-back-2a" class="nav-btn bg-gray-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-gray-600 text-sm">ุฑุฌูุน</button>
                                        <span class="text-sm font-bold text-gray-600">ุงูุฎุทูุฉ <span id="interactive-step-counter-2a">0</span> / 3</span>
                                        <button id="interactive-next-2a" class="nav-btn bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg hover:bg-indigo-700 text-sm">ุงูุชุงูู</button>
                                    </div>
                                </div>
                            </div>
                        
                            <!-- ุงููุซุงู ุงูุซุงูู (ุจ) -->
                            <div class="flex-1">
                                <p class="mb-2"><b>ูุซุงู ูข (ุจ):</b> ุงูุชุจ ูุนุงุฏูุฉ ุงููุณุชููู ุงููุงุฑ ุจุงูููุทุชูู (<span class="text-red-600 font-bold">ูข</span>ุ <span class="text-blue-600 font-bold">ูฅ</span>) ู (<span class="text-red-600 font-bold">ูค</span>ุ <span class="text-blue-600 font-bold">ูก</span>).</p>
                                <div class="border p-4 rounded-lg bg-white h-full flex flex-col">
                                    <div class="bg-gray-100 p-4 rounded-lg border flex-grow">
                                        <div id="interactive-explanation-2b" class="text-right"></div>
                                    </div>
                                    <div class="mt-4 flex justify-between items-center">
                                        <button id="interactive-back-2b" class="nav-btn bg-gray-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-gray-600 text-sm">ุฑุฌูุน</button>
                                        <span class="text-sm font-bold text-gray-600">ุงูุฎุทูุฉ <span id="interactive-step-counter-2b">0</span> / 3</span>
                                        <button id="interactive-next-2b" class="nav-btn bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg hover:bg-indigo-700 text-sm">ุงูุชุงูู</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ูุซุงู: ุงูุชูุจุค ุงูุฎุทู -->
                    <div class="p-6 bg-gray-50 rounded-lg space-y-4">
                        <h3 class="text-xl font-bold text-gray-700 mb-4 border-b pb-2">ุงูููุน ุงูุซุงูุซ: ุงูุชูุจุค ุงูุฎุทู</h3>
                         <div class="flex flex-col md:flex-row gap-6">
                            <!-- ุงููุซุงู ุงูุซุงูุซ (ุฃ) - ุชู ุงูุชุจุฏูู -->
                            <div class="flex-1">
                                <p class="mb-2"><b>ูุซุงู ูฃ (ุฃ):</b> ูุฏูุน ุนูู ุงุดุชุฑุงูุงู ูู ูุงุฏู ุฑูุงุถู. ุจุนุฏ <span class="text-red-600 font-bold">ุดูุฑูู</span>ุ ูุงู ูุฌููุน ูุง ุฏูุนู <span class="text-blue-600 font-bold">300 ุฑูุงู</span>. ุจุนุฏ <span class="text-red-600 font-bold">5 ุฃุดูุฑ</span>ุ ูุงู ุงููุฌููุน <span class="text-blue-600 font-bold">600 ุฑูุงู</span>. ูู ุณูุฏูุน ุจุนุฏ <span class="text-red-600 font-bold">8 ุฃุดูุฑ</span>ุ</p>
                                <div class="border p-4 rounded-lg bg-white h-full">
                                    <div class="bg-gray-100 p-4 rounded-lg border min-h-[210px]">
                                        <div id="interactive-explanation-3a" class="text-right"></div>
                                    </div>
                                    <div class="mt-4 flex justify-between items-center">
                                        <button id="interactive-back-3a" class="nav-btn bg-gray-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-gray-600 text-sm">ุฑุฌูุน</button>
                                        <span class="text-sm font-bold text-gray-600">ุงูุฎุทูุฉ <span id="interactive-step-counter-3a">0</span> / 4</span>
                                        <button id="interactive-next-3a" class="nav-btn bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg hover:bg-indigo-700 text-sm">ุงูุชุงูู</button>
                                    </div>
                                </div>
                            </div>
                            <!-- ุงููุซุงู ุงูุซุงูุซ (ุจ) - ุชู ุงูุชุจุฏูู -->
                            <div class="flex-1">
                                <p class="mb-2"><b>ูุซุงู ูฃ (ุจ):</b> ูุชูุงุถู ุทูุงู ุฃุฌุฑุฉ ุฃุณุจูุนูุฉ ูุฏุฑูุง <span class="text-blue-600 font-bold">ูฃูฅูก ุฑูุงูุงู</span>. ูุฅุฐุง ุนูู <span class="text-red-600 font-bold">ูฅ ุณุงุนุงุช</span> ุฅุถุงููุฉ ูุชูุงุถู <span class="text-blue-600 font-bold">ูคูกูฆ ุฑูุงูุงู</span>ุ ุงูุชุจ ูุนุงุฏูุฉ ุฎุทูุฉ ูุฅูุฌุงุฏ ุฃุฌุฑุชู. ุซู ุชูุจุฃ ุจุฃุฌุฑุชู ุฅุฐุง ุนูู <span class="text-red-600 font-bold">ูจ ุณุงุนุงุช</span> ุฅุถุงููุฉ.</p>
                                <div class="border p-4 rounded-lg bg-white h-full">
                                    <div class="bg-gray-100 p-4 rounded-lg border min-h-[210px]">
                                        <div id="interactive-explanation-3b" class="text-right"></div>
                                    </div>
                                    <div class="mt-4 flex justify-between items-center">
                                        <button id="interactive-back-3b" class="nav-btn bg-gray-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-gray-600 text-sm">ุฑุฌูุน</button>
                                        <span class="text-sm font-bold text-gray-600">ุงูุฎุทูุฉ <span id="interactive-step-counter-3b">0</span> / 5</span>
                                        <button id="interactive-next-3b" class="nav-btn bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg hover:bg-indigo-700 text-sm">ุงูุชุงูู</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <section class="mt-12">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-bold text-gray-800">โ๏ธ ุฑุงุจุนุงู: ุญุงู ุฏูุฑู! ุงุฎุชุจุฑ ูููู</h2>
                        <div id="attempts-counter" class="text-sm font-bold text-gray-600"></div>
                    </div>
                    <form id="quizForm" class="p-6 bg-gray-50 rounded-lg space-y-8"></form>
                    <div id="quiz-results" class="hidden mt-6 p-4 rounded-lg text-center">
                        <h3 class="text-xl font-bold">ูุชูุฌุชู ุงูููุงุฆูุฉ</h3>
                        <p id="quiz-score" class="text-4xl font-bold my-2"></p>
                        <div id="save-status" class="mt-4 text-sm font-semibold"></div>
                        <button id="retake-quiz-btn" class="hidden mt-4 bg-blue-600 text-white font-medium py-2 px-6 rounded-lg hover:bg-blue-700">ุฅุนุงุฏุฉ ุงูุงุฎุชุจุงุฑ</button>
                    </div>
                </section>
            </div>
        </main>
        <footer id="main-footer" class="bg-gray-200 py-4"></footer>
    </div>
    <div id="explanationModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-lg shadow-2xl p-6 max-w-lg w-full">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold">๐ก ุดุฑุญ ุงูุฅุฌุงุจุฉ</h3>
                <button id="closeModalBtn" class="p-2 -m-2 rounded-full hover:bg-gray-200">
                    <svg class="h-6 w-6 text-gray-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <div id="explanationText" class="text-gray-700 max-h-[60vh] overflow-y-auto space-y-2"></div>
        </div>
    </div>
    <script>
    // ===================================================================
    // โ๏ธ ุฏูุงู ูุดุชุฑูุฉ ูุฃูุธูุฉ ุงูููุตุฉ (ูุง ุชูู ุจุชุนุฏูู ูุฐุง ุงูุฌุฒุก)
    // ===================================================================
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzrf1-At3Pq7i39bGV3F1iD3-b0G-WWyRi5cgpKeQjyn_N5fh2EmGhoyRKUsbLd-F_UJQ/exec";
    const MAX_ATTEMPTS = 3;
    let currentQuestions = []; 
    function getStudentFromStorage() { const studentDataString = localStorage.getItem('currentStudent'); if (studentDataString) { try { return JSON.parse(studentDataString); } catch (e) { return null; } } return null; }
    function buildHeader(studentData, lessonTitle = null) { const headerContainer = document.getElementById('main-header'); if (!headerContainer) return; let titleHtml; if (lessonTitle) { titleHtml = `<div><h2 class="text-sm text-gray-500 leading-tight">ููุตุฉ ุงูุฑูุงุถูุงุช ุงูุชูุงุนููุฉ</h2><h1 class="text-xl font-bold text-indigo-700 leading-tight">${lessonTitle}</h1></div>`; } else { titleHtml = `<a href="../index.html" target="_top"><h1 class="text-2xl font-bold text-blue-800">ููุตุฉ ุงูุฑูุงุถูุงุช ุงูุชูุงุนููุฉ</h1></a>`; } let userInfoHtml = ''; if (studentData) { userInfoHtml = `<div class="flex items-center gap-4"><span class="font-semibold">ุฃููุงูุ ${studentData.name}</span><a href="../index.html" target="_top" id="logout-link" class="bg-red-500 text-white py-1 px-3 rounded-lg hover:bg-red-600">ุฎุฑูุฌ</a></div>`; } else { userInfoHtml = `<p class="text-lg text-gray-600">ุฒุงุฆุฑ</p>`; } headerContainer.innerHTML = `<div class="container mx-auto px-6 py-4 flex justify-between items-center">${titleHtml}${userInfoHtml}</div>`; const logoutLink = headerContainer.querySelector('#logout-link'); if(logoutLink) { logoutLink.addEventListener('click', () => { localStorage.removeItem('currentStudent'); }); } }
    function buildFooter() { const footerContainer = document.getElementById('main-footer'); if (!footerContainer) return; footerContainer.innerHTML = `<div class="container mx-auto px-6"><p class="text-center text-gray-600 text-sm">ยฉ 2024 ุฌููุน ุงูุญููู ูุญููุธุฉ | ุชุตููู ูุชุทููุฑ: ุฃ. ุนุจุฏุงูุนุฒูุฒ ุฎุงูุฏ ุงูุนุจูุงู</p></div>`; }
    function initializeQuiz(lessonId, questions, studentData) { currentQuestions = questions; const quizForm = document.getElementById('quizForm'); if (!quizForm) return; if (questions.length === 0) { quizForm.innerHTML = `<p class="text-center text-gray-600">ูุง ุชูุฌุฏ ุฃุณุฆูุฉ ูุชุงุญุฉ ููุฐุง ุงูุฏุฑุณ ุญุงููุงู.</p>`; return; } let attemptsLeft; if (studentData) { const studentLessonData = studentData.lessons?.[lessonId] || { attempts: 0 }; attemptsLeft = MAX_ATTEMPTS - studentLessonData.attempts; } else { attemptsLeft = 1; } const attemptsCounter = document.getElementById('attempts-counter'); if (attemptsCounter) { attemptsCounter.innerHTML = `ุงููุญุงููุงุช ุงููุชุจููุฉ: <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full">${attemptsLeft}</span>`; } const quizHtml = questions.map((q, index) => { const optionsHTML = q.options.map((opt, optIndex) => `<div><input type="radio" name="q${index}" value="${opt.value}" id="q${index}_opt${optIndex}" class="hidden"><label for="q${index}_opt${optIndex}" class="option-label">${opt.display}</label></div>`).join(''); return `<div class="p-4 border-2 border-gray-200 rounded-lg"><p class="font-bold">${index + 1}. <span class="text-yellow-500">${q.level}</span> ${q.text}</p><div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mt-3">${optionsHTML}</div><div id="feedback-container-${index}" class="mt-2"></div></div>`; }).join(''); quizForm.innerHTML = quizHtml + `<button type="submit" id="submit-quiz-btn" class="w-full text-white bg-green-600 hover:bg-green-700 font-medium rounded-lg text-lg px-5 py-3 mt-8">ุชุญูู ูู ุฅุฌุงุจุงุชู</button>`; if (attemptsLeft <= 0) { const submitBtn = quizForm.querySelector('#submit-quiz-btn'); submitBtn.disabled = true; submitBtn.textContent = 'ูุง ุชูุฌุฏ ูุญุงููุงุช ูุชุจููุฉ'; submitBtn.classList.add('bg-gray-400', 'hover:bg-gray-400'); } quizForm.onsubmit = (e) => { e.preventDefault(); let score = 0; questions.forEach((q, index) => { const userAnswer = e.target.elements[`q${index}`]?.value; const feedbackContainer = document.getElementById(`feedback-container-${index}`); feedbackContainer.innerHTML = ''; feedbackContainer.className = 'mt-2 flex flex-col items-start gap-1'; const feedbackEl = document.createElement('div'); if (userAnswer === q.correct) { score++; feedbackEl.textContent = 'โ ุฅุฌุงุจุฉ ุตุญูุญุฉ!'; feedbackEl.className = 'text-sm font-bold text-green-600'; } else { feedbackEl.textContent = `โ ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ.`; feedbackEl.className = 'text-sm font-bold text-red-600'; } feedbackContainer.appendChild(feedbackEl); const explanationContainer = document.createElement('div'); explanationContainer.className = 'flex items-center gap-4'; const detailedBtn = document.createElement('button'); detailedBtn.type = 'button'; detailedBtn.textContent = 'ุงุนุฑู ููุงุฐุงุ'; detailedBtn.className = 'text-xs text-blue-600 hover:underline'; detailedBtn.onclick = () => showExplanation(index, 'detailed'); if (q.smartExplanation) { const smartBtn = document.createElement('button'); smartBtn.type = 'button'; smartBtn.innerHTML = '๐ง ุงูุญู ุงูุฐูู'; smartBtn.className = 'text-xs text-purple-600 hover:underline font-bold'; smartBtn.onclick = () => showExplanation(index, 'smart'); explanationContainer.appendChild(smartBtn); } explanationContainer.appendChild(detailedBtn); feedbackContainer.appendChild(explanationContainer); }); const finalGrade = Math.round((score / questions.length) * 10); const resultsDiv = document.getElementById('quiz-results'); resultsDiv.classList.remove('hidden'); document.getElementById('quiz-score').textContent = `${finalGrade} / 10`; if (studentData) { saveGrade(lessonId, finalGrade, studentData.id); if (attemptsLeft - 1 > 0) { document.getElementById('retake-quiz-btn').classList.remove('hidden'); } } else { document.getElementById('save-status').textContent = 'ุชู ุนุฑุถ ูุชูุฌุชู. ุณุฌู ุงูุฏุฎูู ูุญูุธ ุชูุฏูู.'; } e.target.querySelector('#submit-quiz-btn').disabled = true; }; }
    function saveGrade(lessonId, grade, studentId) { if (!studentId) return; const saveStatus = document.getElementById('save-status'); saveStatus.textContent = 'ุฌุงุฑู ุญูุธ ูุชูุฌุชู...'; const url = `${SCRIPT_URL}?action=saveGrade&studentId=${studentId}&lessonId=${lessonId}&grade=${grade}`; fetch(url) .then(res => res.json()) .then(result => { if (result.status === 'success') { saveStatus.textContent = 'โ ุชู ุญูุธ ูุชูุฌุชู ุจูุฌุงุญ! ุณุชุธูุฑ ูู ููุญุฉ ุงูุชุญูู ุนูุฏ ุงูุนูุฏุฉ.'; const studentData = JSON.parse(localStorage.getItem('currentStudent')); if (!studentData.lessons) studentData.lessons = {}; if (!studentData.lessons[lessonId] || studentData.lessons[lessonId].grade < grade) { studentData.lessons[lessonId] = { grade: grade, attempts: (studentData.lessons[lessonId]?.attempts || 0) + 1 }; } else { studentData.lessons[lessonId].attempts++; } localStorage.setItem('currentStudent', JSON.stringify(studentData)); } else { throw new Error(result.message); } }) .catch(error => { saveStatus.textContent = 'โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุงูุฏุฑุฌุฉ.'; console.error("Save Grade Error:", error); }); }
    function showExplanation(questionIndex, type) { const modal = document.getElementById('explanationModal'); const explanationText = document.getElementById('explanationText'); if(modal && explanationText && currentQuestions[questionIndex]) { const explanationContent = (type === 'smart' && currentQuestions[questionIndex].smartExplanation) ? currentQuestions[questionIndex].smartExplanation : currentQuestions[questionIndex].explanation; explanationText.innerHTML = explanationContent; modal.classList.remove('hidden'); } }
    function closeModal() { const modal = document.getElementById('explanationModal'); if(modal) modal.classList.add('hidden'); }
    
    // ===================================================================
    // โ๏ธ ูุญุชูู ุงูุฏุฑุณ ุงููุญุฏุฏ (ููุง ุชุจุฏุฃ ุงูุชุนุฏููุงุช)
    // ===================================================================
    const LESSON_ID = 'c3_l2'; 
    
    function generateQuiz() {
        const questionBank = [
                { 
                    type: 'mcq',
                    level: 'โญ',
                    text: 'ูุง ูุนุงุฏูุฉ ุงููุณุชููู ุงูุฐู ูููู <span class="text-red-600 font-bold">ูฃ</span> ูููุฑ ุจุงูููุทุฉ (<span class="text-red-600 font-bold">ูข</span>ุ <span class="text-blue-600 font-bold">ูก</span>)ุ',
                    options: [ 
                        { display: 'ุต = ูฃุณ - ูฅ', value: 'A' }, 
                        { display: 'ุต = ูฃุณ + ูก', value: 'B' }, 
                        { display: 'ุต = ูขุณ + ูฃ', value: 'C' }, 
                        { display: 'ุต = ุณ + ูฃ', value: 'D' }
                    ], 
                    correct: 'A',
                    explanation: `<p><b>ุงูุทุฑููุฉ ุงูุชูุตูููุฉ:</b></p>
                                 <p><b>ุงูุฎุทูุฉ 1: ุงูุชุนููุถ ุจุงูููู ูุงูููุทุฉ</b></p>
                                 <p>ูุนูุถ ุงูููู <span class="math-eq">ู=ูฃ</span> ูุงูููุทุฉ (<span class="text-red-600">ูข</span>ุ <span class="text-blue-600">ูก</span>) ูู ุงููุนุงุฏูุฉ.</p>
                                 <p class="text-center"><span class="math-eq"><span class="text-blue-600">ูก</span> = ูฃ(<span class="text-red-600">ูข</span>) + ุจ</span></p>
                                 <p><b>ุงูุฎุทูุฉ 2: ุฅูุฌุงุฏ ุงูููุทุน (ุจ)</b></p>
                                 <p><span class="math-eq">ูก = ูฆ + ุจ</span></p>
                                 <p>ุจุทุฑุญ ูฆ ูู ุงูุทุฑูููุ ูุฌุฏ ุฃู <span class="math-eq">ุจ = -ูฅ</span>.</p>
                                 <p><b>ุงูุฎุทูุฉ 3: ูุชุงุจุฉ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ</b></p>
                                 <p>ุงูุขู ูุนูุถ ุงูููู <span class="math-eq">ู=ูฃ</span> ูุงูููุทุน <span class="math-eq">ุจ=-ูฅ</span>.</p>
                                 <p class="text-center p-2 bg-green-100 rounded-md"><span class="math-eq">ุต = ูฃุณ - ูฅ</span></p>`,
                    smartExplanation: `<p><b>๐ง ุทุฑููุฉ ุณุฑูุนุฉ (ุญู ุฐูู):</b></p>
                                     <p><b>1. ุงุณุชุจุนุงุฏ ุงูุฎูุงุฑุงุช:</b> ุงูููู ุงููุนุทู ูู <span class="math-eq">ูฃ</span>. ูุฐุง ูุนูู ุฃู ุงูุฅุฌุงุจุฉ ูุฌุจ ุฃู ุชููู ุฅูุง ุงูุฎูุงุฑ ุงูุฃูู ุฃู ุงูุซุงูู. ูุณุชุจุนุฏ ุงูุฎูุงุฑุงุช ุงูุฃุฎุฑู.</p>
                                     <p><b>2. ุงูุชุญูู ุจุงูุชุนููุถ:</b> ูุฌุฑุจ ุงูููุทุฉ (<span class="text-red-600">ูข</span>ุ <span class="text-blue-600">ูก</span>) ูู ุงูุฎูุงุฑ ุงูุฃูู: <span class="math-eq">ุต = ูฃุณ - ูฅ</span>.</p>
                                     <p class="text-center"><span class="math-eq"><span class="text-blue-600">ูก</span> = ูฃ(<span class="text-red-600">ูข</span>) - ูฅ</span></p>
                                     <p class="text-center"><span class="math-eq">ูก = ูฆ - ูฅ</span></p>
                                     <p class="text-center"><span class="math-eq">ูก = ูก</span> (ุตุญูุญุฉ)</p>
                                     <p>ุจูุง ุฃู ุงูููุทุฉ ุชุญูู ุงููุนุงุฏูุฉุ ููุฐู ูู ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ.</p>`
                },
                { 
                    type: 'mcq', 
                    level: 'โญโญ', 
                    text: 'ูุง ูุนุงุฏูุฉ ุงููุณุชููู ุงููุงุฑ ุจุงูููุทุชูู (<span class="text-red-600 font-bold">ูก</span>ุ <span class="text-blue-600 font-bold">ูฆ</span>) ู (<span class="text-red-600 font-bold">ูฃ</span>ุ <span class="text-blue-600 font-bold">ูกู</span>)ุ', 
                    options: [ 
                        { display: 'ุต = ุณ + ูฅ', value: 'A' }, 
                        { display: 'ุต = ูขุณ + ูค', value: 'B' }, 
                        { display: 'ุต = -ูขุณ + ูจ', value: 'C' }, 
                        { display: 'ุต = ูคุณ + ูข', value: 'D' }
                    ], 
                    correct: 'B', 
                    explanation: `<p><b>ุงูุฎุทูุฉ 1: ุฅูุฌุงุฏ ุงูููู (ู)</b></p>
                                  <p>ูุณุชุฎุฏู ุงูููุทุชูู (<span class="text-red-600">ูก</span>ุ <span class="text-blue-600">ูฆ</span>) ู (<span class="text-red-600">ูฃ</span>ุ <span class="text-blue-600">ูกู</span>).</p>
                                  <p class="text-center"><span class="math-eq">ู = <span class="fraction"><span>ูกู - ูฆ</span><span>ูฃ - ูก</span></span> = <span class="fraction"><span>ูค</span><span>ูข</span></span> = ูข</span></p>
                                  <p><b>ุงูุฎุทูุฉ 2: ุฅูุฌุงุฏ ุงูููุทุน (ุจ)</b></p>
                                  <p>ูุณุชุฎุฏู ุงูููู <span class="math-eq">ู=ูข</span> ูุฅุญุฏู ุงูููุงุทุ ูุซูุงู (<span class="text-red-600">ูก</span>ุ <span class="text-blue-600">ูฆ</span>)ุ ููุนูุถ ูู <span class="math-eq">ุต = ู ุณ + ุจ</span>.</p>
                                  <p><span class="math-eq"><span class="text-blue-600">ูฆ</span> = ูข(<span class="text-red-600">ูก</span>) + ุจ</span></p>
                                  <p><span class="math-eq">ูฆ = ูข + ุจ</span> &larr; <span class="math-eq">ุจ = ูค</span></p>
                                  <p><b>ุงูุฎุทูุฉ 3: ูุชุงุจุฉ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ</b></p>
                                  <p class="text-center p-2 bg-green-100 rounded-md"><span class="math-eq">ุต = ูขุณ + ูค</span></p>`,
                    smartExplanation: `<p><b>๐ง ุทุฑููุฉ ุณุฑูุนุฉ (ุญู ุฐูู):</b></p>
                                     <p><b>1. ุญุณุงุจ ุงูููู ุฐูููุงู:</b> ูุฑู ุงูุตุงุฏุงุช ูู <span class="math-eq">ูกู - ูฆ = ูค</span>. ูุฑู ุงูุณููุงุช ูู <span class="math-eq">ูฃ - ูก = ูข</span>.</p>
                                     <p>ุฅุฐู ุงูููู <span class="math-eq">ู = <span class="fraction"><span>ูค</span><span>ูข</span></span> = ูข</span>.</p>
                                     <p><b>2. ุงูุจุญุซ ูู ุงูุฎูุงุฑุงุช:</b> ูุจุญุซ ุนู ุงูุฎูุงุฑ ุงูุฐู ูุญุชูู ุนูู ููู ูุณุงูู <span class="math-eq">ูข</span>.</p>
                                     <p>ุงูุฎูุงุฑ ุงููุญูุฏ ุงูุฐู ูุญูู ูุฐุง ุงูุดุฑุท ูู <span class="math-eq">ุต = ูขุณ + ูค</span>ุ ูุฐูู ูู ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ุฏูู ุงูุญุงุฌุฉ ูุญุณุงุจ ุงูููุทุน (ุจ).</p>`
                },
                { 
                    type: 'mcq', 
                    level: 'โญโญโญ', 
                    text: 'ุฅุฐุง ูุงูุช ุชูููุฉ ุงุณุชุฆุฌุงุฑ ุณูุงุฑุฉ ูููู ูุงุญุฏ ูู <span class="text-blue-600 font-bold">ูฉู ุฑูุงูุงู</span>ุ ุจุงูุฅุถุงูุฉ ุฅูู <span class="text-red-600 font-bold">ุฑูุงููู</span> ููู ูููููุชุฑ ููุทูุน. ูุง ุงููุนุงุฏูุฉ ุงูุชู ุชูุซู ุงูุชูููุฉ (ุต) ููุทุน (ุณ) ูููููุชุฑุ', 
                    options: [ 
                        { display: 'ุต = ูฉูุณ + ูข', value: 'A' }, 
                        { display: 'ุต = ูขุณ + ูฉู', value: 'B' }, 
                        { display: 'ุต = ูฉูขุณ', value: 'C' }, 
                        { display: 'ุต = ูขุณ - ูฉู', value: 'D' }
                    ], 
                    correct: 'B', 
                    explanation: `<p><b>ุงูุฎุทูุฉ 1: ุชุญุฏูุฏ ุงูููุทุน ุงูุตุงุฏู (ุจ)</b></p>
                                  <p>ุงูููุทุน (ุจ) ูู ุงูุชูููุฉ ุงูุฃูููุฉ ุฃู ุงูุซุงุจุชุฉุ ููู ููุง ูฉู ุฑูุงูุงู. ุฅุฐู <span class="math-eq">ุจ = ูฉู</span>.</p>
                                  <p><b>ุงูุฎุทูุฉ 2: ุชุญุฏูุฏ ุงูููู (ู)</b></p>
                                  <p>ุงูููู (ู) ูู ูุนุฏู ุงูุชุบูุฑุ ููู ููุง ุฑูุงูุงู ููู ูููููุชุฑ. ุฅุฐู <span class="math-eq">ู = ูข</span>.</p>
                                  <p><b>ุงูุฎุทูุฉ 3: ูุชุงุจุฉ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ</b></p>
                                  <p>ูุนูุถ (ู) ู (ุจ) ูู ุตูุบุฉ <span class="math-eq">ุต = ู ุณ + ุจ</span>.</p>
                                  <p class="text-center p-2 bg-green-100 rounded-md"><span class="math-eq">ุต = ูขุณ + ูฉู</span></p>`
                },
                {
                    type: 'mcq',
                    level: 'โญ',
                    text: 'ูุง ูุนุงุฏูุฉ ุงููุณุชููู ุงูุฐู ูููู <span class="text-red-600 font-bold">-ูก</span> ูููุฑ ุจุงูููุทุฉ (<span class="text-red-600 font-bold">ูฅ</span>ุ <span class="text-blue-600 font-bold">-ูข</span>)ุ',
                    options: [
                        { display: 'ุต = -ุณ + ูฃ', value: 'A' },
                        { display: 'ุต = -ุณ - ูง', value: 'B' },
                        { display: 'ุต = ุณ - ูง', value: 'C' },
                        { display: 'ุต = ูฅุณ - ูข', value: 'D' }
                    ],
                    correct: 'A',
                    explanation: `<p><b>ุงูุฎุทูุฉ 1: ุงูุชุนููุถ ุจุงูููู ูุงูููุทุฉ</b></p><p>ูุนูุถ ุงูููู <span class="math-eq">ู=-ูก</span> ูุงูููุทุฉ (<span class="text-red-600">ูฅ</span>ุ <span class="text-blue-600">-ูข</span>) ูู ุงููุนุงุฏูุฉ <span class="math-eq">ุต = ู ุณ + ุจ</span>.</p><p class="text-center"><span class="math-eq"><span class="text-blue-600">-ูข</span> = -ูก(<span class="text-red-600">ูฅ</span>) + ุจ</span></p><p><b>ุงูุฎุทูุฉ 2: ุฅูุฌุงุฏ ุงูููุทุน (ุจ)</b></p><p><span class="math-eq">-ูข = -ูฅ + ุจ</span></p><p>ุจุฅุถุงูุฉ ูฅ ููุทุฑูููุ ูุฌุฏ ุฃู <span class="math-eq">ุจ = ูฃ</span>.</p><p><b>ุงูุฎุทูุฉ 3: ูุชุงุจุฉ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ</b></p><p class="text-center p-2 bg-green-100 rounded-md"><span class="math-eq">ุต = -ุณ + ูฃ</span></p>`,
                    smartExplanation: `<p><b>๐ง ุทุฑููุฉ ุณุฑูุนุฉ (ุญู ุฐูู):</b></p>
                                     <p><b>1. ุงุณุชุจุนุงุฏ ุงูุฎูุงุฑุงุช:</b> ุงูููู ุงููุนุทู ูู <span class="math-eq">-ูก</span>. ูุฐุง ูุญุตุฑ ุงูุฅุฌุงุจุฉ ุจูู ุงูุฎูุงุฑูู ุงูุฃูู ูุงูุซุงูู.</p>
                                     <p><b>2. ุงูุชุญูู ุจุงูุชุนููุถ:</b> ูุฌุฑุจ ุงูููุทุฉ (<span class="text-red-600">ูฅ</span>ุ <span class="text-blue-600">-ูข</span>) ูู ุงูุฎูุงุฑ ุงูุฃูู: <span class="math-eq">ุต = -ุณ + ูฃ</span>.</p>
                                     <p class="text-center"><span class="math-eq"><span class="text-blue-600">-ูข</span> = -(<span class="text-red-600">ูฅ</span>) + ูฃ</span></p>
                                     <p class="text-center"><span class="math-eq">-ูข = -ูฅ + ูฃ</span></p>
                                     <p class="text-center"><span class="math-eq">-ูข = -ูข</span> (ุตุญูุญุฉ)</p>
                                     <p>ุจูุง ุฃู ุงูููุทุฉ ุชุญูู ุงููุนุงุฏูุฉุ ููุฐู ูู ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ.</p>`
                },
                {
                    type: 'mcq',
                    level: 'โญ',
                    text: 'ูุง ูุนุงุฏูุฉ ุงููุณุชููู ุงูุฐู ูููู <span class="fraction"><span>ูก</span><span>ูข</span></span> ูููุฑ ุจุงูููุทุฉ (<span class="text-red-600 font-bold">ูค</span>ุ <span class="text-blue-600 font-bold">ูก</span>)ุ',
                    options: [
                        { display: 'ุต = ูขุณ - ูง', value: 'A' },
                        { display: 'ุต = <span class="fraction"><span>ูก</span><span>ูข</span></span>ุณ + ูก', value: 'B' },
                        { display: 'ุต = <span class="fraction"><span>ูก</span><span>ูข</span></span>ุณ - ูก', value: 'C' },
                        { display: 'ุต = ูคุณ + ูก', value: 'D' }
                    ],
                    correct: 'C',
                    explanation: `<p><b>ุงูุฎุทูุฉ 1: ุงูุชุนููุถ ุจุงูููู ูุงูููุทุฉ</b></p><p>ูุนูุถ ุงูููู <span class="math-eq">ู = <span class="fraction"><span>ูก</span><span>ูข</span></span></span> ูุงูููุทุฉ (<span class="text-red-600">ูค</span>ุ <span class="text-blue-600">ูก</span>) ูู ุงููุนุงุฏูุฉ <span class="math-eq">ุต = ู ุณ + ุจ</span>.</p><p class="text-center"><span class="math-eq"><span class="text-blue-600">ูก</span> = <span class="fraction"><span>ูก</span><span>ูข</span></span>(<span class="text-red-600">ูค</span>) + ุจ</span></p><p><b>ุงูุฎุทูุฉ 2: ุฅูุฌุงุฏ ุงูููุทุน (ุจ)</b></p><p><span class="math-eq">ูก = ูข + ุจ</span></p><p>ุจุทุฑุญ ูข ูู ุงูุทุฑูููุ ูุฌุฏ ุฃู <span class="math-eq">ุจ = -ูก</span>.</p><p><b>ุงูุฎุทูุฉ 3: ูุชุงุจุฉ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ</b></p><p class="text-center p-2 bg-green-100 rounded-md"><span class="math-eq">ุต = <span class="fraction"><span>ูก</span><span>ูข</span></span>ุณ - ูก</span></p>`,
                    smartExplanation: `<p><b>๐ง ุทุฑููุฉ ุณุฑูุนุฉ (ุญู ุฐูู):</b></p>
                                     <p><b>1. ุงุณุชุจุนุงุฏ ุงูุฎูุงุฑุงุช:</b> ุงูููู ุงููุนุทู ูู <span class="math-eq"><span class="fraction"><span>ูก</span><span>ูข</span></span></span>. ูุฐุง ูุญุตุฑ ุงูุฅุฌุงุจุฉ ุจูู ุงูุฎูุงุฑูู ุงูุซุงูู ูุงูุซุงูุซ.</p>
                                     <p><b>2. ุงูุชุญูู ุจุงูุชุนููุถ:</b> ูุฌุฑุจ ุงูููุทุฉ (<span class="text-red-600">ูค</span>ุ <span class="text-blue-600">ูก</span>) ูู ุงูุฎูุงุฑ ุงูุซุงูุซ: <span class="math-eq">ุต = <span class="fraction"><span>ูก</span><span>ูข</span></span>ุณ - ูก</span>.</p>
                                     <p class="text-center"><span class="math-eq"><span class="text-blue-600">ูก</span> = <span class="fraction"><span>ูก</span><span>ูข</span></span>(<span class="text-red-600">ูค</span>) - ูก</span></p>
                                     <p class="text-center"><span class="math-eq">ูก = ูข - ูก</span></p>
                                     <p class="text-center"><span class="math-eq">ูก = ูก</span> (ุตุญูุญุฉ)</p>
                                     <p>ุจูุง ุฃู ุงูููุทุฉ ุชุญูู ุงููุนุงุฏูุฉุ ููุฐู ูู ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ.</p>`
                },
                {
                    type: 'mcq',
                    level: 'โญโญ',
                    text: 'ูุง ูุนุงุฏูุฉ ุงููุณุชููู ุงููุงุฑ ุจููุทุฉ ุงูุฃุตู (<span class="text-red-600 font-bold">ู</span>ุ <span class="text-blue-600 font-bold">ู</span>) ูุงูููุทุฉ (<span class="text-red-600 font-bold">ูข</span>ุ <span class="text-blue-600 font-bold">ูฆ</span>)ุ',
                    options: [
                        { display: 'ุต = ูฆุณ + ูข', value: 'A' },
                        { display: 'ุต = ูฃุณ', value: 'B' },
                        { display: 'ุต = ูขุณ + ูฆ', value: 'C' },
                        { display: 'ุต = -ูฃุณ', value: 'D' }
                    ],
                    correct: 'B',
                    explanation: `<p><b>ุงูุฎุทูุฉ 1: ุฅูุฌุงุฏ ุงูููู (ู)</b></p><p>ูุณุชุฎุฏู ุงูููุทุชูู (<span class="text-red-600">ู</span>ุ <span class="text-blue-600">ู</span>) ู (<span class="text-red-600">ูข</span>ุ <span class="text-blue-600">ูฆ</span>).</p><p class="text-center"><span class="math-eq">ู = <span class="fraction"><span>ูฆ - ู</span><span>ูข - ู</span></span> = <span class="fraction"><span>ูฆ</span><span>ูข</span></span> = ูฃ</span></p><p><b>ุงูุฎุทูุฉ 2: ุฅูุฌุงุฏ ุงูููุทุน (ุจ)</b></p><p>ุจูุง ุฃู ุงููุณุชููู ููุฑ ุจููุทุฉ ุงูุฃุตูุ ูุฅู ุงูููุทุน ุงูุตุงุฏู <span class="math-eq">ุจ = ู</span>.</p><p><b>ุงูุฎุทูุฉ 3: ูุชุงุจุฉ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ</b></p><p class="text-center p-2 bg-green-100 rounded-md"><span class="math-eq">ุต = ูฃุณ</span></p>`,
                    smartExplanation: `<p><b>๐ง ุทุฑููุฉ ุณุฑูุนุฉ (ุญู ุฐูู):</b></p>
                                     <p><b>1. ุงุณุชุจุนุงุฏ ุงูุฎูุงุฑุงุช:</b> ุจูุง ุฃู ุงููุณุชููู ููุฑ ุจููุทุฉ ุงูุฃุตู (<span class="math-eq">ูุ ู</span>)ุ ูุฌุจ ุฃู ูููู ุงูููุทุน ุงูุตุงุฏู (ุจ) ูุณุงูู ุตูุฑุงู. ูุฐุง ูุณุชุจุนุฏ ุงูุฎูุงุฑุงุช ุงูุชู ุชุญุชูู ุนูู <span class="math-eq">+ ุจ</span>.</p>
                                     <p>ุงูุฎูุงุฑุงุช ุงููุชุจููุฉ ูู <span class="math-eq">ุต = ูฃุณ</span> ู <span class="math-eq">ุต = -ูฃุณ</span>.</p>
                                     <p><b>2. ุงูุชุญูู ุจุงูุชุนููุถ:</b> ูุฌุฑุจ ุงูููุทุฉ ุงูุซุงููุฉ (<span class="text-red-600">ูข</span>ุ <span class="text-blue-600">ูฆ</span>) ูู ุงูุฎูุงุฑ <span class="math-eq">ุต = ูฃุณ</span>.</p>
                                     <p class="text-center"><span class="math-eq"><span class="text-blue-600">ูฆ</span> = ูฃ(<span class="text-red-600">ูข</span>)</span></p>
                                     <p class="text-center"><span class="math-eq">ูฆ = ูฆ</span> (ุตุญูุญุฉ)</p>
                                     <p>ุฅุฐู ูุฐู ูู ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ.</p>`
                },
                {
                    type: 'mcq',
                    level: 'โญโญ',
                    text: 'ูุง ูุนุงุฏูุฉ ุงููุณุชููู ุงููุงุฑ ุจุงูููุทุชูู (<span class="text-red-600 font-bold">-ูข</span>ุ <span class="text-blue-600 font-bold">ูค</span>) ู (<span class="text-red-600 font-bold">ูก</span>ุ <span class="text-blue-600 font-bold">-ูข</span>)ุ',
                    options: [
                        { display: 'ุต = ูขุณ + ูจ', value: 'A' },
                        { display: 'ุต = -ูขุณ - ูจ', value: 'B' },
                        { display: 'ุต = -ูขุณ', value: 'C' },
                        { display: 'ุต = -<span class="fraction"><span>ูก</span><span>ูข</span></span>ุณ + ูฃ', value: 'D' }
                    ],
                    correct: 'C',
                    explanation: `<p><b>ุงูุฎุทูุฉ 1: ุฅูุฌุงุฏ ุงูููู (ู)</b></p><p>ูุณุชุฎุฏู ุงูููุทุชูู (<span class="text-red-600">-ูข</span>ุ <span class="text-blue-600">ูค</span>) ู (<span class="text-red-600">ูก</span>ุ <span class="text-blue-600">-ูข</span>).</p><p class="text-center"><span class="math-eq">ู = <span class="fraction"><span>-ูข - ูค</span><span>ูก - (-ูข)</span></span> = <span class="fraction"><span>-ูฆ</span><span>ูฃ</span></span> = -ูข</span></p><p><b>ุงูุฎุทูุฉ 2: ุฅูุฌุงุฏ ุงูููุทุน (ุจ)</b></p><p>ูุณุชุฎุฏู ุงูููู <span class="math-eq">ู=-ูข</span> ูุงูููุทุฉ (<span class="text-red-600">ูก</span>ุ <span class="text-blue-600">-ูข</span>).</p><p class="text-center"><span class="math-eq"><span class="text-blue-600">-ูข</span> = -ูข(<span class="text-red-600">ูก</span>) + ุจ</span></p><p><span class="math-eq">-ูข = -ูข + ุจ</span> &larr; <span class="math-eq">ุจ = ู</span></p><p><b>ุงูุฎุทูุฉ 3: ูุชุงุจุฉ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ</b></p><p class="text-center p-2 bg-green-100 rounded-md"><span class="math-eq">ุต = -ูขุณ</span></p>`,
                    smartExplanation: `<p><b>๐ง ุทุฑููุฉ ุณุฑูุนุฉ (ุญู ุฐูู):</b></p>
                                     <p><b>1. ุญุณุงุจ ุงูููู ุฐูููุงู:</b> ูุฑู ุงูุตุงุฏุงุช ูู <span class="math-eq">-ูข - ูค = -ูฆ</span>. ูุฑู ุงูุณููุงุช ูู <span class="math-eq">ูก - (-ูข) = ูฃ</span>.</p>
                                     <p>ุฅุฐู ุงูููู <span class="math-eq">ู = <span class="fraction"><span>-ูฆ</span><span>ูฃ</span></span> = -ูข</span>.</p>
                                     <p><b>2. ุงูุจุญุซ ูู ุงูุฎูุงุฑุงุช:</b> ูุจุญุซ ุนู ุงูุฎูุงุฑ ุงูุฐู ูููู <span class="math-eq">-ูข</span>. ุงูุฎูุงุฑุงุช (B) ู (C) ุชุญูู ุฐูู.</p>
                                     <p><b>3. ุงูุชุญูู ุจุงูุชุนููุถ:</b> ูุฌุฑุจ ุงูููุทุฉ (<span class="text-red-600">ูก</span>ุ <span class="text-blue-600">-ูข</span>) ูู ุงูุฎูุงุฑ (C): <span class="math-eq">ุต = -ูขุณ</span>.</p>
                                     <p class="text-center"><span class="math-eq"><span class="text-blue-600">-ูข</span> = -ูข(<span class="text-red-600">ูก</span>)</span></p>
                                     <p class="text-center"><span class="math-eq">-ูข = -ูข</span> (ุตุญูุญุฉ)</p>
                                     <p>ุฅุฐู ุงูุฎูุงุฑ (C) ูู ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ.</p>`
                },
                {
                    type: 'mcq',
                    level: 'โญโญ',
                    text: 'ูุง ูุนุงุฏูุฉ ุงููุณุชููู ุงููุงุฑ ุจุงูููุทุชูู (<span class="text-red-600 font-bold">-ูค</span>ุ <span class="text-blue-600 font-bold">ูข</span>) ู (<span class="text-red-600 font-bold">ูก</span>ุ <span class="text-blue-600 font-bold">ูง</span>)ุ',
                    options: [
                        { display: 'ุต = ุณ + ูฆ', value: 'A' },
                        { display: 'ุต = ุณ - ูฆ', value: 'B' },
                        { display: 'ุต = -ุณ + ูข', value: 'C' },
                        { display: 'ุต = ูฅุณ + ูขูข', value: 'D' }
                    ],
                    correct: 'A',
                    explanation: `<p><b>ุงูุฎุทูุฉ 1: ุฅูุฌุงุฏ ุงูููู (ู)</b></p><p>ูุณุชุฎุฏู ุงูููุทุชูู (<span class="text-red-600">-ูค</span>ุ <span class="text-blue-600">ูข</span>) ู (<span class="text-red-600">ูก</span>ุ <span class="text-blue-600">ูง</span>).</p><p class="text-center"><span class="math-eq">ู = <span class="fraction"><span>ูง - ูข</span><span>ูก - (-ูค)</span></span> = <span class="fraction"><span>ูฅ</span><span>ูฅ</span></span> = ูก</span></p><p><b>ุงูุฎุทูุฉ 2: ุฅูุฌุงุฏ ุงูููุทุน (ุจ)</b></p><p>ูุณุชุฎุฏู ุงูููู <span class="math-eq">ู=ูก</span> ูุงูููุทุฉ (<span class="text-red-600">ูก</span>ุ <span class="text-blue-600">ูง</span>).</p><p class="text-center"><span class="math-eq"><span class="text-blue-600">ูง</span> = ูก(<span class="text-red-600">ูก</span>) + ุจ</span></p><p><span class="math-eq">ูง = ูก + ุจ</span> &larr; <span class="math-eq">ุจ = ูฆ</span></p><p><b>ุงูุฎุทูุฉ 3: ูุชุงุจุฉ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ</b></p><p class="text-center p-2 bg-green-100 rounded-md"><span class="math-eq">ุต = ุณ + ูฆ</span></p>`
                },
                {
                    type: 'mcq',
                    level: 'โญโญโญ',
                    text: 'ุจุงูุฉ ุฌูุงู ุชูููุชูุง ุงูุดูุฑูุฉ ุงูุซุงุจุชุฉ <span class="text-blue-600 font-bold">ูฅู ุฑูุงูุงู</span>ุ ุจุงูุฅุถุงูุฉ ุฅูู <span class="text-red-600 font-bold">ูุตู ุฑูุงู</span> ููู ุฏูููุฉ ุงุชุตุงู ุฅุถุงููุฉ. ูุง ุงููุนุงุฏูุฉ ุงูุชู ุชูุซู ุงูุชูููุฉ (ุต) ูู (ุณ) ุฏูููุฉ ุฅุถุงููุฉุ',
                    options: [
                        { display: 'ุต = ูฅูุณ + <span class="fraction"><span>ูก</span><span>ูข</span></span>', value: 'A' },
                        { display: 'ุต = <span class="fraction"><span>ูก</span><span>ูข</span></span>ุณ + ูฅู', value: 'B' },
                        { display: 'ุต = ูฅู<span class="fraction"><span>ูก</span><span>ูข</span></span>ุณ', value: 'C' },
                        { display: 'ุต = ูฅูุณ', value: 'D' }
                    ],
                    correct: 'B',
                    explanation: `<p><b>ุงูุฎุทูุฉ 1: ุชุญุฏูุฏ ุงูููุทุน ุงูุตุงุฏู (ุจ)</b></p><p>ุงูููุทุน (ุจ) ูู ุงูุชูููุฉ ุงูุซุงุจุชุฉุ ููู ููุง ูฅู ุฑูุงูุงู. ุฅุฐู <span class="math-eq">ุจ = ูฅู</span>.</p><p><b>ุงูุฎุทูุฉ 2: ุชุญุฏูุฏ ุงูููู (ู)</b></p><p>ุงูููู (ู) ูู ุชูููุฉ ุงูุฏูููุฉ ุงูุฅุถุงููุฉุ ููู ููุง ูุตู ุฑูุงู. ุฅุฐู <span class="math-eq">ู = <span class="fraction"><span>ูก</span><span>ูข</span></span></span>.</p><p><b>ุงูุฎุทูุฉ 3: ูุชุงุจุฉ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ</b></p><p class="text-center p-2 bg-green-100 rounded-md"><span class="math-eq">ุต = <span class="fraction"><span>ูก</span><span>ูข</span></span>ุณ + ูฅู</span></p>`
                },
                {
                    type: 'mcq',
                    level: 'โญโญโญ',
                    text: 'ุทูู ูุจุชุฉ <span class="text-blue-600 font-bold">ูกู ุณู</span>ุ ูุชููู ุจูุนุฏู <span class="text-red-600 font-bold">ูข ุณู</span> ูู ุฃุณุจูุน. ูุง ุงููุนุงุฏูุฉ ุงูุชู ุชูุซู ุทูููุง (ุต) ุจุนุฏ (ุณ) ุฃุณุจูุนุ',
                    options: [
                        { display: 'ุต = ูกูุณ + ูข', value: 'A' },
                        { display: 'ุต = ูกูขุณ', value: 'B' },
                        { display: 'ุต = ูขุณ + ูกู', value: 'C' },
                        { display: 'ุต = ูขุณ - ูกู', value: 'D' }
                    ],
                    correct: 'C',
                    explanation: `<p><b>ุงูุฎุทูุฉ 1: ุชุญุฏูุฏ ุงูููุทุน ุงูุตุงุฏู (ุจ)</b></p><p>ุงูููุทุน (ุจ) ูู ุงูุทูู ุงูุงุจุชุฏุงุฆู ูููุจุชุฉุ ููู ููุง ูกู ุณู. ุฅุฐู <span class="math-eq">ุจ = ูกู</span>.</p><p><b>ุงูุฎุทูุฉ 2: ุชุญุฏูุฏ ุงูููู (ู)</b></p><p>ุงูููู (ู) ูู ูุนุฏู ุงููููุ ููู ููุง ูข ุณู ููู ุฃุณุจูุน. ุฅุฐู <span class="math-eq">ู = ูข</span>.</p><p><b>ุงูุฎุทูุฉ 3: ูุชุงุจุฉ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ</b></p><p class="text-center p-2 bg-green-100 rounded-md"><span class="math-eq">ุต = ูขุณ + ูกู</span></p>`
                },
                 {
                    type: 'mcq',
                    level: 'โญโญโญ',
                    text: 'ุจุนุฏ <span class="text-red-600 font-bold">ุณุงุนุฉ</span> ูู ุจุฏุก ุฑุญูุฉุ ูุทุนุช ุณูุงุฑุฉ ูุณุงูุฉ <span class="text-blue-600 font-bold">ูจู ูู</span>. ูุจุนุฏ <span class="text-red-600 font-bold">ูฃ ุณุงุนุงุช</span>ุ ูุทุนุช <span class="text-blue-600 font-bold">ูขูคู ูู</span>. ุงูุชุฑุถ ุฃู ุงูุณุฑุนุฉ ุซุงุจุชุฉุ ูุง ุงููุนุงุฏูุฉ ุงูุชู ุชุฑุจุท ุงููุณุงูุฉ (ุต) ุจุงูุฒูู (ุณ)ุ',
                    options: [
                        { display: 'ุต = ูจูุณ', value: 'A' },
                        { display: 'ุต = ูกูฆูุณ - ูจู', value: 'B' },
                        { display: 'ุต = ูจูุณ + ูจู', value: 'C' },
                        { display: 'ุต = ูขูคูุณ', value: 'D' }
                    ],
                    correct: 'A',
                    explanation: `<p><b>ุงูุฎุทูุฉ 1: ุฅูุฌุงุฏ ุงูููู (ู)</b></p><p>ูุฏููุง ููุทุชุงู: (<span class="text-red-600">ูก</span>ุ <span class="text-blue-600">ูจู</span>) ู (<span class="text-red-600">ูฃ</span>ุ <span class="text-blue-600">ูขูคู</span>). ุงูููู ููุง ููุซู ุงูุณุฑุนุฉ.</p><p class="text-center"><span class="math-eq">ู = <span class="fraction"><span>ูขูคู - ูจู</span><span>ูฃ - ูก</span></span> = <span class="fraction"><span>ูกูฆู</span><span>ูข</span></span> = ูจู</span></p><p><b>ุงูุฎุทูุฉ 2: ุฅูุฌุงุฏ ุงูููุทุน (ุจ)</b></p><p>ูุณุชุฎุฏู ุงูููู <span class="math-eq">ู=ูจู</span> ูุงูููุทุฉ (<span class="text-red-600">ูก</span>ุ <span class="text-blue-600">ูจู</span>).</p><p class="text-center"><span class="math-eq"><span class="text-blue-600">ูจู</span> = ูจู(<span class="text-red-600">ูก</span>) + ุจ</span></p><p><span class="math-eq">ูจู = ูจู + ุจ</span> &larr; <span class="math-eq">ุจ = ู</span></p><p><b>ุงูุฎุทูุฉ 3: ูุชุงุจุฉ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ</b></p><p class="text-center p-2 bg-green-100 rounded-md"><span class="math-eq">ุต = ูจูุณ</span></p>`
                },
                {
                    type: 'mcq',
                    level: 'โญโญโญ',
                    text: 'ููุชุจุฉ ุนุงูุฉ ุชุญุชูู ุนูู <span class="text-blue-600 font-bold">ูขููู ูุชุงุจ</span>. ูุชุฎุทุท ุงูููุชุจุฉ ูุดุฑุงุก <span class="text-red-600 font-bold">ูกูฅู ูุชุงุจุงู</span> ุฌุฏูุฏุงู ูู ุนุงู. ูุง ุงููุนุงุฏูุฉ ุงูุชู ุชูุซู ุนุฏุฏ ุงููุชุจ (ุต) ุจุนุฏ (ุณ) ุณูุฉุ',
                    options: [
                        { display: 'ุต = ูขูููุณ + ูกูฅู', value: 'A' },
                        { display: 'ุต = ูกูฅูุณ - ูขููู', value: 'B' },
                        { display: 'ุต = ูขูกูฅูุณ', value: 'C' },
                        { display: 'ุต = ูกูฅูุณ + ูขููู', value: 'D' }
                    ],
                    correct: 'D',
                    explanation: `<p><b>ุงูุฎุทูุฉ 1: ุชุญุฏูุฏ ุงูููุทุน ุงูุตุงุฏู (ุจ)</b></p><p>ุงูููุทุน (ุจ) ูู ุงูุนุฏุฏ ุงูุงุจุชุฏุงุฆู ูููุชุจุ ููู ููุง ูขููู ูุชุงุจ. ุฅุฐู <span class="math-eq">ุจ = ูขููู</span>.</p><p><b>ุงูุฎุทูุฉ 2: ุชุญุฏูุฏ ุงูููู (ู)</b></p><p>ุงูููู (ู) ูู ูุนุฏู ุงูุฒูุงุฏุฉ ุงูุณูููุ ููู ููุง ูกูฅู ูุชุงุจุงู. ุฅุฐู <span class="math-eq">ู = ูกูฅู</span>.</p><p><b>ุงูุฎุทูุฉ 3: ูุชุงุจุฉ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ</b></p><p class="text-center p-2 bg-green-100 rounded-md"><span class="math-eq">ุต = ูกูฅูุณ + ูขููู</span></p>`
                }
            ];
        const shuffled = [...questionBank].sort(() => 0.5 - Math.random());
        const questionCount = Math.min(shuffled.length, 5);
        return shuffled.slice(0, questionCount);
    }

    // ===================================================================
    // โ๏ธ ูุดุบู ุงูููุฏ (ูุง ุชูู ุจุชุนุฏูู ูุฐุง ุงูุฌุฒุก)
    // ===================================================================
    document.addEventListener('DOMContentLoaded', () => {
        // --- START: Code from OLD lesson for interactive examples ---
        const configs = {
            "1a": {
                totalSteps: 3, 
                stepsContent: [
                    { text: "ูุจุฏุฃ ุจุตูุบุฉ ุงูููู ูุงูููุทุน: <span class='math-eq'>ุต = ู ุณ + ุจ</span>." },
                    { text: `<strong>1. ูุนูุถ ุจุงููุนุทูุงุช:</strong><br>ุงูููู <span class='math-eq'>ู = ูค</span>ุ ูุงูููุทุฉ (<span class="text-red-600">ูข</span>ุ <span class="text-blue-600">ูฅ</span>).<br><span class='math-eq'><span class="text-blue-600">ูฅ</span> = ูค(<span class="text-red-600">ูข</span>) + ุจ</span>` },
                    { text: "<strong>2. ูุญู ุงููุนุงุฏูุฉ ูุฅูุฌุงุฏ (ุจ):</strong><br><span class='math-eq'>ูฅ = ูจ + ุจ</span><br>ุจุทุฑุญ ูจ ูู ุงูุทุฑูููุ ูุฌุฏ ุฃู:<br><span class='math-eq'>ุจ = -ูฃ</span>" },
                    { text: `<strong>3. ููุชุจ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ:</strong><br>ุงูุขู ุจุนุฏ ุฃู ุนุฑููุง ุฃู <span class='math-eq'>ู = ูค</span> ู <span class='math-eq'>ุจ = -ูฃ</span>ุ ููุชุจ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ:<br><div class="text-center mt-2 p-2 bg-green-100 rounded-md"><span class='math-eq'>ุต = ูคุณ - ูฃ</span></div>` }
                ]
            },
            "1b": {
                totalSteps: 3,
                stepsContent: [
                    { text: "ูุจุฏุฃ ุจุตูุบุฉ ุงูููู ูุงูููุทุน: <span class='math-eq'>ุต = ู ุณ + ุจ</span>." },
                    { text: `<strong>1. ูุนูุถ ุจุงููุนุทูุงุช:</strong><br>ุงูููู <span class='math-eq'>ู = -ูข</span>ุ ูุงูููุทุฉ (<span class="text-red-600">-ูก</span>ุ <span class="text-blue-600">ูฆ</span>).<br><span class='math-eq'><span class="text-blue-600">ูฆ</span> = -ูข(<span class="text-red-600">-ูก</span>) + ุจ</span>` },
                    { text: "<strong>2. ูุญู ุงููุนุงุฏูุฉ ูุฅูุฌุงุฏ (ุจ):</strong><br><span class='math-eq'>ูฆ = ูข + ุจ</span><br>ุจุทุฑุญ ูข ูู ุงูุทุฑูููุ ูุฌุฏ ุฃู:<br><span class='math-eq'>ุจ = ูค</span>" },
                    { text: `<strong>3. ููุชุจ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ:</strong><br>ูุฌุฏูุง ุฃู <span class='math-eq'>ู = -ูข</span> ู <span class='math-eq'>ุจ = ูค</span>. ุฅุฐู ุงููุนุงุฏูุฉ ูู:<br><div class="text-center mt-2 p-2 bg-green-100 rounded-md"><span class='math-eq'>ุต = -ูขุณ + ูค</span></div>` }
                ]
            },
            "2a": {
                totalSteps: 3, 
                stepsContent: [
                    { text: "ูุฏููุง ููุทุชุงูุ ูุฐูู ุณูููู ุจุซูุงุซ ุฎุทูุงุช ุจุณูุทุฉ ูููุตูู ููุญู." },
                    { text: `<strong>ุงูุฎุทูุฉ 1: ูุฌุฏ ุงูููู (ู)</strong><br>ูุณุชุฎุฏู ุงูููุทุชูู (<span class="text-red-600">ูก</span>ุ <span class="text-blue-600">ูข</span>) ู (<span class="text-red-600">ูฃ</span>ุ <span class="text-blue-600">ูจ</span>).<br><span class='math-eq'>ู = <span class="fraction"><span>ูุฑู ุงูุตุงุฏุงุช</span><span>ูุฑู ุงูุณููุงุช</span></span> = <span class="fraction"><span><span class="text-blue-600">ูจ</span> - <span class="text-blue-600">ูข</span></span><span><span class="text-red-600">ูฃ</span> - <span class="text-red-600">ูก</span></span></span> = <span class="fraction"><span>ูฆ</span><span>ูข</span></span> = ูฃ</span>` },
                    { text: `<strong>ุงูุฎุทูุฉ 2: ูุฌุฏ ุงูููุทุน (ุจ)</strong><br>ุงูุขู ูุนุฑู ุฃู <span class='math-eq'>ู = ูฃ</span>. ูุณุชุฎุฏู ุงูููุทุฉ (<span class="text-red-600">ูก</span>ุ <span class="text-blue-600">ูข</span>) ููุนูุถ ูู <span class='math-eq'>ุต = ู ุณ + ุจ</span>.<br><span class='math-eq'><span class="text-blue-600">ูข</span> = ูฃ(<span class="text-red-600">ูก</span>) + ุจ</span><br><span class='math-eq'>ูข = ูฃ + ุจ</span>  &larr;  <span class='math-eq'>ุจ = -ูก</span>` },
                    { text: `<strong>ุงูุฎุทูุฉ 3: ููุชุจ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ</strong><br>ูุฌุฏูุง ุฃู <span class='math-eq'>ู = ูฃ</span> ู <span class='math-eq'>ุจ = -ูก</span>. ุฅุฐู ุงููุนุงุฏูุฉ ูู:<br><div class="text-center mt-2 p-2 bg-green-100 rounded-md"><span class='math-eq'>ุต = ูฃุณ - ูก</span></div>` }
                ]
            },
            "2b": {
                totalSteps: 3,
                stepsContent: [
                    { text: "ูุฏููุง ููุทุชุงูุ ูุฐูู ุณูููู ุจุซูุงุซ ุฎุทูุงุช ุจุณูุทุฉ ูููุตูู ููุญู." },
                    { text: `<strong>ุงูุฎุทูุฉ 1: ูุฌุฏ ุงูููู (ู)</strong><br>ูุณุชุฎุฏู ุงูููุทุชูู (<span class="text-red-600">ูข</span>ุ <span class="text-blue-600">ูฅ</span>) ู (<span class="text-red-600">ูค</span>ุ <span class="text-blue-600">ูก</span>).<br><span class='math-eq'>ู = <span class="fraction"><span>ูุฑู ุงูุตุงุฏุงุช</span><span>ูุฑู ุงูุณููุงุช</span></span> = <span class="fraction"><span><span class="text-blue-600">ูก</span> - <span class="text-blue-600">ูฅ</span></span><span><span class="text-red-600">ูค</span> - <span class="text-red-600">ูข</span></span></span> = <span class="fraction"><span>-ูค</span><span>ูข</span></span> = -ูข</span>` },
                    { text: `<strong>ุงูุฎุทูุฉ 2: ูุฌุฏ ุงูููุทุน (ุจ)</strong><br>ุงูุขู ูุนุฑู ุฃู <span class='math-eq'>ู = -ูข</span>. ูุณุชุฎุฏู ุงูููุทุฉ (<span class="text-red-600">ูข</span>ุ <span class="text-blue-600">ูฅ</span>) ููุนูุถ ูู <span class='math-eq'>ุต = ู ุณ + ุจ</span>.<br><span class='math-eq'><span class="text-blue-600">ูฅ</span> = -ูข(<span class="text-red-600">ูข</span>) + ุจ</span><br><span class='math-eq'>ูฅ = -ูค + ุจ</span>  &larr;  <span class='math-eq'>ุจ = ูฉ</span>` },
                    { text: `<strong>ุงูุฎุทูุฉ 3: ููุชุจ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ</strong><br>ูุฌุฏูุง ุฃู <span class='math-eq'>ู = -ูข</span> ู <span class='math-eq'>ุจ = ูฉ</span>. ุฅุฐู ุงููุนุงุฏูุฉ ูู:<br><div class="text-center mt-2 p-2 bg-green-100 rounded-md"><span class='math-eq'>ุต = -ูขุณ + ูฉ</span></div>` }
                ]
            },
            "3a": {
                totalSteps: 4,
                stepsContent: [
                    { text: "ูุญู ูุฐู ุงููุณุฃูุฉุ ุนูููุง ุฃููุงู ุฅูุฌุงุฏ ูุนุงุฏูุฉ ุงูุฎุท ุงููุณุชููู ุงูุชู ุชูุซู ุชูููุฉ ุงูุงุดุชุฑุงู." },
                    { text: `<strong>ุงูุฎุทูุฉ 1: ูุญุฏุฏ ุงูููุทุชูู</strong><br>ูุนุชุจุฑ ุนุฏุฏ ุงูุฃุดูุฑ ูู (ุณ) ูุงูุชูููุฉ ูู (ุต).<br>ุงูููุทุฉ ุงูุฃููู: ุจุนุฏ ุดูุฑูู (ุณ=ูข) ูุงูุช ุงูุชูููุฉ ูฃูู ุฑูุงู &larr; (<span class="text-red-600">ูข</span>ุ <span class="text-blue-600">ูฃูู</span>).<br>ุงูููุทุฉ ุงูุซุงููุฉ: ุจุนุฏ ูฅ ุฃุดูุฑ (ุณ=ูฅ) ูุงูุช ุงูุชูููุฉ ูฆูู ุฑูุงู &larr; (<span class="text-red-600">ูฅ</span>ุ <span class="text-blue-600">ูฆูู</span>).` },
                    { text: `<strong>ุงูุฎุทูุฉ 2: ูุฌุฏ ุงูููู (ู)</strong><br>ุงูููู ููุซู ุงูุชูููุฉ ุงูุดูุฑูุฉ.<br><span class='math-eq'>ู = <span class="fraction"><span>ูฆูู - ูฃูู</span><span>ูฅ - ูข</span></span> = <span class="fraction"><span>ูฃูู</span><span>ูฃ</span></span> = ูกูู</span> ุฑูุงู ููู ุดูุฑ.` },
                    { text: `<strong>ุงูุฎุทูุฉ 3: ูุฌุฏ ุงููุนุงุฏูุฉ</strong><br>ูุณุชุฎุฏู ุงูููู <span class='math-eq'>ู = ูกูู</span> ูุงูููุทุฉ (<span class="text-red-600">ูข</span>ุ <span class="text-blue-600">ูฃูู</span>) ูุฅูุฌุงุฏ (ุจ) (ุฑุณูู ุงูุชุณุฌูู ุงูุฃูููุฉ).<br><span class='math-eq'>ูฃูู = ูกูู(ูข) + ุจ</span>  &larr;  <span class='math-eq'>ูฃูู = ูขูู + ุจ</span>  &larr;  <span class='math-eq'>ุจ = ูกูู</span>.<br>ุฅุฐู ุงููุนุงุฏูุฉ ูู: <span class='math-eq'>ุต = ูกููุณ + ูกูู</span>.` },
                    { text: `<strong>ุงูุฎุทูุฉ 4: ูุชูุจุฃ ุจุงูุชูููุฉ ุจุนุฏ ูจ ุฃุดูุฑ</strong><br>ูุนูุถ <span class='math-eq'>ุณ = ูจ</span> ูู ุงููุนุงุฏูุฉ.<br><span class='math-eq'>ุต = ูกูู(ูจ) + ูกูู</span><br><span class='math-eq'>ุต = ูจูู + ูกูู = ูฉูู</span><br><div class="text-center mt-2 p-2 bg-green-100 rounded-md">ุฅุฐูุ ุณูููู ุนูู ูุฏ ุฏูุน ูฉูู ุฑูุงู ุจุนุฏ ูจ ุฃุดูุฑ.</div>` }
                ]
            },
            "3b": {
                totalSteps: 5,
                stepsContent: [
                    { text: "ูุฅูุฌุงุฏ ุงููุนุงุฏูุฉ ูุงูุชูุจุค ุจุงูุฃุฌุฑุฉุ ุนูููุง ุฃููุงู ุชุญุฏูุฏ ุงูููู (ู) ูุงูููุทุน ุงูุตุงุฏู (ุจ)." },
                    { text: `<strong>ุงูุฎุทูุฉ 1: ูุญุฏุฏ ููุทุชูู ูู ุงููุณุฃูุฉ</strong><br>ูุนุชุจุฑ ุนุฏุฏ ุงูุณุงุนุงุช ุงูุฅุถุงููุฉ ูู (ุณ) ูุงูุฃุฌุฑุฉ ุงูุฅุฌูุงููุฉ ูู (ุต).<br>ุงูุฑุงุชุจ ุงูุฃุณุงุณู (ุนูุฏ ุณ=ู ุณุงุนุงุช) ูู ูฃูฅูก ุฑูุงู &larr; ุงูููุทุฉ (<span class="text-red-600">ู</span>ุ <span class="text-blue-600">ูฃูฅูก</span>).<br>ุจุนุฏ ูฅ ุณุงุนุงุช ุฅุถุงููุฉุ ุงูุฃุฌุฑุฉ ูคูกูฆ ุฑูุงู &larr; ุงูููุทุฉ (<span class="text-red-600">ูฅ</span>ุ <span class="text-blue-600">ูคูกูฆ</span>).` },
                    { text: `<strong>ุงูุฎุทูุฉ 2: ูุฌุฏ ุงูููู (ู)</strong><br>ุงูููู ูู ุงูุฃุฌุฑุฉ ููู ุณุงุนุฉ ุฅุถุงููุฉ.<br><span class='math-eq'>ู = <span class="fraction"><span>ูคูกูฆ - ูฃูฅูก</span><span>ูฅ - ู</span></span> = <span class="fraction"><span>ูฆูฅ</span><span>ูฅ</span></span> = ูกูฃ</span>` },
                    { text: `<strong>ุงูุฎุทูุฉ 3: ูุฌุฏ ุงูููุทุน (ุจ)</strong><br>ูุนูุถ ุงูููู <span class='math-eq'>ู = ูกูฃ</span> ูุงูููุทุฉ ุงูุฃุณูู (<span class='math-eq'>(ูุ ูฃูฅูก)</span>) ูู ุงููุนุงุฏูุฉ <span class='math-eq'>ุต = ู ุณ + ุจ</span>.<br><span class='math-eq'><span class="text-blue-600">ูฃูฅูก</span> = ูกูฃ(<span class="text-red-600">ู</span>) + ุจ</span><br><span class='math-eq'>ูฃูฅูก = ู + ุจ</span> &larr; <span class='math-eq'>ุจ = ูฃูฅูก</span>` },
                    { text: `<strong>ุงูุฎุทูุฉ 4: ููุชุจ ุงููุนุงุฏูุฉ</strong><br>ุงูููู (ู) = ูกูฃ ูุงูููุทุน (ุจ) = ูฃูฅูก.<br>ุฅุฐู ุงููุนุงุฏูุฉ ูู:<br><div class="text-center mt-2 p-2 bg-blue-100 rounded-md"><span class='math-eq'>ุต = ูกูฃุณ + ูฃูฅูก</span></div>` },
                    { text: `<strong>ุงูุฎุทูุฉ 5: ูุชูุจุฃ ุจุงูุฃุฌุฑุฉ ูู ูจ ุณุงุนุงุช</strong><br>ูุนูุถ ุณ = ูจ ูู ุงููุนุงุฏูุฉ.<br><span class='math-eq'>ุต = ูกูฃ(ูจ) + ูฃูฅูก</span><br><span class='math-eq'>ุต = ูกููค + ูฃูฅูก = ูคูฅูฅ</span><br><div class="text-center mt-2 p-2 bg-green-100 rounded-md">ุฅุฐูุ ุณุชููู ุฃุฌุฑุชู ูคูฅูฅ ุฑูุงูุงู.</div>` }
                ]
            }
        };

        function createInteractiveSection(config) {
            let currentStep = 0;
            const renderStep = (step) => {
                if(config.stepCounter) config.stepCounter.textContent = step;
                
                let cumulativeHTML = '';
                if (config.stepsContent.length > 0) {
                    if(config.stepsContent[0]) {
                        cumulativeHTML = `<div class="explanation-step" style="opacity:1; border: none; padding-right: 0;">${config.stepsContent[0].text}</div>`;
                    }
                    for (let i = 1; i <= step; i++) {
                        if(config.stepsContent[i]) {
                            cumulativeHTML += `<div class="explanation-step" style="opacity:1;">${config.stepsContent[i].text}</div>`;
                        }
                    }
                }
                if(config.explanationDiv) config.explanationDiv.innerHTML = cumulativeHTML;
                
                if(config.backBtn) config.backBtn.disabled = (step === 0);
                if(config.nextBtn) config.nextBtn.textContent = (step === config.totalSteps) ? 'ุฅุนุงุฏุฉ' : 'ุงูุชุงูู';
            };
            
            if(config.nextBtn) config.nextBtn.addEventListener('click', () => {
                currentStep = (currentStep < config.totalSteps) ? currentStep + 1 : 0;
                renderStep(currentStep);
            });
            
            if(config.backBtn) config.backBtn.addEventListener('click', () => {
                if (currentStep > 0) {
                    currentStep--;
                    renderStep(currentStep);
                }
            });
            
            renderStep(0);
        }

        function initOldExamples() {
            Object.keys(configs).forEach(key => {
                createInteractiveSection({
                    nextBtn: document.getElementById(`interactive-next-${key}`),
                    backBtn: document.getElementById(`interactive-back-${key}`),
                    stepCounter: document.getElementById(`interactive-step-counter-${key}`),
                    explanationDiv: document.getElementById(`interactive-explanation-${key}`),
                    ...configs[key]
                });
            });
        }
        // --- END: Code from OLD lesson ---

        const student = getStudentFromStorage();
        const lessonTitleElement = document.getElementById('lesson-title');
        const lessonTitle = lessonTitleElement ? lessonTitleElement.textContent : null;
        buildHeader(student, lessonTitle);
        buildFooter();
        
        // Initialize OLD examples
        initOldExamples();

        // Initialize NEW quiz
        const questions = generateQuiz();
        initializeQuiz(LESSON_ID, questions, student);
        
        const retakeBtn = document.getElementById('retake-quiz-btn');
        if(retakeBtn) { retakeBtn.addEventListener('click', () => { window.location.reload(); }); }
        
        const closeModalBtn = document.getElementById('closeModalBtn');
        if(closeModalBtn) { closeModalBtn.addEventListener('click', closeModal); }
    });
    </script>
</body>
</html>
