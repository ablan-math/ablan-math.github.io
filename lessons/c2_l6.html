<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงูุฏุฑุณ ูข-ูฆ: ุงููุชุชุงุจุนุงุช ุงูุญุณุงุจูุฉ | ููุตุฉ ุงูุฑูุงุถูุงุช ุงูุชูุงุนููุฉ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; }
        .hidden { display: none; }
        .vocab-term { background-color: #ffefc5; padding: 2px 6px; border-radius: 4px; font-weight: bold; }
        .option-label { display: block; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; cursor: pointer; transition: all 0.2s ease-in-out; }
        .option-label:hover { border-color: #3b82f6; background-color: #eff6ff; }
        input[type="radio"]:checked + .option-label { border-color: #2563eb; background-color: #dbeafe; box-shadow: 0 0 0 2px #bfdbfe; }
        .feedback-correct { color: #16a34a; }
        .feedback-incorrect { color: #dc2626; }
        .math-eq {
            color: #4338ca; /* indigo-700 */
            font-weight: bold;
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        }
        .explanation-step { 
            padding-right: 12px; 
            margin-bottom: 1rem; 
            border-right: 3px solid #1d4ed8; 
            transition: opacity 0.5s ease-in-out; 
        }
        .explanation-step:last-child {
            margin-bottom: 0;
        }
        .fraction {
            display: inline-flex;
            flex-direction: column;
            text-align: center;
            vertical-align: middle;
            margin: 0 0.2em;
            line-height: 1.2em;
        }
        .fraction > span { display: block; padding: 0 0.2em; }
        .fraction > span:last-child { border-top: 2px solid currentColor; }
        .nav-btn:disabled {
            background-color: #9ca3af;
            cursor: not-allowed;
        }
        .sequence-box {
            display: inline-block;
            width: 50px;
            height: 50px;
            line-height: 50px;
            text-align: center;
            border: 2px solid #cbd5e1;
            border-radius: 8px;
            margin: 0 5px;
            font-size: 1.25rem;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .diff-arrow {
            position: relative;
            top: -15px;
            margin: 0 -5px;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        .diff-arrow.plus { color: #16a34a; }
        .diff-arrow.minus { color: #ef4444; }
    </style>
</head>
<body class="bg-gray-100">

    <div id="app-container" class="grid grid-template-rows: auto 1fr auto; min-height: 100vh;">
        <header id="main-header" class="bg-white shadow-md sticky top-0 z-50"></header>
        <main class="container mx-auto max-w-4xl my-8">
            <div class="p-6 bg-white rounded-xl shadow-lg">
                <header class="flex justify-between items-center mb-8 border-b pb-4 border-gray-200">
                    <h1 id="lesson-title" class="text-3xl font-bold text-blue-800">ุงูุฏุฑุณ ูข-ูฆ: ุงููุชุชุงุจุนุงุช ุงูุญุณุงุจูุฉ</h1>
                    <a href="../index.html" target="_top" class="text-sm text-blue-600 hover:underline">&larr; ุงูุนูุฏุฉ ุฅูู ุงูููุฑุณ</a>
                </header>
                
                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">๐ก ุฃููุงู: ุงูููุงููู ุงูุฃุณุงุณูุฉ</h2>
                    <div class="p-6 bg-blue-50 rounded-lg space-y-6">
                        <div>
                            <h3 class="text-xl font-semibold text-blue-700 mb-2">ุงููุชุชุงุจุนุฉ ุงูุญุณุงุจูุฉ</h3>
                            <p>ุงูุชุนุจูุฑ ุงูููุธู: ุงููุชุชุงุจุนุฉ ุงูุญุณุงุจูุฉ ููุท ุนุฏุฏู ูุฒูุฏ ุฃู ูููุต ุจููุฏุงุฑ ุซุงุจุช ููุณูู <span class="vocab-term">ุฃุณุงุณ ุงููุชุชุงุจุนุฉ</span> (ุฏ).</p>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold text-blue-700 mb-2">ุงูุญุฏ ุงููููู ูู ูุชุชุงุจุนุฉ ุญุณุงุจูุฉ</h3>
                            <p>ููุนุจูุฑ ุนู ุงูุญุฏ ุงููููู (ุฃ<sub class="font-bold">ู</sub>) ููุชุชุงุจุนุฉ ุญุณุงุจูุฉ ุญุฏูุง ุงูุฃูู (ุฃ<sub class="font-bold">ูก</sub>)ุ ูุฃุณุงุณูุง (ุฏ) ุจุงูุตูุบุฉ ุงูุชุงููุฉุ ุญูุซ (ู) ุนุฏุฏ ุตุญูุญ ููุฌุจ.</p>
                             <div class="mt-4 p-4 bg-white rounded-lg border">
                                 <p class="text-lg text-center font-bold">ุตูุบุฉ ุงูุญุฏ ุงููููู</p>
                                 <p class="text-center my-2 p-3 bg-indigo-50 rounded-md text-xl math-eq">
                                    ุฃ<sub class="font-bold">ู</sub> = ุฃ<sub class="font-bold">ูก</sub> + (ู - ูก) ุฏ
                                 </p>
                             </div>
                        </div>
                    </div>
                </section>

                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">๐ฏ ุซุงููุงู: ุชูููุฒ ุงููุชุชุงุจุนุงุช</h2>
                    <div class="p-6 bg-gray-50 rounded-lg space-y-4">
                        <p>ูู ุงููุชุชุงุจุนุงุช ุงูุชุงููุฉ ุญุณุงุจูุฉ ุฃู ูุงุ ุงุชุจุน ุงูุฎุทูุงุช ุงูุชูุงุนููุฉ ููุนุฑูุฉ ุฐูู.</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div class="border p-4 rounded-lg bg-white">
                                <h3 class="font-bold text-center mb-2 text-lg">ูุซุงู 1: ูุชุชุงุจุนุฉ ุญุณุงุจูุฉ</h3>
                                <div class="text-center my-4">
                                    <span id="seq-box-1" class="sequence-box">ูฅ</span>
                                    <span id="diff-1" class="diff-arrow plus">&nbsp;</span>
                                    <span id="seq-box-2" class="sequence-box">ูกูก</span>
                                    <span id="diff-2" class="diff-arrow plus">&nbsp;</span>
                                    <span id="seq-box-3" class="sequence-box">ูกูง</span>
                                    <span id="diff-3" class="diff-arrow plus">&nbsp;</span>
                                    <span id="seq-box-4" class="sequence-box">ูขูฃ</span>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-lg border min-h-[150px]">
                                    <div id="identify-explanation-1" class="text-right"></div>
                                </div>
                                <div class="mt-4 flex justify-between items-center">
                                    <button id="identify-anim-back-1" class="nav-btn bg-gray-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-gray-600 text-sm">ุฑุฌูุน</button>
                                    <span class="text-sm font-bold text-gray-600">ุงูุฎุทูุฉ <span id="identify-step-counter-1">0</span> / 4</span>
                                    <button id="identify-anim-next-1" class="nav-btn bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg hover:bg-indigo-700 text-sm">ุงูุชุงูู</button>
                                </div>
                            </div>
                            <div class="border p-4 rounded-lg bg-white">
                                <h3 class="font-bold text-center mb-2 text-lg">ูุซุงู 2: ููุณุช ุญุณุงุจูุฉ</h3>
                                <div class="text-center my-4">
                                    <span id="seq-box-2-1" class="sequence-box">ูก</span>
                                    <span id="diff-2-1" class="diff-arrow plus">&nbsp;</span>
                                    <span id="seq-box-2-2" class="sequence-box">ูข</span>
                                    <span id="diff-2-2" class="diff-arrow plus">&nbsp;</span>
                                    <span id="seq-box-2-3" class="sequence-box">ูค</span>
                                    <span id="diff-2-3" class="diff-arrow plus">&nbsp;</span>
                                    <span id="seq-box-2-4" class="sequence-box">ูง</span>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-lg border min-h-[150px]">
                                    <div id="identify-explanation-2" class="text-right"></div>
                                </div>
                                <div class="mt-4 flex justify-between items-center">
                                    <button id="identify-anim-back-2" class="nav-btn bg-gray-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-gray-600 text-sm">ุฑุฌูุน</button>
                                    <span class="text-sm font-bold text-gray-600">ุงูุฎุทูุฉ <span id="identify-step-counter-2">0</span> / 4</span>
                                    <button id="identify-anim-next-2" class="nav-btn bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg hover:bg-indigo-700 text-sm">ุงูุชุงูู</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">๐ ุซุงูุซุงู: ุฅูุฌุงุฏ ุงูุญุฏูุฏ ุงูุชุงููุฉ (ุชูุงุนูู)</h2>
                    <div class="p-6 bg-gray-50 rounded-lg space-y-4">
                         <p>ุฃูุฌุฏ ุงูุญุฏูุฏ ุงูุชุงููุฉ ูู ุงููุชุชุงุจุนุงุช ุงูุญุณุงุจูุฉ ุงูุชุงููุฉ.</p>
                         <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div class="border p-4 rounded-lg bg-white">
                                <h3 class="font-bold text-center mb-2 text-lg">ูุซุงู 1: ุฃุณุงุณ ููุฌุจ</h3>
                                <div class="text-center my-4 flex justify-center items-center flex-wrap">
                                    <span id="next-term-box-1" class="sequence-box">ูข</span>
                                    <span id="next-term-diff-1" class="diff-arrow plus">&nbsp;</span>
                                    <span id="next-term-box-2" class="sequence-box">ูฅ</span>
                                    <span id="next-term-diff-2" class="diff-arrow plus">&nbsp;</span>
                                    <span id="next-term-box-3" class="sequence-box">ูจ</span>
                                    <span id="next-term-diff-3" class="diff-arrow plus">&nbsp;</span>
                                    <span id="next-term-box-4" class="sequence-box">ูกูก</span>
                                    <span id="next-term-diff-4" class="diff-arrow plus">&nbsp;</span>
                                    <span id="next-term-box-5" class="sequence-box text-gray-400">?</span>
                                    <span id="next-term-diff-5" class="diff-arrow plus">&nbsp;</span>
                                    <span id="next-term-box-6" class="sequence-box text-gray-400">?</span>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-lg border min-h-[120px]">
                                    <div id="next-term-explanation-1" class="text-right"></div>
                                </div>
                                <div class="mt-4 flex justify-between items-center">
                                    <button id="next-term-back-1" class="nav-btn bg-gray-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-gray-600 text-sm">ุฑุฌูุน</button>
                                    <span class="text-sm font-bold text-gray-600">ุงูุฎุทูุฉ <span id="next-term-counter-1">0</span> / 4</span>
                                    <button id="next-term-next-1" class="nav-btn bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg hover:bg-indigo-700 text-sm">ุงูุชุงูู</button>
                                </div>
                            </div>
                            <div class="border p-4 rounded-lg bg-white">
                                <h3 class="font-bold text-center mb-2 text-lg">ูุซุงู 2: ุฃุณุงุณ ุณุงูุจ</h3>
                                <div class="text-center my-4 flex justify-center items-center flex-wrap">
                                    <span id="next-term-2-box-1" class="sequence-box">ูขู</span>
                                    <span id="next-term-2-diff-1" class="diff-arrow minus">&nbsp;</span>
                                    <span id="next-term-2-box-2" class="sequence-box">ูกูฅ</span>
                                    <span id="next-term-2-diff-2" class="diff-arrow minus">&nbsp;</span>
                                    <span id="next-term-2-box-3" class="sequence-box">ูกู</span>
                                    <span id="next-term-2-diff-3" class="diff-arrow minus">&nbsp;</span>
                                    <span id="next-term-2-box-4" class="sequence-box">ูฅ</span>
                                    <span id="next-term-2-diff-4" class="diff-arrow minus">&nbsp;</span>
                                    <span id="next-term-2-box-5" class="sequence-box text-gray-400">?</span>
                                     <span id="next-term-2-diff-5" class="diff-arrow minus">&nbsp;</span>
                                    <span id="next-term-2-box-6" class="sequence-box text-gray-400">?</span>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-lg border min-h-[120px]">
                                    <div id="next-term-explanation-2" class="text-right"></div>
                                </div>
                                <div class="mt-4 flex justify-between items-center">
                                    <button id="next-term-back-2" class="nav-btn bg-gray-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-gray-600 text-sm">ุฑุฌูุน</button>
                                    <span class="text-sm font-bold text-gray-600">ุงูุฎุทูุฉ <span id="next-term-counter-2">0</span> / 4</span>
                                    <button id="next-term-next-2" class="nav-btn bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg hover:bg-indigo-700 text-sm">ุงูุชุงูู</button>
                                </div>
                            </div>
                         </div>
                    </div>
                </section>

                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">๐ ุฑุงุจุนุงู: ูุชุงุจุฉ ูุนุงุฏูุฉ ุงูุญุฏ ุงููููู (ุทุฑููุชุงู)</h2>
                    <div class="p-6 bg-gray-50 rounded-lg space-y-4">
                         <p>ุงูุชุจ ูุนุงุฏูุฉ ุงูุญุฏ ุงููููู ูููุชุชุงุจุนุฉ ุงูุญุณุงุจูุฉ: ูฃุ ูกูุ ูกูงุ ูขูคุ ...</p>
                         <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div class="border p-4 rounded-lg bg-white">
                                <h3 class="font-bold text-center mb-2 text-lg">ุงูุทุฑููุฉ ุงูุฑุณููุฉ (ุจุงูุตูุบุฉ)</h3>
                                <div class="bg-gray-50 p-4 rounded-lg border min-h-[280px]">
                                   <div id="nth-term-formal-explanation" class="text-right"></div>
                                </div>
                                <div class="mt-4 flex justify-between items-center">
                                   <button id="nth-term-formal-back" class="nav-btn bg-gray-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-gray-600 text-sm">ุฑุฌูุน</button>
                                   <span class="text-sm font-bold text-gray-600">ุงูุฎุทูุฉ <span id="nth-term-formal-counter">0</span> / 5</span>
                                   <button id="nth-term-formal-next" class="nav-btn bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg hover:bg-indigo-700 text-sm">ุงูุชุงูู</button>
                               </div>
                            </div>
                            <div class="border p-4 rounded-lg bg-white">
                                <h3 class="font-bold text-center mb-2 text-lg">ุงูุทุฑููุฉ ุงูุฐูููุฉ (ุงูุณุฑูุนุฉ)</h3>
                                <div class="text-center my-4">
                                    <span id="mental-seq-box-1" class="sequence-box">ูฃ</span>
                                    <span id="mental-diff-1" class="diff-arrow plus">&nbsp;</span>
                                    <span id="mental-seq-box-2" class="sequence-box">ูกู</span>
                                    <span id="mental-diff-2" class="diff-arrow plus">&nbsp;</span>
                                    <span id="mental-seq-box-3" class="sequence-box">ูกูง</span>
                                </div>
                                <div class="bg-gray-50 p-4 rounded-lg border min-h-[200px]">
                                   <div id="nth-term-mental-explanation" class="text-right"></div>
                                </div>
                                <div class="mt-4 flex justify-between items-center">
                                   <button id="nth-term-mental-back" class="nav-btn bg-gray-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-gray-600 text-sm">ุฑุฌูุน</button>
                                   <span class="text-sm font-bold text-gray-600">ุงูุฎุทูุฉ <span id="nth-term-mental-counter">0</span> / 3</span>
                                   <button id="nth-term-mental-next" class="nav-btn bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg hover:bg-indigo-700 text-sm">ุงูุชุงูู</button>
                               </div>
                            </div>
                         </div>
                    </div>
                </section>

                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">โ๏ธ ุฎุงูุณุงู: ุชุทุจููุงุช ุนูู ุงูุญุฏ ุงููููู (ุชูุงุนูู)</h2>
                    <div class="p-6 bg-gray-50 rounded-lg space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div class="border p-4 rounded-lg bg-white">
                                <h3 class="font-bold text-center mb-2 text-lg">ูุซุงู 1: ุฅูุฌุงุฏ ูููุฉ ุญุฏ</h3>
                                <p class="text-center text-gray-700">ุฃูุฌุฏ ุงูุญุฏ ุงูุนุงุดุฑ ูู ุงููุชุชุงุจุนุฉ: ูคุ ูฉุ ูกูคุ ...</p>
                                <div class="bg-gray-50 p-4 rounded-lg border min-h-[280px] mt-4">
                                   <div id="find-value-explanation" class="text-right"></div>
                                </div>
                                <div class="mt-4 flex justify-between items-center">
                                   <button id="find-value-back" class="nav-btn bg-gray-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-gray-600 text-sm">ุฑุฌูุน</button>
                                   <span class="text-sm font-bold text-gray-600">ุงูุฎุทูุฉ <span id="find-value-counter">0</span> / 6</span>
                                   <button id="find-value-next" class="nav-btn bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg hover:bg-indigo-700 text-sm">ุงูุชุงูู</button>
                               </div>
                            </div>
                            <div class="border p-4 rounded-lg bg-white">
                                <h3 class="font-bold text-center mb-2 text-lg">ูุซุงู 2: ุฅูุฌุงุฏ ุชุฑุชูุจ ุญุฏ</h3>
                                <p class="text-center text-gray-700">ูุง ุชุฑุชูุจ ุงูุญุฏ ุงูุฐู ูููุชู ูฃูจ ูู ุงููุชุชุงุจุนุฉ: ูจุ ูกูกุ ูกูคุ ...ุ</p>
                                <div class="bg-gray-50 p-4 rounded-lg border min-h-[280px] mt-4">
                                   <div id="find-rank-explanation" class="text-right"></div>
                                </div>
                                <div class="mt-4 flex justify-between items-center">
                                   <button id="find-rank-back" class="nav-btn bg-gray-500 text-white font-medium py-2 px-4 rounded-lg hover:bg-gray-600 text-sm">ุฑุฌูุน</button>
                                   <span class="text-sm font-bold text-gray-600">ุงูุฎุทูุฉ <span id="find-rank-counter">0</span> / 6</span>
                                   <button id="find-rank-next" class="nav-btn bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg hover:bg-indigo-700 text-sm">ุงูุชุงูู</button>
                               </div>
                            </div>
                         </div>
                    </div>
                </section>

                <section class="mt-12">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-bold text-gray-800">โ๏ธ ุณุงุฏุณุงู: ุญุงู ุฏูุฑู! ุงุฎุชุจุฑ ูููู</h2>
                        <div id="attempts-counter" class="text-sm font-bold text-gray-600"></div>
                    </div>
                    <form id="quizForm" class="p-6 bg-gray-50 rounded-lg space-y-8"></form>
                    <div id="quiz-results" class="hidden mt-6 p-4 rounded-lg text-center">
                        <h3 class="text-xl font-bold">ูุชูุฌุชู ุงูููุงุฆูุฉ</h3>
                        <p id="quiz-score" class="text-4xl font-bold my-2"></p>
                        <div id="save-status" class="mt-4 text-sm font-semibold"></div>
                        <button id="retake-quiz-btn" class="hidden mt-4 bg-blue-600 text-white font-medium py-2 px-6 rounded-lg hover:bg-blue-700">ุฅุนุงุฏุฉ ุงูุงุฎุชุจุงุฑ</button>
                    </div>
                </section>
            </div>
        </main>
        <footer id="main-footer" class="bg-gray-200 py-4"></footer>
    </div>
    <div id="explanationModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-lg shadow-2xl p-6 max-w-lg w-full">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold">๐ก ุดุฑุญ ุงูุฅุฌุงุจุฉ</h3>
                <button id="closeModalBtn" class="p-2 -m-2 rounded-full hover:bg-gray-200">
                    <svg class="h-6 w-6 text-gray-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <div id="explanationText" class="text-gray-700 max-h-[60vh] overflow-y-auto"></div>
        </div>
    </div>
    <script>
    // === ุฏูุงู ูุดุชุฑูุฉ ููููุตุฉ ===
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzrf1-At3Pq7i39bGV3F1iD3-b0G-WWyRi5cgpKeQjyn_N5fh2EmGhoyRKUsbLd-F_UJQ/exec";
    const MAX_ATTEMPTS = 3;
    let currentQuestions = []; 
    function getStudentFromStorage() { const studentDataString = localStorage.getItem('currentStudent'); if (studentDataString) { try { return JSON.parse(studentDataString); } catch (e) { return null; } } return null; }
    function buildHeader(studentData, lessonTitle = null) { const headerContainer = document.getElementById('main-header'); if (!headerContainer) return; let titleHtml; if (lessonTitle) { titleHtml = `<div><h2 class="text-sm text-gray-500 leading-tight">ููุตุฉ ุงูุฑูุงุถูุงุช ุงูุชูุงุนููุฉ</h2><h1 class="text-xl font-bold text-indigo-700 leading-tight">${lessonTitle}</h1></div>`; } else { titleHtml = `<a href="../index.html" target="_top"><h1 class="text-2xl font-bold text-blue-800">ููุตุฉ ุงูุฑูุงุถูุงุช ุงูุชูุงุนููุฉ</h1></a>`; } let userInfoHtml = ''; if (studentData) { userInfoHtml = `<div class="flex items-center gap-4"><span class="font-semibold">ุฃููุงูุ ${studentData.name}</span><a href="../index.html" target="_top" id="logout-link" class="bg-red-500 text-white py-1 px-3 rounded-lg hover:bg-red-600">ุฎุฑูุฌ</a></div>`; } else { userInfoHtml = `<p class="text-lg text-gray-600">ุฒุงุฆุฑ</p>`; } headerContainer.innerHTML = `<div class="container mx-auto px-6 py-4 flex justify-between items-center">${titleHtml}${userInfoHtml}</div>`; const logoutLink = headerContainer.querySelector('#logout-link'); if(logoutLink) { logoutLink.addEventListener('click', () => { localStorage.removeItem('currentStudent'); }); } }
    function buildFooter() { const footerContainer = document.getElementById('main-footer'); if (!footerContainer) return; footerContainer.innerHTML = `<div class="container mx-auto px-6"><p class="text-center text-gray-600 text-sm">ยฉ 2024 ุฌููุน ุงูุญููู ูุญููุธุฉ | ุชุตููู ูุชุทููุฑ: ุฃ. ุนุจุฏุงูุนุฒูุฒ ุฎุงูุฏ ุงูุนุจูุงู</p></div>`; }
    function initializeQuiz(lessonId, questions, studentData) { currentQuestions = questions; const quizForm = document.getElementById('quizForm'); if (!quizForm) return; if (questions.length === 0) { quizForm.innerHTML = `<p class="text-center text-gray-600">ูุง ุชูุฌุฏ ุฃุณุฆูุฉ ูุชุงุญุฉ ููุฐุง ุงูุฏุฑุณ ุญุงููุงู.</p>`; return; } let attemptsLeft; if (studentData) { const studentLessonData = studentData.lessons?.[lessonId] || { attempts: 0 }; attemptsLeft = MAX_ATTEMPTS - studentLessonData.attempts; } else { attemptsLeft = 1; } const attemptsCounter = document.getElementById('attempts-counter'); if (attemptsCounter) { attemptsCounter.innerHTML = `ุงููุญุงููุงุช ุงููุชุจููุฉ: <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full">${attemptsLeft}</span>`; } const quizHtml = questions.map((q, index) => { const optionsHTML = q.options.map((opt, optIndex) => `<div><input type="radio" name="q${index}" value="${opt.value}" id="q${index}_opt${optIndex}" class="hidden"><label for="q${index}_opt${optIndex}" class="option-label">${opt.display}</label></div>`).join(''); return `<div class="p-4 border-2 border-gray-200 rounded-lg bg-white"><p class="font-bold">${index + 1}. <span class="text-yellow-500">${q.level}</span> ${q.text}</p><div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mt-3">${optionsHTML}</div><div id="feedback-q${index}" class="mt-2 text-sm font-bold"></div><button type="button" id="explain-btn-${index}" class="hidden mt-2 text-xs text-blue-600 hover:underline">ุงุนุฑู ููุงุฐุงุ</button></div>`; }).join(''); quizForm.innerHTML = quizHtml + `<button type="submit" id="submit-quiz-btn" class="w-full text-white bg-green-600 hover:bg-green-700 font-medium rounded-lg text-lg px-5 py-3 mt-8">ุชุญูู ูู ุฅุฌุงุจุงุชู</button>`; questions.forEach((q, index) => { const explainBtn = document.getElementById(`explain-btn-${index}`); if(explainBtn) explainBtn.addEventListener('click', () => showExplanation(index)); }); if (attemptsLeft <= 0) { const submitBtn = quizForm.querySelector('#submit-quiz-btn'); submitBtn.disabled = true; submitBtn.textContent = 'ูุง ุชูุฌุฏ ูุญุงููุงุช ูุชุจููุฉ'; submitBtn.classList.add('bg-gray-400', 'hover:bg-gray-400'); } quizForm.onsubmit = (e) => { e.preventDefault(); let score = 0; questions.forEach((q, index) => { const userAnswer = e.target.elements[`q${index}`]?.value; const feedbackEl = document.getElementById(`feedback-q${index}`); if (userAnswer === q.correct) { score++; feedbackEl.textContent = 'โ ุฅุฌุงุจุฉ ุตุญูุญุฉ!'; feedbackEl.className = 'mt-2 text-sm font-bold text-green-600'; } else { feedbackEl.textContent = `โ ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ.`; feedbackEl.className = 'mt-2 text-sm font-bold text-red-600'; } document.getElementById(`explain-btn-${index}`).classList.remove('hidden');}); const finalGrade = Math.round((score / questions.length) * 10); const resultsDiv = document.getElementById('quiz-results'); resultsDiv.classList.remove('hidden'); document.getElementById('quiz-score').textContent = `${finalGrade} / 10`; if (studentData) { saveGrade(lessonId, finalGrade, studentData.id); if (attemptsLeft - 1 > 0) { document.getElementById('retake-quiz-btn').classList.remove('hidden'); } } else { document.getElementById('save-status').textContent = 'ุชู ุนุฑุถ ูุชูุฌุชู. ุณุฌู ุงูุฏุฎูู ูุญูุธ ุชูุฏูู.'; } e.target.querySelector('#submit-quiz-btn').disabled = true; }; }
    function saveGrade(lessonId, grade, studentId) { if (!studentId) return; const saveStatus = document.getElementById('save-status'); saveStatus.textContent = 'ุฌุงุฑู ุญูุธ ูุชูุฌุชู...'; const url = `${SCRIPT_URL}?action=saveGrade&studentId=${studentId}&lessonId=${lessonId}&grade=${grade}`; fetch(url) .then(res => res.json()) .then(result => { if (result.status === 'success') { saveStatus.textContent = 'โ ุชู ุญูุธ ูุชูุฌุชู ุจูุฌุงุญ! ุณุชุธูุฑ ูู ููุญุฉ ุงูุชุญูู ุนูุฏ ุงูุนูุฏุฉ.'; const studentData = JSON.parse(localStorage.getItem('currentStudent')); if (!studentData.lessons) studentData.lessons = {}; if (!studentData.lessons[lessonId] || studentData.lessons[lessonId].grade < grade) { studentData.lessons[lessonId] = { grade: grade, attempts: (studentData.lessons[lessonId]?.attempts || 0) + 1 }; } else { studentData.lessons[lessonId].attempts++; } localStorage.setItem('currentStudent', JSON.stringify(studentData)); } else { throw new Error(result.message); } }) .catch(error => { saveStatus.textContent = 'โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุงูุฏุฑุฌุฉ.'; console.error("Save Grade Error:", error); }); }
    function showExplanation(questionIndex) { const modal = document.getElementById('explanationModal'); const explanationText = document.getElementById('explanationText'); if(modal && explanationText && currentQuestions[questionIndex] && currentQuestions[questionIndex].explanation) { const originalQuestion = questionBank.find(q => q.text === currentQuestions[questionIndex].text); const originalIndex = questionBank.indexOf(originalQuestion); let explanationHTML = currentQuestions[questionIndex].explanation; explanationHTML = explanationHTML.replace(/q[0-9]/g, `q${originalIndex}`); explanationText.innerHTML = explanationHTML; modal.classList.remove('hidden'); } }
    function closeModal() { const modal = document.getElementById('explanationModal'); if(modal) modal.classList.add('hidden'); }
    window.toggleSolution = function(questionId, view) { const formalDiv = document.getElementById(`formal-solution-${questionId}`); const mentalDiv = document.getElementById(`mental-solution-${questionId}`); if (view === 'mental') { formalDiv.style.display = 'none'; mentalDiv.style.display = 'block'; } else { formalDiv.style.display = 'block'; mentalDiv.style.display = 'none'; } }
    
    // === ูุดุบู ุงูููุฏ ุงูุฎุงุต ุจุงูุฏุฑุณ ===
    const LESSON_ID = 'c2_l6'; 
    const questionBank = [
        { type: 'mcq', level: 'โญ', topic: 'concept', text: 'ูุง ูู ุงูุงุณู ุงูุฐู ูุทูู ุนูู ุงูููุฏุงุฑ ุงูุซุงุจุช ุงูุฐู ูุถุงู ููู ุญุฏ ูู ุงููุชุชุงุจุนุฉ ุงูุญุณุงุจูุฉุ', options: [ { display: 'ุงูุญุฏ ุงูุฃูู', value: 'A' }, { display: 'ุงูุญุฏ ุงููููู', value: 'B' }, { display: 'ุงูุฃุณุงุณ', value: 'C' }, { display: 'ุงููุชุบูุฑ', value: 'D' } ], correct: 'C', explanation: '<p>ููุณูู ุงูููุฏุงุฑ ุงูุซุงุจุช ุงูุฐู ูุถุงู (ุฃู ูุทุฑุญ) ูู ุงููุชุชุงุจุนุฉ ุงูุญุณุงุจูุฉ ุจู "ุงูุฃุณุงุณ" ููุฑูุฒ ูู ุจุงูุฑูุฒ (ุฏ).</p>' },
        { type: 'mcq', level: 'โญโญ', topic: 'identify', text: 'ุฃู ูู ุงููุชุชุงุจุนุงุช ุงูุชุงููุฉ ุชูุนุฏ ูุชุชุงุจุนุฉ ุญุณุงุจูุฉุ', options: [ { display: 'ูกุ ูขุ ูคุ ูจุ ...', value: 'A' }, { display: 'ูกูุ ูงุ ูคุ ูกุ ...', value: 'B' }, { display: 'ูกุ -ูกุ ูขุ -ูขุ ...', value: 'C' }, { display: 'ูกุ ูคุ ูฉุ ูกูฆุ ...', value: 'D' } ], correct: 'B', explanation: '<p>ุงููุชุชุงุจุนุฉ (ุจ) ูู ุงูุญุณุงุจูุฉ ูุฃู ุงููุฑู ุจูู ูู ุญุฏูู ูุชุชุงูููู ุซุงุจุช ููุณุงูู -ูฃ. (ูง-ูกู = -ูฃุ ูค-ูง = -ูฃ).</p>' },
        { type: 'mcq', level: 'โญโญ', topic: 'find-difference', text: 'ูุง ุฃุณุงุณ ุงููุชุชุงุจุนุฉ ุงูุญุณุงุจูุฉ: -ูฅุ -ูกุ ูฃุ ูงุ ...ุ', options: [ { display: '-ูค', value: 'A' }, { display: 'ูค', value: 'B' }, { display: 'ูฅ', value: 'C' }, { display: '-ูฅ', value: 'D' } ], correct: 'B', explanation: '<p>ูุฅูุฌุงุฏ ุงูุฃุณุงุณุ ูุทุฑุญ ุฃู ุญุฏ ูู ุงูุฐู ูุณุจูู. ุนูู ุณุจูู ุงููุซุงู: (-ูก) - (-ูฅ) = -ูก + ูฅ = ูค.</p>' },
        { type: 'mcq', level: 'โญโญ', topic: 'next-term', text: 'ุฃูุฌุฏ ุงูุญุฏ ุงูุชุงูู ูู ุงููุชุชุงุจุนุฉ ุงูุญุณุงุจูุฉ: ูขุ ูฉุ ูกูฆุ ูขูฃุ ...', options: [ { display: 'ูขูฉ', value: 'A' }, { display: 'ูฃู', value: 'B' }, { display: 'ูง', value: 'C' }, { display: 'ูฃูก', value: 'D' } ], correct: 'B', explanation: '<p>ุฃููุงูุ ููุฌุฏ ุงูุฃุณุงุณ: ูฉ - ูข = ูง. ุซู ูุถูู ุงูุฃุณุงุณ ุฅูู ุงูุญุฏ ุงูุฃุฎูุฑ: ูขูฃ + ูง = ูฃู.</p>' },
        { type: 'mcq', level: 'โญโญโญ', topic: 'nth-term-formula', text: 'ูุง ูุนุงุฏูุฉ ุงูุญุฏ ุงููููู ูููุชุชุงุจุนุฉ: ูคุ ูฉุ ูกูคุ ูกูฉุ ...ุ', options: [ { display: 'ุฃ<sub class="font-bold">ู</sub> = ูคู + ูฅ', value: 'A' }, { display: 'ุฃ<sub class="font-bold">ู</sub> = ูฅู + ูค', value: 'B' }, { display: 'ุฃ<sub class="font-bold">ู</sub> = ูฅู - ูก', value: 'C' }, { display: 'ุฃ<sub class="font-bold">ู</sub> = ูคู - ูก', value: 'D' } ], correct: 'C', explanation: '<p>ุงูุญุฏ ุงูุฃูู ุฃ<sub class="font-bold">ูก</sub> = ูค ูุงูุฃุณุงุณ ุฏ = ูฉ - ูค = ูฅ. ูุทุจู ุงูุตูุบุฉ: ุฃ<sub class="font-bold">ู</sub> = ุฃ<sub class="font-bold">ูก</sub> + (ู - ูก)ุฏ = ูค + (ู - ูก)ูฅ = ูค + ูฅู - ูฅ = ูฅู - ูก.</p>' },
        { type: 'mcq', level: 'โญโญโญ', topic: 'find-term', text: 'ุงุณุชุฎุฏู ุงููุนุงุฏูุฉ ุฃ<sub class="font-bold">ู</sub> = ูฃู - ูจ ูุฅูุฌุงุฏ ุงูุญุฏ ุงูุนุงุดุฑ ูู ุงููุชุชุงุจุนุฉ.', options: [ { display: 'ูขูข', value: 'A' }, { display: 'ูฃู', value: 'B' }, { display: 'ูฃูจ', value: 'C' }, { display: 'ูกูฅ', value: 'D' } ], correct: 'A', explanation: '<p>ูุฅูุฌุงุฏ ุงูุญุฏ ุงูุนุงุดุฑุ ูุนูุถ ุนู ู ุจู ูกู ูู ุงููุนุงุฏูุฉ: ุฃ<sub class="font-bold">ูกู</sub> = ูฃ(ูกู) - ูจ = ูฃู - ูจ = ูขูข.</p>' },
        { type: 'mcq', level: 'โญโญโญ', topic: 'find-rank', text: 'ูุง ุชุฑุชูุจ ุงูุญุฏ ุงูุฐู ูููุชู (ูฅูฅ) ูู ุงููุชุชุงุจุนุฉ ุงูุญุณุงุจูุฉ: ูกูุ ูกูฅุ ูขูุ ...ุ', options: [ { display: 'ุงูุญุฏ ุงูุนุงุดุฑ', value: 'A' }, { display: 'ุงูุญุฏ ุงูุชุงุณุน', value: 'B' }, { display: 'ุงูุญุฏ ุงูุญุงุฏู ุนุดุฑ', value: 'C' }, { display: 'ุงูุญุฏ ุงูุฎุงูุณ', value: 'D' } ], correct: 'A', 
          explanation: `
            <div id="explanation-wrapper-q0">
                <div id="formal-solution-q0">
                    <div class="space-y-3 text-right">
                        <p><strong>1. ุชุญุฏูุฏ ุงููุนุทูุงุช:</strong></p>
                        <ul class="list-disc pr-6">
                            <li>ุงูุญุฏ ุงููุทููุจ (ุฃ<sub class="font-bold">ู</sub>): <span class="math-eq text-red-600">ูฅูฅ</span></li>
                            <li>ุงูุญุฏ ุงูุฃูู (ุฃ<sub class="font-bold">ูก</sub>): <span class="math-eq text-green-600">ูกู</span></li>
                            <li>ุงูุฃุณุงุณ (ุฏ): <span class="math-eq text-blue-600">ูกูฅ - ูกู = ูฅ</span></li>
                        </ul>
                        <p><strong>2. ูุชุงุจุฉ ุงูุตูุบุฉ ูุงูุชุนููุถ:</strong></p>
                        <p class="math-eq text-center bg-gray-100 p-2 rounded-md">ุฃ<sub class="font-bold">ู</sub> = ุฃ<sub class="font-bold">ูก</sub> + (ู - ูก) ุฏ</p>
                        <p class="math-eq text-center"><span class="text-red-600">ูฅูฅ</span> = <span class="text-green-600">ูกู</span> + (ู - ูก) <span class="text-blue-600">ูฅ</span></p>
                        <p><strong>3. ุญู ุงููุนุงุฏูุฉ ูุฅูุฌุงุฏ (ู):</strong></p>
                        <div class="text-center space-y-2">
                            <p class="math-eq">ูคูฅ = (ู - ูก) ร ูฅ</p>
                            <div><p class="math-eq">ูฉ = ู - ูก</p><p class="text-xs text-gray-500 italic">(ุจูุณูุฉ ุงูุทุฑููู ุนูู ูฅ)</p></div>
                            <div><p class="math-eq"><span class="p-1 bg-green-100 rounded-md">ู = ูกู</span></p><p class="text-xs text-gray-500 italic">(ุจุฅุถุงูุฉ ูก ููุทุฑููู)</p></div>
                        </div>
                    </div>
                    <button onclick="window.toggleSolution('q0', 'mental')" class="mt-4 w-full bg-purple-100 text-purple-700 font-bold py-2 px-4 rounded-lg hover:bg-purple-200">ุนุฑุถ ุงูุญู ุงูุฐููู</button>
                </div>
                <div id="mental-solution-q0" style="display: none;">
                     <div class="space-y-3 text-right">
                        <p><strong>1. ุฅูุฌุงุฏ ูุนุงุฏูุฉ ุงูุญุฏ ุงููููู (ุฐูููุงู):</strong></p>
                        <ul class="list-disc pr-6">
                            <li>ุงูุฃุณุงุณ (ุฏ) = <span class="math-eq text-blue-600">ูฅ</span>. ุฅุฐู ุงููุนุงุฏูุฉ ุชุจุฏุฃ ุจู <span class="math-eq">ูฅู</span>.</li>
                            <li>ุงูุญุฏ ุงูุฃูู <span class="math-eq text-green-600">ูกู</span>. ุงููุฑู ุนู ุงูุฃุณุงุณ: <span class="math-eq">ูกู - ูฅ = ูฅ</span>.</li>
                            <li>ุงููุนุงุฏูุฉ ูู: <span class="math-eq bg-gray-100 p-1 rounded-md">ุฃ<sub class="font-bold">ู</sub> = ูฅู + ูฅ</span>.</li>
                        </ul>
                        <p><strong>2. ูุณุงูุงุฉ ุงููุนุงุฏูุฉ ุจูููุฉ ุงูุญุฏ ุงููุทููุจ:</strong></p>
                        <p class="math-eq text-center">ูฅู + ูฅ = <span class="text-red-600">ูฅูฅ</span></p>
                        <p><strong>3. ุญู ุงููุนุงุฏูุฉ ูุฅูุฌุงุฏ (ู):</strong></p>
                        <div class="text-center space-y-2">
                            <p class="math-eq">ูฅู = ูฅูฅ - ูฅ</p>
                            <p class="math-eq">ูฅู = ูฅู</p>
                            <div><p class="math-eq"><span class="p-1 bg-green-100 rounded-md">ู = ูกู</span></p><p class="text-xs text-gray-500 italic">(ุจูุณูุฉ ุงูุทุฑููู ุนูู ูฅ)</p></div>
                        </div>
                    </div>
                    <button onclick="window.toggleSolution('q0', 'formal')" class="mt-4 w-full bg-gray-200 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-300">ุงูุนูุฏุฉ ููุญู ุงูุฑุณูู</button>
                </div>
            </div>` },
        { type: 'mcq', level: 'โญโญโญ', topic: 'find-rank', text: 'ูุง ุชุฑุชูุจ ุงูุญุฏ ุงูุฐู ูููุชู (ูข) ูู ุงููุชุชุงุจุนุฉ ุงูุญุณุงุจูุฉ: ูขูฆุ ูขูฃุ ูขูุ ...ุ', options: [ { display: 'ุงูุญุฏ ุงูุซุงูู', value: 'A' }, { display: 'ุงูุญุฏ ุงูุชุงุณุน', value: 'B' }, { display: 'ุงูุญุฏ ุงูุณุงุจุน', value: 'C' }, { display: 'ุงูุญุฏ ุงูุนุงุดุฑ', value: 'D' } ], correct: 'B', 
          explanation: `
            <div id="explanation-wrapper-q1">
                 <div id="formal-solution-q1">
                    <div class="space-y-3 text-right">
                        <p><strong>1. ุชุญุฏูุฏ ุงููุนุทูุงุช:</strong></p>
                        <ul class="list-disc pr-6">
                            <li>ุงูุญุฏ ุงููุทููุจ (ุฃ<sub class="font-bold">ู</sub>): <span class="math-eq text-red-600">ูข</span></li>
                            <li>ุงูุญุฏ ุงูุฃูู (ุฃ<sub class="font-bold">ูก</sub>): <span class="math-eq text-green-600">ูขูฆ</span></li>
                            <li>ุงูุฃุณุงุณ (ุฏ): <span class="math-eq text-blue-600">ูขูฃ - ูขูฆ = -ูฃ</span></li>
                        </ul>
                        <p><strong>2. ูุชุงุจุฉ ุงูุตูุบุฉ ูุงูุชุนููุถ:</strong></p>
                        <p class="math-eq text-center bg-gray-100 p-2 rounded-md">ุฃ<sub class="font-bold">ู</sub> = ุฃ<sub class="font-bold">ูก</sub> + (ู - ูก) ุฏ</p>
                        <p class="math-eq text-center"><span class="text-red-600">ูข</span> = <span class="text-green-600">ูขูฆ</span> + (ู - ูก) (<span class="text-blue-600">-ูฃ</span>)</p>
                        <p><strong>3. ุญู ุงููุนุงุฏูุฉ ูุฅูุฌุงุฏ (ู):</strong></p>
                        <div class="text-center space-y-2">
                            <p class="math-eq">-ูขูค = (ู - ูก) ร -ูฃ</p>
                            <div><p class="math-eq">ูจ = ู - ูก</p><p class="text-xs text-gray-500 italic">(ุจูุณูุฉ ุงูุทุฑููู ุนูู -ูฃ)</p></div>
                            <div><p class="math-eq"><span class="p-1 bg-green-100 rounded-md">ู = ูฉ</span></p><p class="text-xs text-gray-500 italic">(ุจุฅุถุงูุฉ ูก ููุทุฑููู)</p></div>
                        </div>
                    </div>
                    <button onclick="window.toggleSolution('q1', 'mental')" class="mt-4 w-full bg-purple-100 text-purple-700 font-bold py-2 px-4 rounded-lg hover:bg-purple-200">ุนุฑุถ ุงูุญู ุงูุฐููู</button>
                </div>
                <div id="mental-solution-q1" style="display: none;">
                     <div class="space-y-3 text-right">
                        <p><strong>1. ุฅูุฌุงุฏ ูุนุงุฏูุฉ ุงูุญุฏ ุงููููู (ุฐูููุงู):</strong></p>
                        <ul class="list-disc pr-6">
                            <li>ุงูุฃุณุงุณ (ุฏ) = <span class="math-eq text-blue-600">-ูฃ</span>. ุฅุฐู ุงููุนุงุฏูุฉ ุชุจุฏุฃ ุจู <span class="math-eq">-ูฃู</span>.</li>
                            <li>ุงูุญุฏ ุงูุฃูู <span class="math-eq text-green-600">ูขูฆ</span>. ุงููุฑู ุนู ุงูุฃุณุงุณ: <span class="math-eq">ูขูฆ - (-ูฃ) = ูขูฉ</span>.</li>
                            <li>ุงููุนุงุฏูุฉ ูู: <span class="math-eq bg-gray-100 p-1 rounded-md">ุฃ<sub class="font-bold">ู</sub> = -ูฃู + ูขูฉ</span>.</li>
                        </ul>
                        <p><strong>2. ูุณุงูุงุฉ ุงููุนุงุฏูุฉ ุจูููุฉ ุงูุญุฏ ุงููุทููุจ:</strong></p>
                        <p class="math-eq text-center">-ูฃู + ูขูฉ = <span class="text-red-600">ูข</span></p>
                        <p><strong>3. ุญู ุงููุนุงุฏูุฉ ูุฅูุฌุงุฏ (ู):</strong></p>
                        <div class="text-center space-y-2">
                            <p class="math-eq">-ูฃู = ูข - ูขูฉ</p>
                            <p class="math-eq">-ูฃู = -ูขูง</p>
                            <div><p class="math-eq"><span class="p-1 bg-green-100 rounded-md">ู = ูฉ</span></p><p class="text-xs text-gray-500 italic">(ุจูุณูุฉ ุงูุทุฑููู ุนูู -ูฃ)</p></div>
                        </div>
                    </div>
                    <button onclick="window.toggleSolution('q1', 'formal')" class="mt-4 w-full bg-gray-200 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-300">ุงูุนูุฏุฉ ููุญู ุงูุฑุณูู</button>
                </div>
            </div>` },
        { type: 'mcq', level: 'โญโญ', topic: 'identify', text: 'ุฃู ูู ุงููุชุชุงุจุนุงุช ุงูุชุงููุฉ ููุณุช ุญุณุงุจูุฉุ', options: [ { display: 'ูกุ ูขุ ูฃุ ูค', value: 'A' }, { display: 'ูฅุ ูกูุ ูกูฅุ ูขู', value: 'B' }, { display: 'ูขุ ูคุ ูจุ ูกูฆ', value: 'C' }, { display: 'ูฅูุ ูคูุ ูฃูุ ูขู', value: 'D' } ], correct: 'C', explanation: '<p>ุงููุชุชุงุจุนุฉ (ุฌ) ููุณุช ุญุณุงุจูุฉ ูุฃู ุงููุฑู ุจูู ุญุฏูุฏูุง ุบูุฑ ุซุงุจุช (ููุฏุณูุฉุ ุชุถุฑุจ ูู ูข ูู ูุฑุฉ).</p>' },
        { type: 'mcq', level: 'โญโญ', topic: 'next-term', text: 'ุฃูุฌุฏ ุงูุญุฏูุฏ ุงูุซูุงุซุฉ ุงูุชุงููุฉ ูู ุงููุชุชุงุจุนุฉ: -ูจุ -ูฆุ -ูคุ ...', options: [ { display: '-ูขุ ูุ ูข', value: 'A' }, { display: '-ูฆุ -ูจุ -ูกู', value: 'B' }, { display: 'ูุ ูขุ ูค', value: 'C' }, { display: '-ูขุ ูกุ ูฃ', value: 'D' } ], correct: 'A', explanation: '<p>ุงูุฃุณุงุณ ูู (-ูฆ) - (-ูจ) = ูข. ุงูุญุฏูุฏ ุงูุชุงููุฉ ูู -ูค+ูข=-ูขุ -ูข+ูข=ูุ ู+ูข=ูข.</p>' },
        { type: 'mcq', level: 'โญโญโญ', topic: 'nth-term-formula', text: 'ูุง ูุนุงุฏูุฉ ุงูุญุฏ ุงููููู ูููุชุชุงุจุนุฉ: ูกูฃุ ูจุ ูฃุ -ูขุ ...ุ', options: [ { display: 'ุฃ<sub class="font-bold">ู</sub> = -ูฅู + ูกูจ', value: 'A' }, { display: 'ุฃ<sub class="font-bold">ู</sub> = ูฅู + ูจ', value: 'B' }, { display: 'ุฃ<sub class="font-bold">ู</sub> = ูกูฃู - ูฅ', value: 'C' }, { display: 'ุฃ<sub class="font-bold">ู</sub> = -ูฅู - ูกูจ', value: 'D' } ], correct: 'A', explanation: '<p>ุงูุญุฏ ุงูุฃูู ูกูฃ ูุงูุฃุณุงุณ -ูฅ. ุจุงุณุชุฎุฏุงู ุงูุทุฑููุฉ ุงูุฐูููุฉ: ุงููุนุงุฏูุฉ ุชุจุฏุฃ ุจู -ูฅู. ูููุตูู ูู -ูฅ ุฅูู ูกูฃ (ุงูุญุฏ ุงูุฃูู)ุ ูุญุชุงุฌ ูุฅุถุงูุฉ ูกูจ. ุฅุฐู ุงููุนุงุฏูุฉ ูู ุฃ<sub class="font-bold">ู</sub> = -ูฅู + ูกูจ.</p>' },
        { type: 'mcq', level: 'โญโญโญ', topic: 'find-term', text: 'ูุง ูู ุงูุญุฏ ุงูุนุดุฑูู ูู ุงููุชุชุงุจุนุฉ ุงูุชู ุญุฏูุง ุงูุฃูู ูฅ ูุฃุณุงุณูุง ูฃุ', options: [ { display: 'ูฆู', value: 'A' }, { display: 'ูฆูข', value: 'B' }, { display: 'ูฆูฅ', value: 'C' }, { display: 'ูฅูฉ', value: 'D' } ], correct: 'B', explanation: `<p>ูุณุชุฎุฏู ุงูุตูุบุฉ ุฃ<sub class="font-bold">ู</sub> = ุฃ<sub class="font-bold">ูก</sub> + (ู-ูก)ุฏ. ูุนูุถ ุจุงูููู: ุฃ<sub class="font-bold">ูขู</sub> = ูฅ + (ูขู-ูก) ร ูฃ = ูฅ + (ูกูฉ ร ูฃ) = ูฅ + ูฅูง = ูฆูข.</p>` }
    ];

    function generateQuiz() {
        const shuffled = [...questionBank].sort(() => 0.5 - Math.random());
        const questionCount = Math.min(shuffled.length, 5);
        return shuffled.slice(0, questionCount);
    }
    
    document.addEventListener('DOMContentLoaded', () => {
        // --- ุงูููุฏ ุงูุฎุงุต ุจุงูุฃูุซูุฉ ุงูุชูุงุนููุฉ ุงููุฏููุฉ ---
        function createInteractiveSection(config) {
            let currentStep = 0;
            const renderStep = (step) => {
                if(config.stepCounter) config.stepCounter.textContent = step;
                let cumulativeHTML = '';
                if (step === 0) { cumulativeHTML = config.stepsContent[0].text; } else { for (let i = 1; i <= step; i++) { cumulativeHTML += `<div class="explanation-step">${config.stepsContent[i].text}</div>`; } }
                if(config.explanationDiv) config.explanationDiv.innerHTML = cumulativeHTML;
                if (config.customRender) { config.customRender(step); }
                if(config.backBtn) config.backBtn.disabled = (step === 0);
                if(config.nextBtn) config.nextBtn.textContent = (step === config.totalSteps) ? 'ุฅุนุงุฏุฉ' : 'ุงูุชุงูู';
            };
            if(config.nextBtn) config.nextBtn.addEventListener('click', () => { currentStep = (currentStep < config.totalSteps) ? currentStep + 1 : 0; renderStep(currentStep); });
            if(config.backBtn) config.backBtn.addEventListener('click', () => { if (currentStep > 0) { currentStep--; renderStep(currentStep); } });
            renderStep(0);
        }
        createInteractiveSection({ nextBtn: document.getElementById('identify-anim-next-1'), backBtn: document.getElementById('identify-anim-back-1'), stepCounter: document.getElementById('identify-step-counter-1'), explanationDiv: document.getElementById('identify-explanation-1'), totalSteps: 4, stepsContent: [ { text: "ูุชุญูู ูู ุฃู ุงููุฑู ุจูู ูู ุญุฏูู ูุชุชุงูููู ุซุงุจุช." }, { text: "<strong>1. ุงููุฑู ุจูู ุงูุญุฏ ุงูุซุงูู ูุงูุฃูู:</strong><br><span class='math-eq'>ูกูก - ูฅ = ูฆ</span>" }, { text: "<strong>2. ุงููุฑู ุจูู ุงูุญุฏ ุงูุซุงูุซ ูุงูุซุงูู:</strong><br><span class='math-eq'>ูกูง - ูกูก = ูฆ</span>" }, { text: "<strong>3. ุงููุฑู ุจูู ุงูุญุฏ ุงูุฑุงุจุน ูุงูุซุงูุซ:</strong><br><span class='math-eq'>ูขูฃ - ูกูง = ูฆ</span>" }, { text: `<strong>4. ุงููุชูุฌุฉ:</strong> ุจูุง ุฃู ุงููุฑู ุซุงุจุช ููุณุงูู ูฆุ ูุงููุชุชุงุจุนุฉ <span class="font-bold text-green-600">ุญุณุงุจูุฉ</span> ูุฃุณุงุณูุง (ุฏ) ูู ูฆ.` } ], customRender: (step) => { for(let i=1; i<=3; i++) { document.getElementById(`diff-${i}`).style.opacity = '0'; document.getElementById(`diff-${i}`).innerHTML = '&nbsp;'; } for(let i=1; i<=4; i++) { document.getElementById(`seq-box-${i}`).classList.remove('bg-blue-100'); } if (step >= 1) { document.getElementById('seq-box-1').classList.add('bg-blue-100'); document.getElementById('seq-box-2').classList.add('bg-blue-100'); const diff1 = document.getElementById('diff-1'); diff1.innerHTML = '+ูฆ'; diff1.style.opacity = '1'; } if (step >= 2) { document.getElementById('seq-box-3').classList.add('bg-blue-100'); const diff2 = document.getElementById('diff-2'); diff2.innerHTML = '+ูฆ'; diff2.style.opacity = '1'; } if (step >= 3) { document.getElementById('seq-box-4').classList.add('bg-blue-100'); const diff3 = document.getElementById('diff-3'); diff3.innerHTML = '+ูฆ'; diff3.style.opacity = '1'; } } });
        createInteractiveSection({ nextBtn: document.getElementById('identify-anim-next-2'), backBtn: document.getElementById('identify-anim-back-2'), stepCounter: document.getElementById('identify-step-counter-2'), explanationDiv: document.getElementById('identify-explanation-2'), totalSteps: 4, stepsContent: [ { text: "ูุชุญูู ูู ุฃู ุงููุฑู ุจูู ูู ุญุฏูู ูุชุชุงูููู ุซุงุจุช." }, { text: "<strong>1. ุงููุฑู ุจูู ุงูุญุฏ ุงูุซุงูู ูุงูุฃูู:</strong><br><span class='math-eq'>ูข - ูก = ูก</span>" }, { text: "<strong>2. ุงููุฑู ุจูู ุงูุญุฏ ุงูุซุงูุซ ูุงูุซุงูู:</strong><br><span class='math-eq'>ูค - ูข = ูข</span>" }, { text: "<strong>3. ุงููุฑู ุจูู ุงูุญุฏ ุงูุฑุงุจุน ูุงูุซุงูุซ:</strong><br><span class='math-eq'>ูง - ูค = ูฃ</span>" }, { text: `<strong>4. ุงููุชูุฌุฉ:</strong> ุจูุง ุฃู ุงููุฑู <span class="font-bold text-red-600">ุบูุฑ ุซุงุจุช</span>ุ ูุงููุชุชุงุจุนุฉ <span class="font-bold text-red-600">ููุณุช ุญุณุงุจูุฉ</span>.` } ], customRender: (step) => { const diffs = ['+ูก', '+ูข', '+ูฃ']; for(let i=1; i<=3; i++) { document.getElementById(`diff-2-${i}`).style.opacity = '0'; document.getElementById(`diff-2-${i}`).innerHTML = '&nbsp;'; } for(let i=1; i<=4; i++) { document.getElementById(`seq-box-2-${i}`).classList.remove('bg-blue-100'); } if (step >= 1) { document.getElementById('seq-box-2-1').classList.add('bg-blue-100'); document.getElementById('seq-box-2-2').classList.add('bg-blue-100'); const diff1 = document.getElementById('diff-2-1'); diff1.innerHTML = diffs[0]; diff1.style.opacity = '1'; } if (step >= 2) { document.getElementById('seq-box-2-3').classList.add('bg-blue-100'); const diff2 = document.getElementById('diff-2-2'); diff2.innerHTML = diffs[1]; diff2.style.opacity = '1'; } if (step >= 3) { document.getElementById('seq-box-2-4').classList.add('bg-blue-100'); const diff3 = document.getElementById('diff-2-3'); diff3.innerHTML = diffs[2]; diff3.style.opacity = '1'; } } });
        createInteractiveSection({ nextBtn: document.getElementById('next-term-next-1'), backBtn: document.getElementById('next-term-back-1'), stepCounter: document.getElementById('next-term-counter-1'), explanationDiv: document.getElementById('next-term-explanation-1'), totalSteps: 4, stepsContent: [ { text: "ููุชุดู ุงูููุท (ุงูุฃุณุงุณ) ุฃููุงู ุซู ูุทุจูู ูุฅูุฌุงุฏ ุงูุญุฏูุฏ ุงูุชุงููุฉ." }, { text: "<strong>1. ููุฌุฏ ุงููุฑู ุจูู ุงูุญุฏูู ุงูุฃูููู:</strong><br><span class='math-eq'>ูฅ - ูข = ูฃ</span>. ุงูุฃุณุงุณ ูู +ูฃ." }, { text: "<strong>2. ูุณุชุฎุฏู ุงูุฃุณุงุณ ูุฅูุฌุงุฏ ุงูุญุฏ ุงูุฎุงูุณ:</strong><br><span class='math-eq'>ูกูก + ูฃ = ูกูค</span>." }, { text: "<strong>3. ููุฑุฑ ุงูุนูููุฉ ูุฅูุฌุงุฏ ุงูุญุฏ ุงูุณุงุฏุณ:</strong><br><span class='math-eq'>ูกูค + ูฃ = ูกูง</span>." }, { text: "<strong>4. ุงูุญุฏูุฏ ุงูุชุงููุฉ ูู ูกูค ู ูกูง.</strong>" } ], customRender: (step) => { for(let i = 1; i <= 5; i++) { if(document.getElementById(`next-term-diff-${i}`)) document.getElementById(`next-term-diff-${i}`).style.opacity = '0'; if(document.getElementById(`next-term-box-${i}`)) document.getElementById(`next-term-box-${i}`).classList.remove('bg-blue-100', 'bg-green-100'); } document.getElementById('next-term-box-5').textContent = '?'; document.getElementById('next-term-box-5').classList.add('text-gray-400'); document.getElementById('next-term-box-6').textContent = '?'; document.getElementById('next-term-box-6').classList.add('text-gray-400'); if (step >= 1) { document.getElementById('next-term-box-1').classList.add('bg-blue-100'); document.getElementById('next-term-box-2').classList.add('bg-blue-100'); document.getElementById('next-term-diff-1').innerHTML = '+ูฃ'; document.getElementById('next-term-diff-1').style.opacity = '1'; } if (step >= 2) { document.getElementById('next-term-box-4').classList.add('bg-blue-100'); document.getElementById('next-term-diff-4').innerHTML = '+ูฃ'; document.getElementById('next-term-diff-4').style.opacity = '1'; const box5 = document.getElementById('next-term-box-5'); box5.textContent = 'ูกูค'; box5.classList.remove('text-gray-400'); box5.classList.add('bg-green-100'); } if (step >= 3) { document.getElementById('next-term-box-5').classList.add('bg-blue-100'); document.getElementById('next-term-diff-5').innerHTML = '+ูฃ'; document.getElementById('next-term-diff-5').style.opacity = '1'; const box6 = document.getElementById('next-term-box-6'); box6.textContent = 'ูกูง'; box6.classList.remove('text-gray-400'); box6.classList.add('bg-green-100'); } } });
        createInteractiveSection({ nextBtn: document.getElementById('next-term-next-2'), backBtn: document.getElementById('next-term-back-2'), stepCounter: document.getElementById('next-term-counter-2'), explanationDiv: document.getElementById('next-term-explanation-2'), totalSteps: 4, stepsContent: [ { text: "ููุชุดู ุงูููุท (ุงูุฃุณุงุณ) ุฃููุงู ุซู ูุทุจูู ูุฅูุฌุงุฏ ุงูุญุฏูุฏ ุงูุชุงููุฉ." }, { text: "<strong>1. ููุฌุฏ ุงููุฑู ุจูู ุงูุญุฏูู ุงูุฃูููู:</strong><br><span class='math-eq'>ูกูฅ - ูขู = -ูฅ</span>. ุงูุฃุณุงุณ ูู -ูฅ." }, { text: "<strong>2. ูุณุชุฎุฏู ุงูุฃุณุงุณ ูุฅูุฌุงุฏ ุงูุญุฏ ุงูุฎุงูุณ:</strong><br><span class='math-eq'>ูฅ + (-ูฅ) = ู</span>." }, { text: "<strong>3. ููุฑุฑ ุงูุนูููุฉ ูุฅูุฌุงุฏ ุงูุญุฏ ุงูุณุงุฏุณ:</strong><br><span class='math-eq'>ู + (-ูฅ) = -ูฅ</span>." }, { text: "<strong>4. ุงูุญุฏูุฏ ุงูุชุงููุฉ ูู ู ู -ูฅ.</strong>" } ], customRender: (step) => { for(let i = 1; i <= 5; i++) { if(document.getElementById(`next-term-2-diff-${i}`)) document.getElementById(`next-term-2-diff-${i}`).style.opacity = '0'; if(document.getElementById(`next-term-2-box-${i}`)) document.getElementById(`next-term-2-box-${i}`).classList.remove('bg-blue-100', 'bg-green-100'); } document.getElementById('next-term-2-box-5').textContent = '?'; document.getElementById('next-term-2-box-5').classList.add('text-gray-400'); document.getElementById('next-term-2-box-6').textContent = '?'; document.getElementById('next-term-2-box-6').classList.add('text-gray-400'); if (step >= 1) { document.getElementById('next-term-2-box-1').classList.add('bg-blue-100'); document.getElementById('next-term-2-box-2').classList.add('bg-blue-100'); document.getElementById('next-term-2-diff-1').innerHTML = '-ูฅ'; document.getElementById('next-term-2-diff-1').style.opacity = '1'; } if (step >= 2) { document.getElementById('next-term-2-box-4').classList.add('bg-blue-100'); document.getElementById('next-term-2-diff-4').innerHTML = '-ูฅ'; document.getElementById('next-term-2-diff-4').style.opacity = '1'; const box5 = document.getElementById('next-term-2-box-5'); box5.textContent = 'ู'; box5.classList.remove('text-gray-400'); box5.classList.add('bg-green-100'); } if (step >= 3) { document.getElementById('next-term-2-box-5').classList.add('bg-blue-100'); document.getElementById('next-term-2-diff-5').innerHTML = '-ูฅ'; document.getElementById('next-term-2-diff-5').style.opacity = '1'; const box6 = document.getElementById('next-term-2-box-6'); box6.textContent = '-ูฅ'; box6.classList.remove('text-gray-400'); box6.classList.add('bg-green-100'); } } });
        createInteractiveSection({ nextBtn: document.getElementById('nth-term-formal-next'), backBtn: document.getElementById('nth-term-formal-back'), stepCounter: document.getElementById('nth-term-formal-counter'), explanationDiv: document.getElementById('nth-term-formal-explanation'), totalSteps: 5, stepsContent: [ { text: "ูุณุชุฎุฏู ุงูุตูุบุฉ ุงูุนุงูุฉ ููุนูุถ ูููุง ุจุงูููู." }, { text: "<strong>1. ูุจุฏุฃ ุจุตูุบุฉ ุงูุญุฏ ุงููููู:</strong><br><span class='math-eq text-center mt-2 block'>ุฃ<sub class='font-bold'>ู</sub> = ุฃ<sub class='font-bold'>ูก</sub> + (ู - ูก) ุฏ</span>" }, { text: "<strong>2. ูุญุฏุฏ ุงูุญุฏ ุงูุฃูู (ุฃ<sub class='font-bold'>ูก</sub>) ูุงูุฃุณุงุณ (ุฏ):</strong><br>ุงูุญุฏ ุงูุฃูู <span class='math-eq'>ุฃ<sub class='font-bold'>ูก</sub> = ูฃ</span>.<br>ุงูุฃุณุงุณ <span class='math-eq'>ุฏ = ูกู - ูฃ = ูง</span>." }, { text: "<strong>3. ูุนูุถ ุจุงูููู ูู ุงูุตูุบุฉ:</strong><br><span class='math-eq text-center mt-2 block'>ุฃ<sub class='font-bold'>ู</sub> = <span class='text-red-600'>ูฃ</span> + (ู - ูก) ร <span class='text-green-600'>ูง</span></span>" }, { text: "<strong>4. ูุณุชุฎุฏู ุฎุงุตูุฉ ุงูุชูุฒูุน:</strong><br><span class='math-eq text-center mt-2 block'>ุฃ<sub class='font-bold'>ู</sub> = ูฃ + ูงู - ูง</span>" }, { text: "<strong>5. ูุฌูุน ุงูุญุฏูุฏ ุงููุชุดุงุจูุฉ:</strong><br><span class='math-eq text-center mt-2 block p-2 bg-green-100 rounded-md'>ุฃ<sub class='font-bold'>ู</sub> = ูงู - ูค</span>" } ] });
        createInteractiveSection({ nextBtn: document.getElementById('nth-term-mental-next'), backBtn: document.getElementById('nth-term-mental-back'), stepCounter: document.getElementById('nth-term-mental-counter'), explanationDiv: document.getElementById('nth-term-mental-explanation'), totalSteps: 3, stepsContent: [ { text: "ูุฐู ุทุฑููุฉ ุณุฑูุนุฉ ูุฅูุฌุงุฏ ุงููุนุงุฏูุฉ ูุจุงุดุฑุฉ." }, { text: "<strong>1. ููุฌุฏ ุงูุฃุณุงุณ (ุฏ):</strong><br><span class='math-eq'>ูกู - ูฃ = ูง</span>.<br>ุฅุฐูุ ุงูุญุฏ ุงููููู ูุจุฏุฃ ุจู <span class='math-eq text-xl'>ูงู</span>." }, { text: "<strong>2. ููุงุฑู ุจุงูุญุฏ ุงูุฃูู:</strong><br>ุงูุญุฏ ุงูุฃูู ุงููุนูู ูู <span class='math-eq text-red-600 text-xl'>ูฃ</span>. ุงููุฑู ุนู ุงูุฃุณุงุณ ูู <span class='math-eq'>ูฃ - ูง = -ูค</span>." }, { text: "<strong>3. ููุชุจ ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ:</strong><br>ูุถูู ุงููุฑู ุงูุฐู ุฃูุฌุฏูุงู ุฅูู ุงูุญุฏ ุงููููู ุงูุงุจุชุฏุงุฆู.<br><span class='math-eq text-center mt-2 block p-2 bg-green-100 rounded-md text-xl'>ุฃ<sub class='font-bold'>ู</sub> = ูงู - ูค</span>" } ], customRender: (step) => { const diffs = [document.getElementById('mental-diff-1'), document.getElementById('mental-diff-2')]; const boxes = [document.getElementById('mental-seq-box-1'), document.getElementById('mental-seq-box-2'), document.getElementById('mental-seq-box-3')]; diffs.forEach(d => { d.style.opacity = '0'; d.innerHTML = '&nbsp;'; }); boxes.forEach(b => b.classList.remove('bg-blue-100', 'border-red-500', 'scale-110')); if (step === 1) { diffs.forEach(d => { d.innerHTML = '+ูง'; d.style.opacity = '1'; }); } if (step === 2) { boxes[0].classList.add('border-red-500', 'scale-110'); } } });
        createInteractiveSection({ nextBtn: document.getElementById('find-value-next'), backBtn: document.getElementById('find-value-back'), stepCounter: document.getElementById('find-value-counter'), explanationDiv: document.getElementById('find-value-explanation'), totalSteps: 6, stepsContent: [ { text: "ูุญุฏุฏ ุงููุนุทูุงุช ุซู ูุนูุถ ูู ุตูุบุฉ ุงูุญุฏ ุงููููู." }, { text: "<strong>1. ุชุญุฏูุฏ ุงููุนุทูุงุช:</strong><br>ุฃ<sub class='font-bold'>ูก</sub> = ูคุ ุฏ = ูฅุ ู = ูกู." }, { text: "<strong>2. ูุชุงุจุฉ ุงูุตูุบุฉ:</strong><br><span class='math-eq'>ุฃ<sub class='font-bold'>ู</sub> = ุฃ<sub class='font-bold'>ูก</sub> + (ู - ูก) ุฏ</span>" }, { text: "<strong>3. ุงูุชุนููุถ ุจุงูููู:</strong><br><span class='math-eq'>ุฃ<sub class='font-bold'>ูกู</sub> = ูค + (ูกู - ูก) ร ูฅ</span>" }, { text: "<strong>4. ุชุจุณูุท ุงูููุณ:</strong><br><span class='math-eq'>ุฃ<sub class='font-bold'>ูกู</sub> = ูค + (ูฉ) ร ูฅ</span>" }, { text: "<strong>5. ุงูุถุฑุจ:</strong><br><span class='math-eq'>ุฃ<sub class='font-bold'>ูกู</sub> = ูค + ูคูฅ</span>" }, { text: "<strong>6. ุงูุฌูุน ูุงูุญู ุงูููุงุฆู:</strong><br><span class='math-eq p-2 bg-green-100 rounded-md'>ุฃ<sub class='font-bold'>ูกู</sub> = ูคูฉ</span>" } ] });
        createInteractiveSection({ nextBtn: document.getElementById('find-rank-next'), backBtn: document.getElementById('find-rank-back'), stepCounter: document.getElementById('find-rank-counter'), explanationDiv: document.getElementById('find-rank-explanation'), totalSteps: 6, stepsContent: [ { text: "ูุญุฏุฏ ุงููุนุทูุงุช ุซู ูุนูุถ ูู ุงูุตูุบุฉ ููุญู ุงููุนุงุฏูุฉ." }, { text: "<strong>1. ุชุญุฏูุฏ ุงููุนุทูุงุช:</strong><br>ุฃ<sub class='font-bold'>ู</sub> = ูฃูจุ ุฃ<sub class='font-bold'>ูก</sub> = ูจุ ุฏ = ูฃ." }, { text: "<strong>2. ูุชุงุจุฉ ุงูุตูุบุฉ:</strong><br><span class='math-eq'>ุฃ<sub class='font-bold'>ู</sub> = ุฃ<sub class='font-bold'>ูก</sub> + (ู - ูก) ุฏ</span>" }, { text: "<strong>3. ุงูุชุนููุถ ุจุงูููู:</strong><br><span class='math-eq'>ูฃูจ = ูจ + (ู - ูก) ร ูฃ</span>" }, { text: "<strong>4. ุทุฑุญ ูจ ูู ุงูุทุฑููู:</strong><br><span class='math-eq'>ูฃู = (ู - ูก) ร ูฃ</span>" }, { text: "<strong>5. ูุณูุฉ ุงูุทุฑููู ุนูู ูฃ:</strong><br><span class='math-eq'>ูกู = ู - ูก</span>" }, { text: "<strong>6. ุฅุถุงูุฉ ูก ููุทุฑููู ูุงูุญู ุงูููุงุฆู:</strong><br><span class='math-eq p-2 bg-green-100 rounded-md'>ูกูก = ู</span>" } ] });

        // --- ุงูููุฏ ุงูุฎุงุต ุจุงูููุตุฉ ---
        const student = getStudentFromStorage();
        const lessonTitleElement = document.getElementById('lesson-title');
        const lessonTitle = lessonTitleElement ? lessonTitleElement.textContent : null;
        buildHeader(student, lessonTitle);
        buildFooter();
        const questions = generateQuiz();
        initializeQuiz(LESSON_ID, questions, student);
        const retakeBtn = document.getElementById('retake-quiz-btn');
        if(retakeBtn) { retakeBtn.addEventListener('click', () => { window.location.reload(); }); }
        const closeModalBtn = document.getElementById('closeModalBtn');
        if(closeModalBtn) { closeModalBtn.addEventListener('click', closeModal); }
    });
    </script>
</body>
</html>
