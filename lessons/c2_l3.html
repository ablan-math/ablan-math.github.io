<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الدرس ٢-٣: تمثيل المعادلات الخطية بيانياً | منصة الرياضيات التفاعلية</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; }
        .hidden { display: none; }
        .step-box { border-right: 4px solid #1d4ed8; }
        .vocab-term { background-color: #ffefc5; padding: 2px 6px; border-radius: 4px; font-weight: bold; }
        .option-label { display: block; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; cursor: pointer; transition: all 0.2s ease-in-out; }
        .option-label:hover { border-color: #3b82f6; background-color: #eff6ff; }
        input[type="radio"]:checked + .option-label { border-color: #2563eb; background-color: #dbeafe; box-shadow: 0 0 0 2px #bfdbfe; }
        input[type="radio"] { display: none; }
        .feedback-correct { color: #16a34a; }
        .feedback-incorrect { color: #dc2626; }
        .highlight-change { color: #ef4444; font-weight: bold; }
        
        /* === تعديل الرموز الرياضية === */
        .math-eq {
            font-family: "Courier New", monospace; /* خط عريض ومتباعد */
            font-size: 1.2rem; /* تكبير حجم الخط */
            font-weight: bold;
            color: #4338ca;
            background-color: #f3f4f6; /* خلفية رمادية فاتحة */
            border: 1px solid #d1d5db; /* إطار خفيف */
            padding: 2px 8px; /* هوامش داخلية */
            border-radius: 6px; /* زوايا دائرية */
            display: inline-block;
            vertical-align: middle; /* محاذاة أفضل مع النص */
        }
        
        .fraction { display: inline-flex; flex-direction: column; text-align: center; vertical-align: middle; margin: 0 0.2em; }
        .fraction > span { display: block; padding: 0 0.4em; }
        .fraction > .frac-bar { border-top: 2px solid #4338ca; }
        .step-interactive { display: none; opacity: 0; transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out; transform: translateY(10px); }
        .step-interactive.active { display: block; opacity: 1; transform: translateY(0); }
        .graph-container {
            position: relative;
            width: 100%;
            max-width: 350px;
            height: 250px;
            margin: 1rem auto;
            border: 1px solid #ccc;
            background-color: white;
        }
        .graph-container svg {
            width: 100%;
            height: 100%;
        }
        .svg-element { transition: opacity 0.5s ease-in-out; }
    </style>
</head>
<body class="bg-gray-100">
    <div id="app-container" class="grid grid-template-rows: auto 1fr auto; min-height: 100vh;">
        <header id="main-header" class="bg-white shadow-md sticky top-0 z-50"></header>
        <main class="container mx-auto max-w-4xl my-8">
            <div class="p-6 bg-white rounded-xl shadow-lg">
                <header class="flex justify-between items-center mb-8 border-b pb-4 border-gray-200">
                    <h1 id="lesson-title" class="text-3xl font-bold text-blue-800">الدرس ٢-٣: تمثيل المعادلات الخطية بيانياً</h1>
                    <a href="../index.html" target="_top" class="text-sm text-blue-600 hover:underline">&larr; العودة إلى الفهرس</a>
                </header>
                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">💡 أولاً: المفهوم الأساسي</h2>
                    <div class="p-4 bg-blue-50 rounded-lg space-y-4">
                        <div>
                            <h3 class="font-bold text-blue-700">فيما سبق...</h3>
                            <p>درست تمثيل العلاقة بين الكميات بالمعادلات.</p>
                        </div>
                        <hr>
                        <div>
                            <h3 class="font-bold text-blue-700">والآن...</h3>
                            <ul class="list-disc pr-6 space-y-2">
                                <li>نميز <span class="vocab-term">المعادلة الخطية</span>.</li>
                                <li>نحدد <span class="vocab-term">المقطع السيني</span> و<span class="vocab-term">المقطع الصادي</span> للمعادلة.</li>
                                <li>نمثل المعادلات الخطية بيانياً.</li>
                            </ul>
                        </div>
                         <hr>
                         <div>
                            <h3 class="font-bold text-blue-700">المفردات الجديدة</h3>
                            <dl class="space-y-3 mt-2">
                                <div>
                                    <dt class="font-bold text-md text-blue-800">المعادلة الخطية</dt>
                                    <dd class="pr-4 text-gray-600 text-sm">هي معادلة يمثلها خط مستقيم. لا تحتوي على أسس للمتغيرات (مثل س²) أو متغيرات مضروبة في بعضها (مثل س ص).</dd>
                                </div>
                                <div>
                                    <dt class="font-bold text-md text-blue-800">الصورة القياسية</dt>
                                    <dd class="pr-4 text-gray-600 text-sm">هي طريقة لكتابة المعادلة الخطية على الصورة <span class="math-eq">أس + ب ص = ج</span>.</dd>
                                </div>
                                <div>
                                    <dt class="font-bold text-md text-blue-800">المقطع السيني (x-intercept)</dt>
                                    <dd class="pr-4 text-gray-600 text-sm">هو الإحداثي السيني للنقطة التي يقطع فيها الخط محور السينات. عند هذه النقطة، تكون قيمة <span class="math-eq">ص = ٠</span>.</dd>
                                </div>
                                <div>
                                    <dt class="font-bold text-md text-blue-800">المقطع الصادي (y-intercept)</dt>
                                    <dd class="pr-4 text-gray-600 text-sm">هو الإحداثي الصادي للنقطة التي يقطع فيها الخط محور الصادات. عند هذه النقطة، تكون قيمة <span class="math-eq">س = ٠</span>.</dd>
                                </div>
                            </dl>
                        </div>
                    </div>
                </section>
                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">🎯 ثانياً: تدريبات سريعة على تمييز المعادلات</h2>
                    <div id="interactive-container-5" class="p-4 bg-white rounded-lg shadow">
                        <p class="text-lg font-semibold mb-4">حدد ما إذا كانت كل معادلة فيما يلي خطية أم لا.</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Question 1 -->
                            <div class="p-3 bg-blue-100 rounded-lg">
                                <p class="text-center font-bold">1. <span class="math-eq">ص = س² + ١</span></p>
                                <div class="steps-container mt-2 space-y-2">
                                    <div class="step-interactive p-3 bg-gray-50 rounded-lg step-box"><p><b class="text-red-600">غير خطية</b></p></div>
                                    <div class="step-interactive p-3 bg-gray-100 rounded-lg step-box"><p class="pr-4"><b>التبرير:</b> لأن المتغير 'س' مرفوع للأس 2.</p></div>
                                </div>
                            </div>
                            <!-- Question 2 -->
                            <div class="p-3 bg-blue-100 rounded-lg">
                                <p class="text-center font-bold">2. <span class="math-eq">٣س + ٥ص = ١٠</span></p>
                                <div class="steps-container mt-2 space-y-2">
                                    <div class="step-interactive p-3 bg-gray-50 rounded-lg step-box"><p><b class="text-green-600">خطية</b></p></div>
                                    <div class="step-interactive p-3 bg-gray-100 rounded-lg step-box"><p class="pr-4"><b>التبرير:</b> يمكن كتابتها على الصورة القياسية والمتغيرات من الأس الأول.</p></div>
                                </div>
                            </div>
                            <!-- Question 3 -->
                            <div class="p-3 bg-blue-100 rounded-lg">
                                <p class="text-center font-bold">3. <span class="math-eq">س ص = ٤</span></p>
                                <div class="steps-container mt-2 space-y-2">
                                    <div class="step-interactive p-3 bg-gray-50 rounded-lg step-box"><p><b class="text-red-600">غير خطية</b></p></div>
                                    <div class="step-interactive p-3 bg-gray-100 rounded-lg step-box"><p class="pr-4"><b>التبرير:</b> لأن المتغيرين 'س' و 'ص' مضروبان في بعضهما.</p></div>
                                </div>
                            </div>
                            <!-- Question 4 -->
                            <div class="p-3 bg-blue-100 rounded-lg">
                                <p class="text-center font-bold">4. <span class="math-eq flex inline-flex items-center"><span class="fraction"><span>ص</span><span class="frac-bar"></span><span>٢</span></span> = س</span></p>
                                <div class="steps-container mt-2 space-y-2">
                                    <div class="step-interactive p-3 bg-gray-50 rounded-lg step-box"><p><b class="text-green-600">خطية</b></p></div>
                                    <div class="step-interactive p-3 bg-gray-100 rounded-lg step-box"><p class="pr-4"><b>التبرير:</b> يمكن كتابتها على الصورة <span class="math-eq">٢س - ص = ٠</span>، وهي تحقق الشروط.</p></div>
                                </div>
                            </div>
                        </div>
                        <div class="flex justify-center mt-6">
                             <div class="interactive-placeholder text-center text-gray-500 p-4"><p>اضغط "التالي" لإظهار الإجابات بشكل متسلسل</p></div>
                        </div>
                        <div class="flex justify-between mt-2">
                            <button data-example="5" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">رجوع</button>
                            <div>
                                <button data-example="5" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">التالي</button>
                                <button data-example="5" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">إعادة</button>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">🎯 ثالثاً: أمثلة تفاعلية لإيجاد الصورة القياسية</h2>
                    <div class="p-6 bg-gray-50 rounded-lg">
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <!-- Example A -->
                            <div id="interactive-container-6" class="p-4 bg-white rounded-lg shadow flex flex-col">
                                <p class="text-lg font-semibold mb-4 text-center">مثال ١</p>
                                <p class="text-center mb-4"><span class="math-eq">ص = ٣س - ٤</span></p>
                                <div class="steps-container space-y-4 flex-grow min-h-[150px]">
                                    <div class="interactive-placeholder text-center text-gray-500 p-4"><p>اضغط "التالي"</p></div>
                                    <div class="step-interactive p-2 bg-gray-50 rounded-lg step-box"><h4 class="font-bold text-sm">الخطوة ١: الهدف</h4><p class="text-sm">الهدف هو الوصول للصورة القياسية <span class="math-eq text-base">أس + ب ص = ج</span>.</p></div>
                                    <div class="step-interactive p-2 bg-gray-50 rounded-lg step-box"><h4 class="font-bold text-sm">الخطوة ٢: نقل المتغيرات</h4><p class="text-sm">نطرح <span class="math-eq text-base">٣س</span> من الطرفين. فتصبح: <span class="math-eq text-base">ص - ٣س = -٤</span></p></div>
                                    <div class="step-interactive p-2 bg-green-100 rounded-lg step-box border-green-600"><h4 class="font-bold text-sm">الخطوة ٣: الحل النهائي</h4><p class="text-sm">نضرب في -١ ونرتب: <span class="math-eq text-base">٣س - ص = ٤</span></p></div>
                                </div>
                                <div class="flex justify-between mt-6">
                                    <button data-example="6" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">رجوع</button>
                                    <div>
                                        <button data-example="6" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">التالي</button>
                                        <button data-example="6" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">إعادة</button>
                                    </div>
                                </div>
                            </div>
                            <!-- Example B -->
                            <div id="interactive-container-7" class="p-4 bg-white rounded-lg shadow flex flex-col">
                                <p class="text-lg font-semibold mb-4 text-center">مثال ٢</p>
                                <p class="text-center mb-4"><span class="math-eq">٢ص = ٨ - ٦س</span></p>
                                <div class="steps-container space-y-4 flex-grow min-h-[150px]">
                                    <div class="interactive-placeholder text-center text-gray-500 p-4"><p>اضغط "التالي"</p></div>
                                    <div class="step-interactive p-2 bg-gray-50 rounded-lg step-box"><h4 class="font-bold text-sm">الخطوة ١: الهدف</h4><p class="text-sm">الهدف هو الوصول للصورة القياسية <span class="math-eq text-base">أس + ب ص = ج</span>.</p></div>
                                    <div class="step-interactive p-2 bg-gray-50 rounded-lg step-box"><h4 class="font-bold text-sm">الخطوة ٢: نقل المتغيرات</h4><p class="text-sm">نضيف <span class="math-eq text-base">٦س</span> إلى الطرفين. فتصبح: <span class="math-eq text-base">٦س + ٢ص = ٨</span></p></div>
                                    <div class="step-interactive p-2 bg-green-100 rounded-lg step-box border-green-600"><h4 class="font-bold text-sm">الخطوة ٣: الحل النهائي</h4><p class="text-sm">المعادلة الآن بالصورة القياسية.</p></div>
                                </div>
                                <div class="flex justify-between mt-6">
                                    <button data-example="7" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">رجوع</button>
                                    <div>
                                        <button data-example="7" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">التالي</button>
                                        <button data-example="7" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">إعادة</button>
                                    </div>
                                </div>
                            </div>
                            <!-- Example C -->
                            <div id="interactive-container-8" class="p-4 bg-white rounded-lg shadow flex flex-col">
                                <p class="text-lg font-semibold mb-4 text-center">مثال ٣</p>
                                <p class="text-center mb-4"><span class="math-eq">ص = -٧س</span></p>
                                <div class="steps-container space-y-4 flex-grow min-h-[150px]">
                                    <div class="interactive-placeholder text-center text-gray-500 p-4"><p>اضغط "التالي"</p></div>
                                    <div class="step-interactive p-2 bg-gray-50 rounded-lg step-box"><h4 class="font-bold text-sm">الخطوة ١: الهدف</h4><p class="text-sm">الهدف هو الوصول للصورة القياسية <span class="math-eq text-base">أس + ب ص = ج</span>.</p></div>
                                    <div class="step-interactive p-2 bg-gray-50 rounded-lg step-box"><h4 class="font-bold text-sm">الخطوة ٢: نقل المتغيرات</h4><p class="text-sm">نضيف <span class="math-eq text-base">٧س</span> إلى الطرفين. فتصبح: <span class="math-eq text-base">٧س + ص = ٠</span></p></div>
                                    <div class="step-interactive p-2 bg-green-100 rounded-lg step-box border-green-600"><h4 class="font-bold text-sm">الخطوة ٣: الحل النهائي</h4><p class="text-sm">المعادلة الآن بالصورة القياسية (قيمة ج = ٠).</p></div>
                                </div>
                                <div class="flex justify-between mt-6">
                                    <button data-example="8" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">رجوع</button>
                                    <div>
                                        <button data-example="8" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">التالي</button>
                                        <button data-example="8" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">إعادة</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                 <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">🎯 رابعاً: تمثيل المعادلات بيانياً</h2>
                    <div class="p-6 bg-gray-50 rounded-lg">
                        <div class="flex flex-col space-y-8">
                            <!-- Example 1 -->
                            <div id="interactive-container-1" class="p-4 bg-white rounded-lg shadow">
                                <p class="text-lg font-semibold mb-4">مثال ٣: أوجد المقطعين السيني والصادي للمعادلة <span class="math-eq">٢س + ٤ص = ١٦</span></p>
                                <div class="flex flex-col md:flex-row-reverse gap-8 items-center">
                                    <!-- Right side: Graph -->
                                    <div class="graph-container md:w-1/2">
                                        <svg viewBox="0 0 300 200">
                                            <defs><pattern id="gridMain" width="15" height="15" patternUnits="userSpaceOnUse"><path d="M 15 0 L 0 0 0 15" fill="none" stroke="#e5e7eb" stroke-width="1"/></pattern></defs>
                                            <rect width="100%" height="100%" fill="url(#gridMain)" />
                                            <line x1="0" y1="105" x2="300" y2="105" stroke="#6b7280" stroke-width="2"/>
                                            <text x="280" y="100" font-family="Cairo" font-size="16" fill="#000" font-weight="bold">س</text>
                                            <line x1="150" y1="0" x2="150" y2="200" stroke="#6b7280" stroke-width="2"/>
                                            <text x="155" y="15" font-family="Cairo" font-size="16" fill="#000" font-weight="bold">ص</text>
                                            
                                            <!-- Dynamic Elements -->
                                            <line id="graph-1-line" x1="150" y1="45" x2="270" y2="105" stroke="#1d4ed8" stroke-width="3" class="svg-element hidden"/>
                                            <circle id="graph-1-point-y" cx="150" cy="45" r="5" fill="#ef4444" class="svg-element hidden"/>
                                            <text id="graph-1-text-y" x="100" y="50" font-family="Cairo" font-size="14" fill="#000" font-weight="bold" class="svg-element hidden">(٠، ٤)</text>
                                            <circle id="graph-1-point-x" cx="270" cy="105" r="5" fill="#ef4444" class="svg-element hidden"/>
                                            <text id="graph-1-text-x" x="240" y="130" font-family="Cairo" font-size="14" fill="#000" font-weight="bold" class="svg-element hidden">(٨، ٠)</text>
                                        </svg>
                                    </div>
                                    <!-- Left side: Steps -->
                                    <div class="steps-container md:w-1/2 space-y-4 min-h-[250px]">
                                        <div class="interactive-placeholder text-center text-gray-500 p-4"><p>اضغط "التالي" لبدء خطوات الحل</p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">الخطوة 1: إيجاد المقطع السيني (عند ص=٠)</h4><p>نعوض عن <span class="math-eq">ص</span> بـ <span class="math-eq">٠</span>: <span class="math-eq">٢س + ٤(٠) = ١٦</span></p><p class="text-center mt-2"><span class="math-eq">٢س = ١٦</span> ⬅️ <span class="math-eq">س = ٨</span></p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">الخطوة 2: إيجاد المقطع الصادي (عند س=٠)</h4><p>نعوض عن <span class="math-eq">س</span> بـ <span class="math-eq">٠</span>: <span class="math-eq">٢(٠) + ٤ص = ١٦</span></p><p class="text-center mt-2"><span class="math-eq">٤ص = ١٦</span> ⬅️ <span class="math-eq">ص = ٤</span></p></div>
                                        <div class="step-interactive p-4 bg-green-100 rounded-lg step-box border-green-600"><h4 class="font-bold">الخطوة 3: الحل النهائي</h4><p>نصل بين النقطتين <span class="math-eq">(٨, ٠)</span> و <span class="math-eq">(٠, ٤)</span> لرسم الخط المستقيم.</p></div>
                                    </div>
                                </div>
                                <div class="flex justify-between mt-6">
                                    <button data-example="1" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">رجوع</button>
                                    <div>
                                        <button data-example="1" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">التالي</button>
                                        <button data-example="1" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">إعادة</button>
                                    </div>
                                </div>
                            </div>
                             <!-- Example 2 -->
                            <div id="interactive-container-2" class="p-4 bg-white rounded-lg shadow">
                                <p class="text-lg font-semibold mb-4">مثال ٤: حالة خاصة - تمثيل المعادلة <span class="math-eq">س = ٣</span> بيانياً</p>
                                <div class="flex flex-col md:flex-row-reverse gap-8 items-center">
                                    <div class="graph-container md:w-1/2">
                                        <svg viewBox="0 0 300 200">
                                           <defs><pattern id="gridSpecial" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="#e5e7eb" stroke-width="1"/></pattern></defs>
                                            <rect width="100%" height="100%" fill="url(#gridSpecial)" />
                                            <line x1="0" y1="100" x2="300" y2="100" stroke="#6b7280" stroke-width="2"/>
                                            <text x="280" y="95" font-family="Cairo" font-size="16" fill="#000" font-weight="bold">س</text>
                                            <line x1="150" y1="0" x2="150" y2="200" stroke="#6b7280" stroke-width="2"/>
                                            <text x="155" y="15" font-family="Cairo" font-size="16" fill="#000" font-weight="bold">ص</text>
                                            <!-- Dynamic Elements -->
                                            <line id="graph-2-line" x1="210" y1="0" x2="210" y2="200" stroke="#1d4ed8" stroke-width="3" class="svg-element hidden"/>
                                            <circle id="graph-2-point-x" cx="210" cy="100" r="5" fill="#ef4444" class="svg-element hidden"/>
                                            <text id="graph-2-text-x" x="180" y="125" font-family="Cairo" font-size="14" fill="#000" font-weight="bold" class="svg-element hidden">(٣، ٠)</text>
                                        </svg>
                                    </div>
                                    <div class="steps-container md:w-1/2 space-y-4 min-h-[250px]">
                                        <div class="interactive-placeholder text-center text-gray-500 p-4"><p>اضغط "التالي" لبدء خطوات الحل</p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">الخطوة 1: تحليل المعادلة وإيجاد المقطع السيني</h4><p>المعادلة <span class="math-eq">س = ٣</span> تعني أن قيمة <span class="math-eq">س</span> ثابتة دائماً عند ٣. هذا يمثل خطاً رأسياً يقطع محور السينات عند <span class="math-eq">س = ٣</span>.</p></div>
                                        <div class="step-interactive p-4 bg-red-100 rounded-lg step-box border-red-600"><h4 class="font-bold">الخطوة 2: الحل النهائي</h4><p>الخط الرأسي <span class="math-eq">س = ٣</span> يوازي محور الصادات ولا يقطعه أبداً. إذن، <strong class="text-red-700">لا يوجد مقطع صادي</strong>.</p></div>
                                    </div>
                                </div>
                                <div class="flex justify-between mt-6">
                                    <button data-example="2" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">رجوع</button>
                                    <div>
                                        <button data-example="2" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">التالي</button>
                                        <button data-example="2" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">إعادة</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="mt-12">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-bold text-gray-800">✍️ خامساً: حان دورك! اختبر فهمك</h2>
                        <div id="attempts-counter" class="text-sm font-bold text-gray-600"></div>
                    </div>
                    <form id="quizForm" class="p-6 bg-gray-50 rounded-lg space-y-8"></form>
                    <div id="quiz-results" class="hidden mt-6 p-4 rounded-lg text-center">
                        <h3 class="text-xl font-bold">نتيجتك النهائية</h3>
                        <p id="quiz-score" class="text-4xl font-bold my-2"></p>
                        <div id="save-status" class="mt-4 text-sm font-semibold"></div>
                        <button id="retake-quiz-btn" class="hidden mt-4 bg-blue-600 text-white font-medium py-2 px-6 rounded-lg hover:bg-blue-700">إعادة الاختبار</button>
                    </div>
                </section>
            </div>
        </main>
        <footer id="main-footer" class="bg-gray-200 py-4"></footer>
    </div>
    <div id="explanationModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-lg shadow-2xl p-6 max-w-lg w-full">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold">💡 شرح الإجابة</h3>
                <button id="closeModalBtn" class="p-2 -m-2 rounded-full hover:bg-gray-200">
                    <svg class="h-6 w-6 text-gray-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <div id="explanationText" class="text-gray-700 max-h-[60vh] overflow-y-auto"></div>
        </div>
    </div>
    <script>
    // =================================================================================
    // دوال مشتركة (لا تقم بتعديل هذا الجزء)
    // =================================================================================
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzrf1-At3Pq7i39bGV3F1iD3-b0G-WWyRi5cgpKeQjyn_N5fh2EmGhoyRKUsbLd-F_UJQ/exec";
    const MAX_ATTEMPTS = 3;
    let currentQuestions = []; 
    function getStudentFromStorage() { const studentDataString = localStorage.getItem('currentStudent'); if (studentDataString) { try { return JSON.parse(studentDataString); } catch (e) { return null; } } return null; }
    function buildHeader(studentData, lessonTitle = null) { const headerContainer = document.getElementById('main-header'); if (!headerContainer) return; let titleHtml; if (lessonTitle) { titleHtml = `<div><h2 class="text-sm text-gray-500 leading-tight">منصة الرياضيات التفاعلية</h2><h1 class="text-xl font-bold text-indigo-700 leading-tight">${lessonTitle}</h1></div>`; } else { titleHtml = `<a href="../index.html" target="_top"><h1 class="text-2xl font-bold text-blue-800">منصة الرياضيات التفاعلية</h1></a>`; } let userInfoHtml = ''; if (studentData) { userInfoHtml = `<div class="flex items-center gap-4"><span class="font-semibold">أهلاً، ${studentData.name}</span><a href="../index.html" target="_top" id="logout-link" class="bg-red-500 text-white py-1 px-3 rounded-lg hover:bg-red-600">خروج</a></div>`; } else { userInfoHtml = `<p class="text-lg text-gray-600">زائر</p>`; } headerContainer.innerHTML = `<div class="container mx-auto px-6 py-4 flex justify-between items-center">${titleHtml}${userInfoHtml}</div>`; const logoutLink = headerContainer.querySelector('#logout-link'); if(logoutLink) { logoutLink.addEventListener('click', () => { localStorage.removeItem('currentStudent'); }); } }
    function buildFooter() { const footerContainer = document.getElementById('main-footer'); if (!footerContainer) return; footerContainer.innerHTML = `<div class="container mx-auto px-6"><p class="text-center text-gray-600 text-sm">© 2024 جميع الحقوق محفوظة | تصميم وتطوير: أ. عبدالعزيز خالد العبلان</p></div>`; }
    function initializeQuiz(lessonId, questions, studentData) { currentQuestions = questions; const quizForm = document.getElementById('quizForm'); if (!quizForm) return; if (questions.length === 0) { quizForm.innerHTML = `<p class="text-center text-gray-600">لا توجد أسئلة متاحة لهذا الدرس حالياً.</p>`; return; } let attemptsLeft; if (studentData) { const studentLessonData = studentData.lessons?.[lessonId] || { attempts: 0 }; attemptsLeft = MAX_ATTEMPTS - studentLessonData.attempts; } else { attemptsLeft = 1; } const attemptsCounter = document.getElementById('attempts-counter'); if (attemptsCounter) { attemptsCounter.innerHTML = `المحاولات المتبقية: <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full">${attemptsLeft}</span>`; } const quizHtml = questions.map((q, index) => { const optionsHTML = q.options.map((opt, optIndex) => `<div><input type="radio" name="q${index}" value="${opt.value}" id="q${index}_opt${optIndex}" class="hidden"><label for="q${index}_opt${optIndex}" class="option-label">${opt.display}</label></div>`).join(''); return `<div class="p-4 border-2 border-gray-200 rounded-lg"><p class="font-bold">${index + 1}. <span class="text-yellow-500">${q.level}</span> ${q.text}</p><div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mt-3">${optionsHTML}</div><div id="feedback-q${index}" class="mt-2 text-sm font-bold"></div><button type="button" id="explain-btn-${index}" class="hidden mt-2 text-xs text-blue-600 hover:underline">اعرف لماذا؟</button></div>`; }).join(''); quizForm.innerHTML = quizHtml + `<button type="submit" id="submit-quiz-btn" class="w-full text-white bg-green-600 hover:bg-green-700 font-medium rounded-lg text-lg px-5 py-3 mt-8">تحقق من إجاباتي</button>`; questions.forEach((q, index) => { const explainBtn = document.getElementById(`explain-btn-${index}`); if(explainBtn) explainBtn.addEventListener('click', () => showExplanation(index)); }); if (attemptsLeft <= 0) { const submitBtn = quizForm.querySelector('#submit-quiz-btn'); submitBtn.disabled = true; submitBtn.textContent = 'لا توجد محاولات متبقية'; submitBtn.classList.add('bg-gray-400', 'hover:bg-gray-400'); } quizForm.onsubmit = (e) => { e.preventDefault(); let score = 0; questions.forEach((q, index) => { const userAnswer = e.target.elements[`q${index}`]?.value; const feedbackEl = document.getElementById(`feedback-q${index}`); if (userAnswer === q.correct) { score++; feedbackEl.textContent = '✔ إجابة صحيحة!'; feedbackEl.className = 'mt-2 text-sm font-bold text-green-600'; } else { feedbackEl.textContent = `❌ إجابة خاطئة.`; feedbackEl.className = 'mt-2 text-sm font-bold text-red-600'; } document.getElementById(`explain-btn-${index}`).classList.remove('hidden');}); const finalGrade = Math.round((score / questions.length) * 10); const resultsDiv = document.getElementById('quiz-results'); resultsDiv.classList.remove('hidden'); document.getElementById('quiz-score').textContent = `${finalGrade} / 10`; if (studentData) { saveGrade(lessonId, finalGrade, studentData.id); if (attemptsLeft - 1 > 0) { document.getElementById('retake-quiz-btn').classList.remove('hidden'); } } else { document.getElementById('save-status').textContent = 'تم عرض نتيجتك. سجل الدخول لحفظ تقدمك.'; } e.target.querySelector('#submit-quiz-btn').disabled = true; }; }
    function saveGrade(lessonId, grade, studentId) { if (!studentId) return; const saveStatus = document.getElementById('save-status'); saveStatus.textContent = 'جارٍ حفظ نتيجتك...'; const url = `${SCRIPT_URL}?action=saveGrade&studentId=${studentId}&lessonId=${lessonId}&grade=${grade}`; fetch(url) .then(res => res.json()) .then(result => { if (result.status === 'success') { saveStatus.textContent = '✔ تم حفظ نتيجتك بنجاح! ستظهر في لوحة التحكم عند العودة.'; const studentData = JSON.parse(localStorage.getItem('currentStudent')); if (!studentData.lessons) studentData.lessons = {}; if (!studentData.lessons[lessonId] || studentData.lessons[lessonId].grade < grade) { studentData.lessons[lessonId] = { grade: grade, attempts: (studentData.lessons[lessonId]?.attempts || 0) + 1 }; } else { studentData.lessons[lessonId].attempts++; } localStorage.setItem('currentStudent', JSON.stringify(studentData)); } else { throw new Error(result.message); } }) .catch(error => { saveStatus.textContent = '❌ حدث خطأ أثناء حفظ الدرجة.'; console.error("Save Grade Error:", error); }); }
    function showExplanation(questionIndex) { const modal = document.getElementById('explanationModal'); const explanationText = document.getElementById('explanationText'); if(modal && explanationText && currentQuestions[questionIndex] && currentQuestions[questionIndex].explanation) { explanationText.innerHTML = currentQuestions[questionIndex].explanation; modal.classList.remove('hidden'); } }
    function closeModal() { const modal = document.getElementById('explanationModal'); if(modal) modal.classList.add('hidden'); }

    // =================================================================================
    // محتوى الدرس (هذا الجزء يتم تعديله لكل درس)
    // =================================================================================
    
    // 1. ضع مُعرّفاً فريداً للدرس هنا
    const LESSON_ID = 'c2_l3'; 

    // 2. بنك الأسئلة الخاص بالدرس
    function generateQuiz() {
        const questionBank = [
            { 
                type: 'mcq', 
                level: '⭐', 
                text: 'أي من المعادلات التالية هي معادلة خطية؟', 
                options: [
                    { display: '<span class="math-eq">س + ص² = ٥</span>', value: 'opt1' },
                    { display: '<span class="math-eq">س ص = ١٠</span>', value: 'opt2' },
                    { display: '<span class="math-eq">٥س - ص = ٣</span>', value: 'opt3' },
                    { display: '<span class="math-eq flex inline-flex items-center"><span class="fraction"><span>١</span><span class="frac-bar"></span><span>س</span></span> + ص = ٢</span>', value: 'opt4' }
                ], 
                correct: 'opt3', 
                explanation: `<p>المعادلة الخطية لا تحتوي على متغيرات مضروبة ببعضها (مثل س ص)، ولا متغيرات في المقام، ولا أسس أكبر من ١. المعادلة <span class="math-eq">٥س - ص = ٣</span> هي الوحيدة التي تحقق هذه الشروط.</p>`
            },
            { 
                type: 'mcq', 
                level: '⭐⭐', 
                text: 'أوجد المقطعين السيني والصادي للمعادلة <span class="math-eq">٣س + ٦ص = ١٨</span>', 
                options: [
                    { display: 'السيني = ٦، الصادي = ٣', value: 'opt1' },
                    { display: 'السيني = ٣، الصادي = ٦', value: 'opt2' },
                    { display: 'السيني = ١٨، الصادي = ١٨', value: 'opt3' },
                    { display: 'السيني = -٦، الصادي = -٣', value: 'opt4' }
                ], 
                correct: 'opt1', 
                explanation: `<p class='mb-2'><b>لإيجاد المقطع السيني (ص=٠):</b></p><p><span class="math-eq">٣س + ٦(٠) = ١٨</span> ⬅️ <span class="math-eq">٣س = ١٨</span> ⬅️ <span class="math-eq">س = ٦</span></p><p class='mb-2 mt-4'><b>لإيجاد المقطع الصادي (س=٠):</b></p><p><span class="math-eq">٣(٠) + ٦ص = ١٨</span> ⬅️ <span class="math-eq">٦ص = ١٨</span> ⬅️ <span class="math-eq">ص = ٣</span></p>`
            },
            { 
                type: 'mcq', 
                level: '⭐⭐', 
                text: 'اكتب المعادلة <span class="math-eq">ص = -٢س + ٥</span> بالصورة القياسية.', 
                options: [
                    { display: '<span class="math-eq">٢س + ص = ٥</span>', value: 'opt1' },
                    { display: '<span class="math-eq">ص - ٢س = ٥</span>', value: 'opt2' },
                    { display: '<span class="math-eq">-٢س - ص = -٥</span>', value: 'opt3' },
                    { display: '<span class="math-eq">٢س = ٥ - ص</span>', value: 'opt4' }
                ], 
                correct: 'opt1', 
                explanation: `<p>الصورة القياسية هي <span class="math-eq">أس + ب ص = ج</span>. لنقل الحد <span class="math-eq">-٢س</span> إلى الطرف الأيمن بإضافة <span class="math-eq">٢س</span> للطرفين، فتصبح المعادلة <span class="math-eq">٢س + ص = ٥</span>.</p>`
            },
            { 
                type: 'mcq', 
                level: '⭐⭐⭐', 
                text: 'إذا كان المقطع السيني لمعادلة هو ٥ والمقطع الصادي هو -٢، فأي نقطة من التالية تقع على الخط؟', 
                options: [
                    { display: '(٥، -٢)', value: 'opt1' },
                    { display: '(-٢، ٥)', value: 'opt2' },
                    { display: '(٥، ٠)', value: 'opt3' },
                    { display: '(-٥، ٢)', value: 'opt4' }
                ], 
                correct: 'opt3', 
                explanation: `<p>المقطع السيني هو النقطة التي يقطع فيها الخط محور السينات، وتكون قيمة ص عندها صفر. بما أن المقطع السيني هو ٥، فإن النقطة هي (٥، ٠). أما المقطع الصادي -٢ فيمثل النقطة (٠، -٢).</p>`
            },
            { 
                type: 'mcq', 
                level: '⭐⭐', 
                text: `
                    <p class="mb-2">من الرسم البياني أدناه، ما هو المقطع الصادي؟</p>
                    <div class="graph-container mx-auto my-3" style="width: 300px; height: 220px;">
                        <svg viewBox="0 0 300 220">
                            <defs><pattern id="gridQuiz" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="#e5e7eb" stroke-width="1.5"/></pattern></defs>
                            <rect width="100%" height="100%" fill="url(#gridQuiz)" />
                            <line x1="0" y1="110" x2="300" y2="110" stroke="#374151" stroke-width="3"/>
                            <text x="280" y="105" font-family="Cairo" font-size="18" fill="#000" font-weight="bold">س</text>
                            <line x1="150" y1="0" x2="150" y2="220" stroke="#374151" stroke-width="3"/>
                            <text x="155" y="20" font-family="Cairo" font-size="18" fill="#000" font-weight="bold">ص</text>
                            <line x1="150" y1="90" x2="250" y2="110" stroke="#047857" stroke-width="5"/>
                            <circle cx="150" cy="90" r="8" fill="#dc2626"/>
                            <text x="90" y="90" font-family="Cairo" font-size="24" fill="#1f2937" font-weight="bold">(٠، ٢)</text>
                            <circle cx="250" cy="110" r="8" fill="#dc2626"/>
                            <text x="200" y="140" font-family="Cairo" font-size="24" fill="#1f2937" font-weight="bold">(١٠، ٠)</text>
                        </svg>
                    </div>
                `,
                options: [
                    { display: '<span class="math-eq">١٠</span>', value: 'opt1' },
                    { display: '<span class="math-eq">٠</span>', value: 'opt2' },
                    { display: '<span class="math-eq">٢</span>', value: 'opt3' },
                    { display: 'لا يمكن تحديده', value: 'opt4' }
                ], 
                correct: 'opt3', 
                explanation: `<p>المقطع الصادي هو النقطة التي يقطع فيها الخط محور الصادات. بالنظر إلى الرسم البياني، نجد أن الخط يقطع محور الصادات عند <span class="math-eq">ص = ٢</span>.</p>`
            },
            { 
                type: 'mcq', 
                level: '⭐⭐⭐', 
                text: 'ما هو المقطع الصادي للمعادلة <span class="math-eq">ص = -٥</span>؟', 
                options: [
                    { display: '<span class="math-eq">٠</span>', value: 'opt1' },
                    { display: '<span class="math-eq">-٥</span>', value: 'opt2' },
                    { display: '<span class="math-eq">٥</span>', value: 'opt3' },
                    { display: 'لا يوجد', value: 'opt4' }
                ], 
                correct: 'opt2', 
                explanation: `<p>المعادلة <span class="math-eq">ص = -٥</span> تمثل خطاً أفقياً يقطع محور الصادات عند <span class="math-eq">-٥</span>. لذلك، المقطع الصادي هو -٥.</p>`
            },
             { 
                type: 'mcq', 
                level: '⭐⭐⭐', 
                text: 'في مثال "قيادة السيارة"، ماذا يمثل المقطع السيني (قيمة س عندما ص=٠)؟', 
                options: [
                    { display: 'الزمن الكلي للرحلة', value: 'opt1' },
                    { display: 'سرعة السيارة', value: 'opt2' },
                    { display: 'المسافة المبدئية إلى المزرعة', value: 'opt3' },
                    { display: 'المسافة المقطوعة بعد ساعة', value: 'opt4' }
                ], 
                correct: 'opt1', 
                explanation: `<p>المقطع السيني يحدث عندما تكون المسافة المتبقية (ص) تساوي صفراً. في هذا السياق، هو يمثل الزمن اللازم لإنهاء الرحلة والوصول إلى المزرعة.</p>`
            },
            { 
                type: 'mcq', 
                level: '⭐⭐', 
                text: 'أوجد المقطعين السيني والصادي للمعادلة <span class="math-eq">س - ٢ص = ٤</span>', 
                options: [
                    { display: 'السيني = ٤، الصادي = -٢', value: 'opt1' },
                    { display: 'السيني = -٢، الصادي = ٤', value: 'opt2' },
                    { display: 'السيني = ٢، الصادي = -٤', value: 'opt3' },
                    { display: 'السيني = ٤، الصادي = ٢', value: 'opt4' }
                ], 
                correct: 'opt1', 
                explanation: `<p class='mb-2'><b>لإيجاد المقطع السيني (ص=٠):</b></p><p><span class="math-eq">س - ٢(٠) = ٤</span> ⬅️ <span class="math-eq">س = ٤</span></p><p class='mb-2 mt-4'><b>لإيجاد المقطع الصادي (س=٠):</b></p><p><span class="math-eq">٠ - ٢ص = ٤</span> ⬅️ <span class="math-eq">-٢ص = ٤</span> ⬅️ <span class="math-eq">ص = -٢</span></p>`
            },
            { 
                type: 'mcq', 
                level: '⭐⭐', 
                text: 'ما هو المقطع السيني للمعادلة <span class="math-eq">ص = ٢</span>؟', 
                options: [
                    { display: '٢', value: 'opt1' },
                    { display: '٠', value: 'opt2' },
                    { display: '-٢', value: 'opt3' },
                    { display: 'لا يوجد', value: 'opt4' }
                ], 
                correct: 'opt4', 
                explanation: `<p>المعادلة <span class="math-eq">ص = ٢</span> تمثل خطاً أفقياً يوازي محور السينات عند ص=٢ ولا يقطعه أبداً، لذلك لا يوجد مقطع سيني.</p>`
            },
            { 
                type: 'mcq', 
                level: '⭐', 
                text: 'عند أي قيمة للمتغير <span class="math-eq">ص</span> يوجد المقطع السيني؟', 
                options: [
                    { display: '<span class="math-eq">ص = ١</span>', value: 'opt1' },
                    { display: '<span class="math-eq">ص = ٠</span>', value: 'opt2' },
                    { display: '<span class="math-eq">ص = س</span>', value: 'opt3' },
                    { display: 'يعتمد على المعادلة', value: 'opt4' }
                ], 
                correct: 'opt2', 
                explanation: `<p>بالتعريف، المقطع السيني هو النقطة التي يقطع فيها الخط البياني محور السينات، وهذا يحدث دائماً عندما تكون قيمة <span class="math-eq">ص</span> تساوي صفراً.</p>`
            },
            { 
                type: 'mcq', 
                level: '⭐⭐', 
                text: 'أوجد المقطعين السيني والصادي للمعادلة <span class="math-eq">٥س - ٣ص = ١٥</span>', 
                options: [
                    { display: 'السيني = ٣، الصادي = ٥', value: 'opt1' },
                    { display: 'السيني = -٣، الصادي = ٥', value: 'opt2' },
                    { display: 'السيني = ٣، الصادي = -٥', value: 'opt3' },
                    { display: 'السيني = ٥، الصادي = -٣', value: 'opt4' }
                ], 
                correct: 'opt3', 
                explanation: `<p class='mb-2'><b>لإيجاد المقطع السيني (ص=٠):</b></p><p><span class="math-eq">٥س - ٣(٠) = ١٥</span> ⬅️ <span class="math-eq">٥س = ١٥</span> ⬅️ <span class="math-eq">س = ٣</span></p><p class='mb-2 mt-4'><b>لإيجاد المقطع الصادي (س=٠):</b></p><p><span class="math-eq">٥(٠) - ٣ص = ١٥</span> ⬅️ <span class="math-eq">-٣ص = ١٥</span> ⬅️ <span class="math-eq">ص = -٥</span></p>`
            },
            { 
                type: 'mcq', 
                level: '⭐', 
                text: 'النقطة <span class="math-eq">(٠، ب)</span> على الرسم البياني تمثل دائماً...', 
                options: [
                    { display: 'المقطع السيني', value: 'opt1' },
                    { display: 'المقطع الصادي', value: 'opt2' },
                    { display: 'نقطة الأصل', value: 'opt3' },
                    { display: 'نقطة عشوائية', value: 'opt4' }
                ], 
                correct: 'opt2', 
                explanation: `<p>بما أن الإحداثي السيني يساوي صفراً، فإن النقطة تقع على محور الصادات. لذلك، هي تمثل المقطع الصادي.</p>`
            }
        ];
        const shuffled = [...questionBank].sort(() => 0.5 - Math.random());
        const questionCount = Math.min(shuffled.length, 5);
        return shuffled.slice(0, questionCount);
    }

    // =================================================================================
    // مشغل الكود (لا تقم بتعديل هذا الجزء)
    // =================================================================================
    document.addEventListener('DOMContentLoaded', () => {
        const exampleContainers = document.querySelectorAll('[id^="interactive-container-"]');
        const state = {};

        // Special handler for Example 1 Graph
        const graph1State = {
            pointX: document.getElementById('graph-1-point-x'),
            textX: document.getElementById('graph-1-text-x'),
            pointY: document.getElementById('graph-1-point-y'),
            textY: document.getElementById('graph-1-text-y'),
            line: document.getElementById('graph-1-line')
        };
        // Special handler for Example 2 Graph
        const graph2State = {
            pointX: document.getElementById('graph-2-point-x'),
            textX: document.getElementById('graph-2-text-x'),
            line: document.getElementById('graph-2-line')
        };

        function updateGraph1(currentIndex) {
            const elements = [graph1State.pointX, graph1State.textX, graph1State.pointY, graph1State.textY, graph1State.line];
            elements.forEach(el => el?.classList.add('hidden'));

            if (currentIndex >= 0) {
                graph1State.pointX?.classList.remove('hidden');
                graph1State.textX?.classList.remove('hidden');
            }
            if (currentIndex >= 1) {
                graph1State.pointY?.classList.remove('hidden');
                graph1State.textY?.classList.remove('hidden');
            }
            if (currentIndex >= 2) {
                graph1State.line?.classList.remove('hidden');
            }
        }
        
        function updateGraph2(currentIndex) {
            const elements = [graph2State.pointX, graph2State.textX, graph2State.line];
            elements.forEach(el => el?.classList.add('hidden'));

            if (currentIndex >= 0) {
                graph2State.pointX?.classList.remove('hidden');
                graph2State.textX?.classList.remove('hidden');
            }
            if (currentIndex >= 1) {
                graph2State.line?.classList.remove('hidden');
            }
        }

        exampleContainers.forEach(container => {
            const exampleId = container.id.split('-')[2];
            state[exampleId] = { 
                currentIndex: -1, 
                steps: container.querySelectorAll('.step-interactive'), 
                placeholder: container.querySelector('.interactive-placeholder'), 
                prevBtn: container.querySelector('.prev-btn'), 
                nextBtn: container.querySelector('.next-btn'), 
                resetBtn: container.querySelector('.reset-btn') 
            };
            
            const updateUI = () => {
                state[exampleId].steps.forEach((step, index) => {
                    if (index <= state[exampleId].currentIndex) {
                        step.classList.add('active');
                    } else {
                        step.classList.remove('active');
                    }
                });

                if (state[exampleId].currentIndex === -1 && state[exampleId].placeholder) {
                    state[exampleId].placeholder.classList.remove('hidden');
                } else if(state[exampleId].placeholder) {
                    state[exampleId].placeholder.classList.add('hidden');
                }
                
                if (exampleId === '1') {
                    updateGraph1(state[exampleId].currentIndex);
                } else if (exampleId === '2') {
                    updateGraph2(state[exampleId].currentIndex);
                }

                updateButtons();
            };
            
            const resetExample = () => {
                state[exampleId].currentIndex = -1;
                updateUI();
            };

            const updateButtons = () => { 
                const isFirstStep = state[exampleId].currentIndex <= -1; 
                const isLastStep = state[exampleId].currentIndex >= state[exampleId].steps.length - 1; 
                state[exampleId].prevBtn.disabled = isFirstStep; 
                if (isLastStep) { 
                    state[exampleId].nextBtn.classList.add('hidden'); 
                    state[exampleId].resetBtn.classList.remove('hidden'); 
                } else { 
                    state[exampleId].nextBtn.classList.remove('hidden'); 
                    state[exampleId].resetBtn.classList.add('hidden'); 
                } 
            };
            
            state[exampleId].nextBtn.addEventListener('click', () => {
                if (state[exampleId].currentIndex < state[exampleId].steps.length - 1) {
                    state[exampleId].currentIndex++;
                    updateUI();
                }
            });

            state[exampleId].prevBtn.addEventListener('click', () => {
                if (state[exampleId].currentIndex > -1) {
                    state[exampleId].currentIndex--;
                    updateUI();
                }
            });

            if(state[exampleId].resetBtn) { state[exampleId].resetBtn.addEventListener('click', resetExample); }
            updateUI();
        });

        const student = getStudentFromStorage();
        const lessonTitleElement = document.getElementById('lesson-title');
        const lessonTitle = lessonTitleElement ? lessonTitleElement.textContent : null;
        buildHeader(student, lessonTitle);
        buildFooter();
        const questions = generateQuiz();
        initializeQuiz(LESSON_ID, questions, student);
        const retakeBtn = document.getElementById('retake-quiz-btn');
        if(retakeBtn) { retakeBtn.addEventListener('click', () => { window.location.reload(); }); }
        const closeModalBtn = document.getElementById('closeModalBtn');
        if(closeModalBtn) { closeModalBtn.addEventListener('click', closeModal); }
    });
    </script>
</body>
</html>
