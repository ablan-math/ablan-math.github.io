<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงุฎุชุจุงุฑ ุงููุตูู 3-4-5 | ุฑูุงุถูุงุช (ุชุนูููุงุช ุงูุชูููู)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #e0e0e0;
            margin: 0;
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.6); display: flex;
            justify-content: center; align-items: center; z-index: 2000;
        }
        .modal-content {
            background-color: white; padding: 30px 40px; border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3); text-align: center;
            width: 450px; max-width: 90%;
            position: relative;
        }
        .modal-close-btn {
            position: absolute; top: 10px; left: 15px; font-size: 24px;
            cursor: pointer; color: #888; font-weight: bold;
        }
        .modal-close-btn:hover { color: #333; }
        
        .modal-content h2 { margin: 0 0 20px 0; font-size: 22px; }
        .modal-content .form-group { margin-bottom: 15px; text-align: right; }
        .modal-content label { display: block; margin-bottom: 5px; font-weight: bold; }
        .modal-content input, .modal-content select {
            width: 100%; padding: 10px; font-family: 'Cairo', sans-serif;
            font-size: 16px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box;
        }
        .modal-validation-message { color: #dc3545; font-size: 14px; margin-top: 10px; min-height: 20px; }
        
        /* Explanation Modal Specifics */
        #explanation-modal .modal-content {
            background-color: #fff9db;
            border: 2px solid #f1c40f;
            text-align: right;
        }
        #explanation-modal h2 { color: #d35400; display: flex; align-items: center; gap: 10px; }
        .explanation-text { font-size: 16px; line-height: 1.8; color: #333; }

        /* Instruction Modal Specifics */
        #instruction-modal .modal-content {
            background-color: #e3f2fd; /* Light Blue */
            border: 2px solid #2196f3;
        }
        #instruction-modal h2 { color: #0d47a1; }
        .instruction-list { text-align: right; margin: 20px 0; font-size: 15px; line-height: 1.8; color: #333; }
        .instruction-list li { margin-bottom: 10px; }

        #result-modal .result-grid {
            display: grid; grid-template-columns: auto 1fr; gap: 8px 15px;
            text-align: right; margin: 20px 0; align-items: center;
        }
        #result-modal .result-grid strong { font-weight: bold; }
        #result-modal .result-score {
            grid-column: 1 / -1; text-align: center; font-size: 28px; font-weight: bold;
            color: #28a745; margin-top: 10px; border-top: 1px solid #eee; padding-top: 15px;
        }
        #result-modal .submission-note {
            margin-top: 20px; padding: 10px; background-color: #e9f7ec;
            border: 1px solid #28a745; border-radius: 5px; font-size: 14px;
        }
        .modal-buttons { display: flex; justify-content: center; gap: 15px; margin-top: 25px; flex-wrap: wrap;}

        .page {
            background: white; width: 210mm; min-height: 297mm; padding: 15mm;
            margin-bottom: 20px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            box-sizing: border-box; position: relative; display: flex; flex-direction: column;
        }
        .page-content { flex-grow: 1; }
        .page-footer { text-align: center; font-size: 12px; color: #888; padding-top: 10px; }

        .test-header {
            text-align: center; border-bottom: 2px solid #333; padding-bottom: 15px; margin-bottom: 25px;
        }
        .test-header h1 { margin: 0; font-size: 24px; }
        .test-header h2 { margin: 5px 0 0 0; font-size: 20px; font-weight: normal; color: #555; }
        .test-header .info { display: flex; justify-content: space-around; align-items: center; margin-top: 15px; font-size: 14px; }

        .questions-grid { display: grid; grid-template-columns: 1fr; gap: 12px; }
        .question-block {
            border: 1px solid #e0e0e0; padding: 10px 15px; border-radius: 8px;
            background-color: #fafafa; display: flex; flex-direction: column;
            position: relative;
        }
        
        .question-prompt {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin: 0 0 10px 0;
            font-size: 15px;
            font-weight: bold;
            line-height: 1.6;
        }
        .question-number {
            background-color: #e9e9e9;
            padding: 2px 8px;
            border-radius: 5px;
            flex-shrink: 0;
            margin-top: 3px;
        }
        .question-title { flex-grow: 1; font-weight: normal; color: #000; }
        
        .meta-info {
            float: left;
            display: inline-block;
            font-size: 11px;
            color: #666;
            background-color: #eee;
            padding: 2px 6px;
            border-radius: 4px;
            margin-top: 2px;
            margin-right: 10px; 
            font-weight: normal;
            border: 1px solid #ddd;
        }

        .options-container { display: flex; flex-wrap: nowrap; justify-content: space-between; gap: 8px; }
        .option {
            background-color: #ffffff; border: 1px solid #ccc; border-radius: 5px; padding: 5px 10px;
            font-size: 13px; flex-grow: 1; white-space: nowrap; display: flex;
            align-items: center; cursor: pointer; transition: background-color 0.2s, border-color 0.2s;
        }
        .option:hover { background-color: #f0f8ff; border-color: #007bff; }
        .option input[type="radio"] { display: none; }
        .option input[type="radio"]:checked + .option-label {
            background-color: #007bff; color: white; border-color: #0056b3;
        }
        .option-label {
            display: inline-flex; align-items: center; justify-content: center; width: 22px;
            height: 22px; border: 1.5px solid #555; border-radius: 50%;
            font-weight: bold; color: #333; margin-left: 8px; flex-shrink: 0;
            transition: background-color 0.2s, color 0.2s; font-size: 12px;
        }
        .option-text { flex-grow: 1; text-align: center; }
        .fraction {
            display: inline-flex; flex-direction: column; vertical-align: middle;
            margin: 0 0.2em; text-align: center; position: relative; top: -0.3em; font-size: 0.9em;
        }
        .numerator { padding: 0 0.2em; }
        .denominator { border-top: 1.5px solid currentColor; padding: 0 0.2em; }
        
        .controls {
            position: fixed; top: 20px; left: 20px; display: flex;
            flex-direction: column; gap: 10px; z-index: 1000;
        }
        .btn {
            background-color: #007bff; color: white; border: none; padding: 12px 24px;
            border-radius: 5px; cursor: pointer; font-size: 16px; font-family: 'Cairo', sans-serif;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2); text-align: center; transition: background-color 0.2s;
        }
        .btn:hover { background-color: #0056b3; }
        .correct-button { background-color: #28a745; }
        .correct-button:hover { background-color: #218838; }
        .final-submit-button { background-color: #6610f2; animation: pulse 2s infinite; }
        .final-submit-button:hover { background-color: #520dc2; }
        .show-result-button { background-color: #17a2b8; }
        .show-result-button:hover { background-color: #138496; }
        
        .whatsapp-button { 
            background-color: #25D366; 
            color: white; 
            width: 100%; 
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .whatsapp-button:hover { background-color: #128C7E; }

        .retry-button { background-color: #6c757d; }
        .retry-button:hover { background-color: #5a6268; }
        .review-button { background-color: #17a2b8; }
        .review-button:hover { background-color: #138496; }
        .option.correct { border-color: #28a745; background-color: #e9f7ec; }
        .option.incorrect { border-color: #dc3545; background-color: #fdeeee; }
        
        .btn-explain {
            background-color: #ffc107;
            color: #333;
            border: 1px solid #d39e00;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            margin-top: 8px;
            font-weight: bold;
            display: none;
            align-self: flex-start;
            transition: all 0.2s;
        }
        .btn-explain:hover { background-color: #e0a800; transform: scale(1.05); }

        .section-title {
            font-size: 18px; font-weight: bold; margin-top: 20px; margin-bottom: 10px;
            border-bottom: 1px solid #eee; padding-bottom: 5px;
        }
        .essay-questions-container { display: flex; flex-direction: column; gap: 15px; }
        .essay-question-block {
            border: 1px solid #e0e0e0; padding: 15px; border-radius: 8px;
            background-color: #fdfdfd; display: flex; flex-direction: column;
        }

        .answer-space {
            min-height: 80px; border: 1px solid #ccc; border-radius: 5px; margin-top: 5px;
            padding: 8px; flex-grow: 1; font-size: 15px; font-family: 'Cairo', sans-serif;
            resize: vertical; width: 100%; box-sizing: border-box;
        }
        
        .self-grading-section {
            margin-top: 15px;
            border-top: 2px dashed #bbb;
            padding-top: 10px;
            display: none;
            background-color: #f0f8ff;
            padding: 15px;
            border-radius: 5px;
        }
        .model-answer-box {
            background-color: #fff;
            border-right: 4px solid #28a745;
            padding: 10px;
            margin-bottom: 15px;
            font-size: 14px;
            color: #333;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .model-answer-title { color: #28a745; font-weight: bold; display: block; margin-bottom: 5px; }
        .grading-input-box {
            display: flex; align-items: center; gap: 10px;
            background-color: #fff; padding: 10px; border-radius: 5px; border: 1px solid #ddd;
        }
        .grading-input-box input {
            width: 70px; padding: 5px; text-align: center;
            font-weight: bold; font-size: 16px; border: 2px solid #007bff; border-radius: 4px;
        }
        .grading-note { font-size: 12px; color: #666; margin-right: 10px; }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        @media (max-width: 768px) {
            body { padding: 0; }
            .page {
                width: 100%; min-height: auto; height: auto; padding: 15px;
                margin-bottom: 0; box-shadow: none; border-bottom: 5px solid #e0e0e0;
            }
             .page:last-of-type { border-bottom: none; }
            .test-header .info { flex-direction: column; align-items: flex-start; gap: 8px; }
            .options-container { flex-wrap: wrap; gap: 10px; }
            .option { flex-basis: calc(50% - 20px); }
            .controls { top: 10px; left: 10px; }
            .btn { padding: 10px 18px; font-size: 14px; }
        }

        @media print {
            body { background-color: white; padding: 0; margin: 0; }
            .page {
                box-shadow: none; margin: 0; width: auto; min-height: 0;
                height: auto; padding: 0; display: block; border-bottom: none;
            }
            .page:not(:last-of-type) { page-break-after: always; }
            .controls, .page-footer, .self-grading-section, .modal-overlay, .btn-explain, .option input[type="radio"] { display: none !important; }
            .test-header .info {
                display: flex !important; flex-direction: row !important;
                justify-content: space-around !important; align-items: center !important;
                font-size: 12px !important;
            }
            .questions-grid { gap: 8px !important; }
            .question-block { padding: 8px 10px !important; border: 1px solid #ccc !important; }
            .options-container { display: flex !important; flex-wrap: nowrap !important; gap: 5px !important; }
            .option { flex: 1; border: 1px solid #ccc !important; padding: 3px 6px !important; font-size: 11px !important; }
            .option-label { border: 1px solid #555 !important; width: 18px !important; height: 18px !important; font-size: 10px !important; }
            .question-block, .essay-question-block { page-break-inside: avoid; }
            .essay-question-block { border: 1px solid #ccc !important; }
            .answer-space, textarea { border: 1px dotted #999 !important; background-color: #f9f9f9 !important; -webkit-print-color-adjust: exact; }
            .meta-info { border: 1px solid #ccc !important; background-color: #f0f0f0 !important; }
            @page { size: A4; margin: 15mm; }
        }
    </style>
</head>
<body>

    <div id="login-modal" class="modal-overlay">
        <div class="modal-content">
            <h2>ุชุณุฌูู ุงูุฏุฎูู ููุงุฎุชุจุงุฑ</h2>
            <div class="form-group">
                <label for="student-id-input">ุฑูู ุงููููุฉ / ุงูุณุฌู ุงููุฏูู:</label>
                <input type="number" id="student-id-input" placeholder="ุฃุฏุฎู ุฑูู ูููุชู" required>
            </div>
            <div class="form-group">
                <label for="student-class-input">ุงูุตู:</label>
                <select id="student-class-input" required>
                    <option value="" disabled selected>ุงุฎุชุฑ ุตูู...</option>
                    <option value="3-1">ูฃ/ุฃูู</option>
                    <option value="3-2">ูฃ/ุซุงูู</option>
                    <option value="3-3">ูฃ/ุซุงูุซ</option>
                </select>
            </div>
            <p id="login-status" class="modal-validation-message"></p>
            <button class="btn correct-button" onclick="loginWithId()">ุฏุฎูู</button>
        </div>
    </div>
    
    <!-- Instruction Modal (NEW) -->
    <div id="instruction-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div style="font-size: 50px; margin-bottom: 10px;">๐</div>
            <h2>ูุฑุญูุฉ ุงูุชูููู ุงูุฐุงุชู</h2>
            <div class="instruction-list">
                <p><strong>ุฃุญุณูุช!</strong> ุชู ุชุตุญูุญ ุงูุฃุณุฆูุฉ ุงูุงุฎุชูุงุฑูุฉ ุขููุงู.</p>
                <p>ุงูุขู ุฌุงุก ุฏูุฑ <strong>ุงูุฃุณุฆูุฉ ุงูููุงููุฉ</strong>ุ ุงุชุจุน ุงูุฎุทูุงุช ุงูุชุงููุฉ:</p>
                <ol style="padding-right: 20px; margin-top: 5px;">
                    <li>ุณูุธูุฑ ูู ูููุฐุฌ ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ุจุงูููู ุงูุฃุฎุถุฑ ุฃุณูู ูู ุณุคุงู.</li>
                    <li>ูุงุฑู ุฅุฌุงุจุชู ูุน ุงูุฅุฌุงุจุฉ ุงููููุฐุฌูุฉ ุจุฏูุฉ.</li>
                    <li><strong>ุฃูุช ุงููุนูู ุงูุขู!</strong> ุถุน ูููุณู ุงูุฏุฑุฌุฉ ุงูุชู ุชุณุชุญููุง ูู ุงููุฑุจุน ุงูุตุบูุฑ ุจุฌุงูุจ ุงูุณุคุงู.</li>
                </ol>
                <p style="color: #d35400; font-weight: bold; font-size: 14px; margin-top: 10px;">ููุงุญุธุฉ: ูู ููุตูุงู ูุตุงุฏูุงู ูุน ููุณู ูุชุนุฑู ูุณุชูุงู ุงูุญูููู.</p>
            </div>
            <button class="btn correct-button" onclick="closeInstructionModal()">ูููุชุ ุงุจุฏุฃ ุงูุชูููู</button>
        </div>
    </div>

    <div id="result-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h2>ูุชูุฌุฉ ุงูุงุฎุชุจุงุฑ ุงูููุงุฆูุฉ</h2>
            <div class="result-grid">
                <strong>ุงุณู ุงูุทุงูุจ:</strong> <span id="result-student-name"></span>
                <strong>ุงูุตู:</strong> <span id="result-student-class"></span>
                <strong>ูุฏุฉ ุงูุญู:</strong> <span id="result-duration"></span>
                <strong>ุฏุฑุฌุฉ ุงูุงุฎุชูุงุฑุงุช (ุขูู):</strong> <span id="result-mcq-score"></span>
                <strong>ุฏุฑุฌุฉ ุงูููุงูู (ุฐุงุชู):</strong> <span id="result-essay-score"></span>
                <div class="result-score">ุงูุฏุฑุฌุฉ ุงููููุฉ: <span id="result-total-score"></span></div>
            </div>
            
            <button class="btn whatsapp-button" onclick="sendToWhatsApp()">
                <span>๐ค ุฅุฑุณุงู ุงููุชูุฌุฉ ูููุนูู (ูุงุชุณุงุจ)</span>
            </button>
            <p style="font-size:12px; color:#666; margin-top:5px;">ุณูุชู ูุชุญ ูุงุชุณุงุจ ูุฅุฑุณุงู ุงูุฏุฑุฌุฉ ูุฑูู ุงููุนูู ุชููุงุฆูุงู</p>

            <div class="modal-buttons">
                <button class="btn review-button" onclick="reviewAnswers()">ุฅุบูุงู ููุฑุงุฌุนุฉ ุงููุฑูุฉ</button>
                <button class="btn retry-button" onclick="retryTest()">ุฅุนุงุฏุฉ ุงูุงุฎุชุจุงุฑ</button>
            </div>
        </div>
    </div>

    <!-- Explanation Modal -->
    <div id="explanation-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <span class="modal-close-btn" onclick="closeExplanation()">ร</span>
            <h2>๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</h2>
            <div id="explanation-text" class="explanation-text"></div>
        </div>
    </div>

    <div class="controls" style="display: none;">
        <button class="btn print-button" onclick="window.print()">ุทุจุงุนุฉ</button>
        <button id="start-grading-btn" class="btn correct-button" onclick="startSelfGrading()">ุชุตุญูุญ ูุงูุจุฏุก ุจุงูุชูููู ุงูุฐุงุชู</button>
        <button id="submit-final-btn" class="btn final-submit-button" onclick="submitFinalGrade()" style="display: none;">ุญุณุงุจ ุงูุฏุฑุฌุฉ ุงูููุงุฆูุฉ ูุงุนุชูุงุฏูุง</button>
        <button id="show-result-btn" class="btn show-result-button" onclick="showResultModal()" style="display: none;">ูุดุงูุฏุฉ ุงููุชูุฌุฉ</button>
        <button id="retry-btn-main" class="btn retry-button" onclick="retryTest()" style="display: none;">ุฅุนุงุฏุฉ ุงูุงุฎุชุจุงุฑ</button>
    </div>

    <div id="test-container" style="display: none;">
        <!-- ุงูุตูุญุฉ ุงูุฃููู -->
        <div class="page">
            <div class="page-content">
                <div class="test-header">
                    <h1>ุงุฎุชุจุงุฑ ุงูุฑูุงุถูุงุช (ุงููุตูู 3ุ 4ุ 5)</h1>
                    <h2>ุงูุฏูุงู ุงูุฎุทูุฉ | ุงููุชุจุงููุงุช | ุงูุฃูุธูุฉ</h2>
                    <div class="info">
                        <span><strong>ุงูุทุงูุจ:</strong> <span id="display-student-name"></span></span>
                        <span><strong>ุงูุตู:</strong> <span id="display-student-class"></span></span>
                        <span><strong>ุงูุชุงุฑูุฎ:</strong> <span id="display-test-date"></span></span>
                    </div>
                </div>

                <div class="questions-grid">
                    <!-- ุณุคุงู 1 -->
                    <div class="question-block" data-question-id="q1">
                        <p class="question-prompt">
                            <span class="question-number">ูก</span>
                            <span class="question-title">ุงูุตูุบุฉ ุงูููุงุณูุฉ ูููุนุงุฏูุฉ ุงูุฎุทูุฉ ูู: <span class="meta-info">ุชุฐูุฑ - ุฏุฑุณ ูฃ-ูข</span></span>
                        </p>
                        <div class="options-container">
                            <label class="option"><input type="radio" name="q1"><span class="option-label"></span><span class="option-text">ุต = ู ุณ + ุจ</span></label>
                            <label class="option" data-correct="true"><input type="radio" name="q1"><span class="option-label"></span><span class="option-text">ุฃ ุณ + ุจ ุต = ุฌู</span></label>
                            <label class="option"><input type="radio" name="q1"><span class="option-label"></span><span class="option-text">ุต - ุตูก = ู(ุณ - ุณูก)</span></label>
                            <label class="option"><input type="radio" name="q1"><span class="option-label"></span><span class="option-text">ุต = ุฃ ุณ</span></label>
                        </div>
                        <div class="explanation-content" style="display:none;">
                            ุงูุตูุบุฉ ุงูููุงุณูุฉ ูููุนุงุฏูุฉ ุงูุฎุทูุฉ ุชููุชุจ ุนูู ุงูุตูุฑุฉ: <strong>ุฃ ุณ + ุจ ุต = ุฌู</strong>ุ ุญูุซ ุฃ โฅ 0ุ ููุง ูููู ุฃ ู ุจ ููุงููุง ุตูุฑุงูุ ูุชููู ุงูุฃุนุฏุงุฏ ุตุญูุญุฉ (ุจุฏูู ูุณูุฑ).<br>ุจูููุง ุต = ู ุณ + ุจ ูู ุตูุบุฉ ุงูููู ูุงูููุทุน.
                        </div>
                        <button class="btn-explain" onclick="showExplanation(this)">๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</button>
                    </div>

                    <!-- ุณุคุงู 2 -->
                    <div class="question-block" data-question-id="q2">
                        <p class="question-prompt">
                            <span class="question-number">ูข</span>
                            <span class="question-title">ููู ุงููุณุชููู ูู ุงููุนุงุฏูุฉ ุต = ูฅุณ - ูฃ ูู: <span class="meta-info">ููู - ุฏุฑุณ ูฃ-ูก</span></span>
                        </p>
                        <div class="options-container">
                            <label class="option"><input type="radio" name="q2"><span class="option-label"></span><span class="option-text">-ูฃ</span></label>
                            <label class="option"><input type="radio" name="q2"><span class="option-label"></span><span class="option-text">ูฃ</span></label>
                            <label class="option" data-correct="true"><input type="radio" name="q2"><span class="option-label"></span><span class="option-text">ูฅ</span></label>
                            <label class="option"><input type="radio" name="q2"><span class="option-label"></span><span class="option-text">-ูฅ</span></label>
                        </div>
                        <div class="explanation-content" style="display:none;">
                            ูู ูุนุงุฏูุฉ ุงููุณุชููู ุจุตูุบุฉ ุงูููู ูุงูููุทุน (ุต = ู ุณ + ุจ)ุ ููุซู ูุนุงูู ุณ ุงูููู (ู) ูููุซู ุงูุซุงุจุช ุงูููุทุน ุงูุตุงุฏู (ุจ).<br>ููุง ุงููุนุงุฏูุฉ ุต = ูฅุณ - ูฃุ ุฅุฐู ุงูููู ูู ูุนุงูู ุณ ููู <strong>ูฅ</strong>.
                        </div>
                        <button class="btn-explain" onclick="showExplanation(this)">๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</button>
                    </div>

                    <!-- ุณุคุงู 3 -->
                    <div class="question-block" data-question-id="q3">
                        <p class="question-prompt">
                            <span class="question-number">ูฃ</span>
                            <span class="question-title">ูุนุงุฏูุฉ ุงููุณุชููู ุงูุฐู ูููู ูข ูููุทุนู ุงูุตุงุฏู ูค ูู: <span class="meta-info">ุชุทุจูู - ุฏุฑุณ ูฃ-ูข</span></span>
                        </p>
                        <div class="options-container">
                            <label class="option" data-correct="true"><input type="radio" name="q3"><span class="option-label"></span><span class="option-text">ุต = ูขุณ + ูค</span></label>
                            <label class="option"><input type="radio" name="q3"><span class="option-label"></span><span class="option-text">ุต = ูคุณ + ูข</span></label>
                            <label class="option"><input type="radio" name="q3"><span class="option-label"></span><span class="option-text">ุต = ูขุณ - ูค</span></label>
                            <label class="option"><input type="radio" name="q3"><span class="option-label"></span><span class="option-text">ูขุณ + ุต = ูค</span></label>
                        </div>
                        <div class="explanation-content" style="display:none;">
                            ุตูุบุฉ ุงูููู ูุงูููุทุน ูู: ุต = ู ุณ + ุจ.<br>ุจูุง ุฃู ุงูููู (ู) = ูขุ ูุงูููุทุน ุงูุตุงุฏู (ุจ) = ูค.<br>ุจุงูุชุนููุถ ุงููุจุงุดุฑ: <strong>ุต = ูขุณ + ูค</strong>.
                        </div>
                        <button class="btn-explain" onclick="showExplanation(this)">๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</button>
                    </div>

                    <!-- ุณุคุงู 4 -->
                    <div class="question-block" data-question-id="q4">
                        <p class="question-prompt">
                            <span class="question-number">ูค</span>
                            <span class="question-title">ุฅุฐุง ูุงู ูุงุชุฌ ุถุฑุจ ูููู ูุณุชููููู ูุณุงูู -ูกุ ูุฅู ุงููุณุชููููู: <span class="meta-info">ุชุญููู - ุฏุฑุณ ูฃ-ูค</span></span>
                        </p>
                        <div class="options-container">
                            <label class="option"><input type="radio" name="q4"><span class="option-label"></span><span class="option-text">ูุชูุงุฒูุงู</span></label>
                            <label class="option" data-correct="true"><input type="radio" name="q4"><span class="option-label"></span><span class="option-text">ูุชุนุงูุฏุงู</span></label>
                            <label class="option"><input type="radio" name="q4"><span class="option-label"></span><span class="option-text">ูุชุทุงุจูุงู</span></label>
                            <label class="option"><input type="radio" name="q4"><span class="option-label"></span><span class="option-text">ูุชูุงุทุนุงู ูุบูุฑ ูุชุนุงูุฏูู</span></label>
                        </div>
                        <div class="explanation-content" style="display:none;">
                            ูุงุนุฏุฉ: ุงููุณุชูููุงุช ุงููุชุนุงูุฏุฉ ูููู ุญุงุตู ุถุฑุจ ููููููุง ูุณุงูู -ูก (ุฃุญุฏููุง ููููุจ ุงูุขุฎุฑ ุจุฅุดุงุฑุฉ ูุนุงูุณุฉ).<br>ุฃูุง ุงููุณุชูููุงุช ุงููุชูุงุฒูุฉ ูููุง ููุณ ุงูููู.
                        </div>
                        <button class="btn-explain" onclick="showExplanation(this)">๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</button>
                    </div>

                    <!-- ุณุคุงู 5 -->
                    <div class="question-block" data-question-id="q5">
                        <p class="question-prompt">
                            <span class="question-number">ูฅ</span>
                            <span class="question-title">ุญู ุงููุชุจุงููุฉ ุณ - ูฃ < ูง ูู: <span class="meta-info">ุชุทุจูู - ุฏุฑุณ ูค-ูก</span></span>
                        </p>
                        <div class="options-container">
                            <label class="option" data-correct="true"><input type="radio" name="q5"><span class="option-label"></span><span class="option-text">ุณ < ูกู</span></label>
                            <label class="option"><input type="radio" name="q5"><span class="option-label"></span><span class="option-text">ุณ > ูกู</span></label>
                            <label class="option"><input type="radio" name="q5"><span class="option-label"></span><span class="option-text">ุณ < ูค</span></label>
                            <label class="option"><input type="radio" name="q5"><span class="option-label"></span><span class="option-text">ุณ > -ูค</span></label>
                        </div>
                        <div class="explanation-content" style="display:none;">
                            ูุญู ุงููุชุจุงููุฉ ุณ - ูฃ < ูงุ ูุถูู ูฃ ููุทุฑููู:<br>ุณ < ูง + ูฃ<br><strong>ุณ < ูกู</strong>.
                        </div>
                        <button class="btn-explain" onclick="showExplanation(this)">๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</button>
                    </div>

                     <!-- ุณุคุงู 6 -->
                    <div class="question-block" data-question-id="q6">
                        <p class="question-prompt">
                            <span class="question-number">ูฆ</span>
                            <span class="question-title">ุนูุฏ ุถุฑุจ ุฃู ูุณูุฉ ุทุฑูู ุงููุชุจุงููุฉ ูู ุนุฏุฏ ุณุงูุจุ ูุฅููุง: <span class="meta-info">ุชุฐูุฑ - ุฏุฑุณ ูค-ูข</span></span>
                        </p>
                        <div class="options-container">
                            <label class="option"><input type="radio" name="q6"><span class="option-label"></span><span class="option-text">ูุจูู ุงูุฅุดุงุฑุฉ ููุง ูู</span></label>
                            <label class="option" data-correct="true"><input type="radio" name="q6"><span class="option-label"></span><span class="option-text">ูููุจ ุฅุดุงุฑุฉ ุงููุชุจุงููุฉ</span></label>
                            <label class="option"><input type="radio" name="q6"><span class="option-label"></span><span class="option-text">ูุณุงูู ุงูุทุฑููู ุจุงูุตูุฑ</span></label>
                            <label class="option"><input type="radio" name="q6"><span class="option-label"></span><span class="option-text">ูุญุฐู ุงููุชุบูุฑ</span></label>
                        </div>
                        <div class="explanation-content" style="display:none;">
                            ูุฐู ุฎุงุตูุฉ ุฃุณุงุณูุฉ ูููุชุจุงููุงุช: ุนูุฏ ุงูุถุฑุจ ุฃู ุงููุณูุฉ ุนูู ุนุฏุฏ ุณุงูุจุ ูุฌุจ <strong>ุนูุณ (ููุจ) ุฅุดุงุฑุฉ ุงููุชุจุงููุฉ</strong> (ุงูุฃูุจุฑ ูุตุจุญ ุฃุตุบุฑ ูุงูุนูุณ) ูุชุธู ุงููุชุจุงููุฉ ุตุญูุญุฉ.
                        </div>
                        <button class="btn-explain" onclick="showExplanation(this)">๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</button>
                    </div>

                    <!-- ุณุคุงู 7 -->
                    <div class="question-block" data-question-id="q7">
                        <p class="question-prompt">
                            <span class="question-number">ูง</span>
                            <span class="question-title">ุญู ุงููุชุจุงููุฉ ุงููุฑูุจุฉ (ุณ > ูฅ ู ุณ < ูข) ูู: <span class="meta-info">ููู - ุฏุฑุณ ูค-ูค</span></span>
                        </p>
                        <div class="options-container">
                            <label class="option" data-correct="true"><input type="radio" name="q7"><span class="option-label"></span><span class="option-text">ูุฌููุนุฉ ุฎุงููุฉ (โ)</span></label>
                            <label class="option"><input type="radio" name="q7"><span class="option-label"></span><span class="option-text">ูุงูู ุฎุท ุงูุฃุนุฏุงุฏ (ุญ)</span></label>
                            <label class="option"><input type="radio" name="q7"><span class="option-label"></span><span class="option-text">{ุณ | ูข < ุณ < ูฅ}</span></label>
                            <label class="option"><input type="radio" name="q7"><span class="option-label"></span><span class="option-text">{ุณ | ุณ > ูข}</span></label>
                        </div>
                        <div class="explanation-content" style="display:none;">
                            ุงูุฑุงุจุท "ู" ูุนูู ุงูุชูุงุทุน (ุงูููุทูุฉ ุงููุดุชุฑูุฉ).<br>ูุจุญุซ ุนู ุนุฏุฏ ุฃูุจุฑ ูู ูฅ ููู ููุณ ุงูููุช ุฃุตุบุฑ ูู ูข.<br>ูุง ููุฌุฏ ุนุฏุฏ ูุญูู ุงูุดุฑุทูู ูุนุงูุ ุฅุฐู ูุฌููุนุฉ ุงูุญู ูู <strong>ุงููุฌููุนุฉ ุงูุฎุงููุฉ (โ)</strong>.
                        </div>
                        <button class="btn-explain" onclick="showExplanation(this)">๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</button>
                    </div>
                </div>
            </div>
            <div class="page-footer">ุตูุญุฉ ูก ูู ูฃ</div>
        </div>

        <!-- ุงูุตูุญุฉ ุงูุซุงููุฉ -->
        <div class="page">
            <div class="page-content">
                <div class="questions-grid">

                    <!-- ุณุคุงู 8 -->
                    <div class="question-block" data-question-id="q8">
                        <p class="question-prompt">
                            <span class="question-number">ูจ</span>
                            <span class="question-title">ูุฌููุนุฉ ุญู ุงููุชุจุงููุฉ |ุณ| < -ูฃ ูู: <span class="meta-info">ุชุญููู - ุฏุฑุณ ูค-ูฅ</span></span>
                        </p>
                        <div class="options-container">
                            <label class="option"><input type="radio" name="q8"><span class="option-label"></span><span class="option-text">{ูฃ}</span></label>
                            <label class="option"><input type="radio" name="q8"><span class="option-label"></span><span class="option-text">{-ูฃ}</span></label>
                            <label class="option"><input type="radio" name="q8"><span class="option-label"></span><span class="option-text">ุญ (ุงูุฃุนุฏุงุฏ ุงูุญููููุฉ)</span></label>
                            <label class="option" data-correct="true"><input type="radio" name="q8"><span class="option-label"></span><span class="option-text">โ (ุงููุฌููุนุฉ ุงูุฎุงููุฉ)</span></label>
                        </div>
                        <div class="explanation-content" style="display:none;">
                            ุงููููุฉ ุงููุทููุฉ ูุฃู ุนุฏุฏ ูู ุฏุงุฆูุงู ููุฌุจุฉ ุฃู ุตูุฑ (โฅ 0).<br>ูุณุชุญูู ุฃู ุชููู ุงููููุฉ ุงููุทููุฉ "ุฃุตุบุฑ ูู" ุนุฏุฏ ุณุงูุจ.<br>ูุฐูู ุงูุญู ูู <strong>ุงููุฌููุนุฉ ุงูุฎุงููุฉ (โ)</strong>.
                        </div>
                        <button class="btn-explain" onclick="showExplanation(this)">๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</button>
                    </div>

                    <!-- ุณุคุงู 9 -->
                    <div class="question-block" data-question-id="q9">
                        <p class="question-prompt">
                            <span class="question-number">ูฉ</span>
                            <span class="question-title">ูุง ุงูุตูุฑุฉ ุงูููุงุณูุฉ ูููุนุงุฏูุฉ ุต + ูก = <span class="fraction"><span class="numerator">ูข</span><span class="denominator">ูฅ</span></span> (ุณ - ูข)ุ <span class="meta-info">ุชุญููู - ุฏุฑุณ ูฃ-ูข</span></span>
                        </p>
                        <div class="options-container">
                            <label class="option" data-correct="true"><input type="radio" name="q9"><span class="option-label"></span><span class="option-text">ูขุณ - ูฅุต = ูฉ</span></label>
                            <label class="option"><input type="radio" name="q9"><span class="option-label"></span><span class="option-text"><span class="fraction"><span class="numerator">ูข</span><span class="denominator">ูฅ</span></span>ุณ - ุต = <span class="fraction"><span class="numerator">ูฉ</span><span class="denominator">ูฅ</span></span></span></label>
                            <label class="option"><input type="radio" name="q9"><span class="option-label"></span><span class="option-text">-ูขุณ + ูฅุต = -ูฉ</span></label>
                            <label class="option"><input type="radio" name="q9"><span class="option-label"></span><span class="option-text">ูขุณ + ูฅุต = ูฉ</span></label>
                        </div>
                        <div class="explanation-content" style="display:none;">
                            ูก- ูุถุฑุจ ุงูุทุฑููู ูู ูฅ ููุชุฎูุต ูู ุงููุณุฑ: ูฅ(ุต+ูก) = ูข(ุณ-ูข)<br>ูข- ููู ุงูุฃููุงุณ: ูฅุต + ูฅ = ูขุณ - ูค<br>ูฃ- ูุฑุชุจ ูุชุตุจุญ ุณ ู ุต ูู ุทุฑู: -ูขุณ + ูฅุต = -ูฉ<br>ูค- ุงูุตูุฑุฉ ุงูููุงุณูุฉ ุชุชุทูุจ (ุณ) ููุฌุจุฉุ ูุถุฑุจ ูู -ูก: <strong>ูขุณ - ูฅุต = ูฉ</strong>.
                        </div>
                        <button class="btn-explain" onclick="showExplanation(this)">๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</button>
                    </div>

                    <!-- ุณุคุงู 10 -->
                    <div class="question-block" data-question-id="q10">
                        <p class="question-prompt">
                            <span class="question-number">ูกู</span>
                            <span class="question-title">ุนุฏุฏ ุญููู ูุธุงู ูุนุงุฏูุชูู ุฎุทูุชูู ููุซู ุจูุณุชููููู ูุชูุงุฒููู ูู: <span class="meta-info">ููู - ุฏุฑุณ ูฅ-ูก</span></span>
                        </p>
                        <div class="options-container">
                            <label class="option"><input type="radio" name="q10"><span class="option-label"></span><span class="option-text">ุญู ูุงุญุฏ</span></label>
                            <label class="option" data-correct="true"><input type="radio" name="q10"><span class="option-label"></span><span class="option-text">ูุง ููุฌุฏ ุญู</span></label>
                            <label class="option"><input type="radio" name="q10"><span class="option-label"></span><span class="option-text">ุนุฏุฏ ูุง ููุงุฆู ูู ุงูุญููู</span></label>
                            <label class="option"><input type="radio" name="q10"><span class="option-label"></span><span class="option-text">ุญูุงู</span></label>
                        </div>
                        <div class="explanation-content" style="display:none;">
                            ุญู ุงููุธุงู ูู ููุทุฉ ุชูุงุทุน ุงููุณุชููููู.<br>ุงููุณุชูููุงุช ุงููุชูุงุฒูุฉ ูุง ุชุชูุงุทุน ุฃุจุฏุงูุ ูุฐูู <strong>ูุง ููุฌุฏ ุญู</strong> ูููุธุงู.
                        </div>
                        <button class="btn-explain" onclick="showExplanation(this)">๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</button>
                    </div>

                    <!-- ุณุคุงู 11 -->
                    <div class="question-block" data-question-id="q11">
                        <p class="question-prompt">
                            <span class="question-number">ูกูก</span>
                            <span class="question-title">ุฃูุถู ุทุฑููุฉ ูุญู ุงููุธุงู: ูฃุณ + ูคุต = ูกูข ู ูฃุณ - ูฆุต = ูกูจ ูู: <span class="meta-info">ุชุญููู - ุฏุฑุณ ูฅ-ูฃ</span></span>
                        </p>
                        <div class="options-container">
                            <label class="option"><input type="radio" name="q11"><span class="option-label"></span><span class="option-text">ุงูุชุนููุถ</span></label>
                            <label class="option" data-correct="true"><input type="radio" name="q11"><span class="option-label"></span><span class="option-text">ุงูุญุฐู ุจุงูุทุฑุญ</span></label>
                            <label class="option"><input type="radio" name="q11"><span class="option-label"></span><span class="option-text">ุงูุชูุซูู ุงูุจูุงูู</span></label>
                            <label class="option"><input type="radio" name="q11"><span class="option-label"></span><span class="option-text">ุงูุญุฐู ุจุงูุฌูุน</span></label>
                        </div>
                        <div class="explanation-content" style="display:none;">
                            ูุงุญุธ ุฃู ูุนุงูู ุณ ูู ุงููุนุงุฏูุชูู ูู ููุณู (ูฃ).<br>ูุฐููุ ุฃุณูู ุทุฑููุฉ ููุชุฎูุต ูู ุณ ูู ุทุฑุญ ุงููุนุงุฏูุฉ ุงูุซุงููุฉ ูู ุงูุฃูููุ ุฃู <strong>ุงูุญุฐู ุจุงูุทุฑุญ</strong>.
                        </div>
                        <button class="btn-explain" onclick="showExplanation(this)">๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</button>
                    </div>

                    <!-- ุณุคุงู 12 -->
                    <div class="question-block" data-question-id="q12">
                        <p class="question-prompt">
                            <span class="question-number">ูกูข</span>
                            <span class="question-title">ูุนุงุฏูุฉ ุงููุณุชููู ุงููุงุฑ ุจุงูููุทุฉ (ูกุ ูข) ููููู ูฃ ุจุตูุบุฉ ุงูููู ูููุทุฉ: <span class="meta-info">ุชุทุจูู - ุฏุฑุณ ูฃ-ูฃ</span></span>
                        </p>
                        <div class="options-container">
                            <label class="option" data-correct="true"><input type="radio" name="q12"><span class="option-label"></span><span class="option-text">ุต - ูข = ูฃ(ุณ - ูก)</span></label>
                            <label class="option"><input type="radio" name="q12"><span class="option-label"></span><span class="option-text">ุต - ูก = ูฃ(ุณ - ูข)</span></label>
                            <label class="option"><input type="radio" name="q12"><span class="option-label"></span><span class="option-text">ุต + ูข = ูฃ(ุณ + ูก)</span></label>
                            <label class="option"><input type="radio" name="q12"><span class="option-label"></span><span class="option-text">ุต = ูฃุณ + ูก</span></label>
                        </div>
                        <div class="explanation-content" style="display:none;">
                            ุตูุบุฉ ุงูููู ูููุทุฉ ูู: ุต - ุตูก = ู(ุณ - ุณูก).<br>ูุนูุถ ุจู ู = ูฃุ ุณูก = ูกุ ุตูก = ูข.<br>ุชุตุจุญ: <strong>ุต - ูข = ูฃ(ุณ - ูก)</strong>.
                        </div>
                        <button class="btn-explain" onclick="showExplanation(this)">๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</button>
                    </div>
                    
                    <!-- ุณุคุงู 13 -->
                    <div class="question-block" data-question-id="q13">
                        <p class="question-prompt">
                            <span class="question-number">ูกูฃ</span>
                            <span class="question-title">ุฅุฐุง ูุงูุช ุณ = ูฃุต + ูก ุ ูขุณ + ุต = ูฉ ุ ูุฅู ูููุฉ ุต ุชุณุงูู: <span class="meta-info">ุชุทุจูู - ุฏุฑุณ ูฅ-ูข</span></span>
                        </p>
                        <div class="options-container">
                            <label class="option" data-correct="true"><input type="radio" name="q13"><span class="option-label"></span><span class="option-text">ูก</span></label>
                            <label class="option"><input type="radio" name="q13"><span class="option-label"></span><span class="option-text">ูข</span></label>
                            <label class="option"><input type="radio" name="q13"><span class="option-label"></span><span class="option-text">ูฃ</span></label>
                            <label class="option"><input type="radio" name="q13"><span class="option-label"></span><span class="option-text">ูค</span></label>
                        </div>
                        <div class="explanation-content" style="display:none;">
                            ูุณุชุฎุฏู ุงูุชุนููุถ: ูุนูุถ ุจูููุฉ ุณ ูู ุงูุฃููู ูู ุงูุซุงููุฉ.<br>ูข(ูฃุต + ูก) + ุต = ูฉ<br>ูฆุต + ูข + ุต = ูฉ<br>ูงุต = ูง โ ุฅุฐู <strong>ุต = ูก</strong>.
                        </div>
                        <button class="btn-explain" onclick="showExplanation(this)">๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</button>
                    </div>

                    <!-- ุณุคุงู 14 -->
                    <div class="question-block" data-question-id="q14">
                        <p class="question-prompt">
                            <span class="question-number">ูกูค</span>
                            <span class="question-title">ุงููุชุจุงููุฉ ุงูุชู ุชูุซู ุงูุนุจุงุฑุฉ "ุนุฏุฏ ุฒุงุฆุฏ ูค ูุง ููู ุนู ูกู": <span class="meta-info">ููู - ุฏุฑุณ ูค-ูก</span></span>
                        </p>
                        <div class="options-container">
                            <label class="option" data-correct="true"><input type="radio" name="q14"><span class="option-label"></span><span class="option-text">ุณ + ูค โฅ ูกู</span></label>
                            <label class="option"><input type="radio" name="q14"><span class="option-label"></span><span class="option-text">ุณ + ูค โค ูกู</span></label>
                            <label class="option"><input type="radio" name="q14"><span class="option-label"></span><span class="option-text">ุณ + ูค > ูกู</span></label>
                            <label class="option"><input type="radio" name="q14"><span class="option-label"></span><span class="option-text">ุณ + ูค < ูกู</span></label>
                        </div>
                        <div class="explanation-content" style="display:none;">
                            ุงูุนุจุงุฑุฉ "ูุง ููู ุนู" ุชุนูู ุฃูู ูููู ุฃู ูููู ูุณุงููุงู ุฃู ุฃูุจุฑ.<br>ุงูุฑูุฒ ุงูุฑูุงุถู ุงูููุงุณุจ ูู (ุฃูุจุฑ ูู ุฃู ูุณุงูู โฅ).<br>ุฅุฐู: <strong>ุณ + ูค โฅ ูกู</strong>.
                        </div>
                        <button class="btn-explain" onclick="showExplanation(this)">๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</button>
                    </div>
                     <!-- ุณุคุงู 15 -->
                     <div class="question-block" data-question-id="q15">
                        <p class="question-prompt">
                            <span class="question-number">ูกูฅ</span>
                            <span class="question-title">ุนูุฏ ุญู ุงููุนุงุฏูุฉ |ุณ + ูข| = ูฅุ ูุฅู ููู ุณ ูู: <span class="meta-info">ุชุทุจูู - ุฏุฑุณ ูค-ูฅ</span></span>
                        </p>
                        <div class="options-container">
                            <label class="option"><input type="radio" name="q15"><span class="option-label"></span><span class="option-text">ูฃุ ูง</span></label>
                            <label class="option" data-correct="true"><input type="radio" name="q15"><span class="option-label"></span><span class="option-text">ูฃุ -ูง</span></label>
                            <label class="option"><input type="radio" name="q15"><span class="option-label"></span><span class="option-text">-ูฃุ ูง</span></label>
                            <label class="option"><input type="radio" name="q15"><span class="option-label"></span><span class="option-text">-ูฃุ -ูง</span></label>
                        </div>
                        <div class="explanation-content" style="display:none;">
                            ูุนุงุฏูุฉ ุงููููุฉ ุงููุทููุฉ ุชุนูู ุญุงูุชูู:<br>ูก) ุณ + ูข = ูฅ โ ุณ = ูฃ<br>ูข) ุณ + ูข = -ูฅ โ ุณ = -ูง<br>ุฅุฐู ุงูุญู ูู: <strong>ูฃุ -ูง</strong>.
                        </div>
                        <button class="btn-explain" onclick="showExplanation(this)">๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</button>
                    </div>
                </div>
            </div>
            <div class="page-footer">ุตูุญุฉ ูข ูู ูฃ</div>
        </div>

        <!-- ุงูุตูุญุฉ ุงูุซุงูุซุฉ -->
        <div class="page">
            <div class="page-content">
                <h2 class="section-title">ุงูุฃุณุฆูุฉ ุงูููุงููุฉ (ุงูุชูููู ุงูุฐุงุชู - ูฅ ุฏุฑุฌุงุช)</h2>
                
                <div class="essay-questions-container">
                    <!-- ุณุคุงู ููุงูู 1 -->
                    <div class="essay-question-block" id="essay-block-q16">
                        <p class="question-prompt">
                            <span class="question-number">ูกูฆ</span>
                            <span class="question-title">ุณุคุงู ููุธู: ุงุดุชุฑู ุทุงูุจ ููููู ููฃ ุฏูุงุชุฑ ุจูุจูุบ ูกูฃ ุฑูุงูุงู. ุฅุฐุง ูุงู ุณุนุฑ ููููู ูุฏูุชุฑ ูุงุญุฏ ูู ูง ุฑูุงูุงุชุ ููุง ุณุนุฑ ุงูููู ูุณุนุฑ ุงูุฏูุชุฑุ (ุฏุฑุฌุชุงู) 
                                <span class="meta-info">ุชุทุจูู - ุฏุฑุณ ูฅ-ูค</span>
                            </span>
                        </p>
                        <textarea class="answer-space" id="q16-answer" placeholder="ุงูุชุจ ูุธุงู ุงููุนุงุฏูุงุช ูุญููู ููุง..."></textarea>
                        
                        <!-- ููุทูุฉ ุงูุชูููู ุงูุฐุงุชู ูุฎููุฉ -->
                        <div class="self-grading-section" id="q16-grading">
                            <div class="model-answer-box">
                                <span class="model-answer-title">ุงูุฅุฌุงุจุฉ ุงููููุฐุฌูุฉ:</span>
                                1) ููุฑุถ ุงูููู (ู) ูุงูุฏูุชุฑ (ุฏ).<br>
                                2) ุงููุนุงุฏูุฉ ุงูุฃููู: 2ู + 3ุฏ = 13<br>
                                3) ุงููุนุงุฏูุฉ ุงูุซุงููุฉ: 2ู + ุฏ = 7<br>
                                4) ุจุทุฑุญ ุงูุซุงููุฉ ูู ุงูุฃููู: 2ุฏ = 6 โ ุฅุฐู ุณุนุฑ ุงูุฏูุชุฑ (ุฏ) = 3 ุฑูุงูุงุช.<br>
                                5) ุจุงูุชุนููุถ: 2ู + 3 = 7 โ 2ู = 4 โ ุณุนุฑ ุงูููู (ู) = 2 ุฑูุงู.
                            </div>
                            <div class="grading-input-box">
                                <label for="q16-score">ูู ุชุนุทู ููุณู ูู 2ุ</label>
                                <input type="text" inputmode="decimal" id="q16-score" placeholder="0">
                                <span class="grading-note">(ุงูุฏุฑุฌุฉ ุงููุตูู: 2)</span>
                            </div>
                        </div>
                        
                        <!-- ุฅุถุงูุฉ ุงูุดุฑุญ ููููุงูู (ูุณุฎุฉ ูู ุงููููุฐุฌ) -->
                        <div class="explanation-content" style="display:none;">
                             <strong>ุฎุทูุงุช ุงูุญู:</strong><br>
                                1) ููุฑุถ ุงูููู (ู) ูุงูุฏูุชุฑ (ุฏ).<br>
                                2) ูููู ุงููุนุงุฏูุชูู: 2ู + 3ุฏ = 13 ู 2ู + ุฏ = 7<br>
                                3) ูุณุชุฎุฏู ุงูุญุฐู ุจุงูุทุฑุญ (ูุฃู 2ู ููุฌูุฏุฉ ูู ุงูุทุฑููู).<br>
                                4) ููุชุฌ 2ุฏ = 6ุ ุจุงููุณูุฉ ุนูู 2ุ ุณุนุฑ ุงูุฏูุชุฑ = 3.<br>
                                5) ูุนูุถ ูู ุฃู ูุนุงุฏูุฉ ูุฅูุฌุงุฏ ุณุนุฑ ุงูููู = 2.
                        </div>
                        <button class="btn-explain" onclick="showExplanation(this)">๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</button>
                    </div>
                    
                    <!-- ุณุคุงู ููุงูู 2 -->
                    <div class="essay-question-block" id="essay-block-q17">
                        <p class="question-prompt">
                            <span class="question-number">ูกูง</span>
                            <span class="question-title">ุญู ูุชุจุงููุฉ ุงููููุฉ ุงููุทููุฉ ุงูุชุงููุฉ ููุซู ุงูุญู: |ุณ - ูฃ| โค ูข (ุฏุฑุฌุฉ ููุตู) 
                                <span class="meta-info">ุชุทุจูู - ุฏุฑุณ ูค-ูฅ</span>
                            </span>
                        </p>
                        <textarea class="answer-space" id="q17-answer" placeholder="ุงูุชุจ ุฎุทูุงุช ุงูุญู..."></textarea>
                        
                        <!-- ููุทูุฉ ุงูุชูููู ุงูุฐุงุชู ูุฎููุฉ -->
                        <div class="self-grading-section" id="q17-grading">
                            <div class="model-answer-box">
                                <span class="model-answer-title">ุงูุฅุฌุงุจุฉ ุงููููุฐุฌูุฉ:</span>
                                1) ุจูุง ุฃู ุงูุนูุงูุฉ (โค) ููุชุจูุง ูุชุจุงููุฉ ูุฑูุจุฉ ุจู "ู".<br>
                                2) -2 โค ุณ - 3 โค 2<br>
                                3) ูุถูู 3 ููู ุงูุฃุทุฑุงู: 1 โค ุณ โค 5<br>
                                4) ูุฌููุนุฉ ุงูุญู: {ุณ | 1 โค ุณ โค 5}
                            </div>
                            <div class="grading-input-box">
                                <label for="q17-score">ูู ุชุนุทู ููุณู ูู 1.5ุ</label>
                                <input type="text" inputmode="decimal" id="q17-score" placeholder="0">
                                <span class="grading-note">(ุงูุฏุฑุฌุฉ ุงููุตูู: 1.5)</span>
                            </div>
                        </div>
                        <div class="explanation-content" style="display:none;">
                            <strong>ููุชุงุญ ุงูุญู:</strong><br>
                            ุฅุฐุง ูุงูุช ุงููููุฉ ุงููุทููุฉ ุฃุตุบุฑ ูู ุฃู ูุณุงูู (โค)ุ ูุฅู ุงูุญู ููุน "ุจูู" ุงููููุชูู ุงูุณุงูุจุฉ ูุงูููุฌุจุฉ.<br>
                            ูุถุน ุงูููุฏุงุฑ (ุณ-3) ูุญุตูุฑุงู ุจูู -2 ู 2.<br>
                            ูุชุฎูุต ูู -3 ุจุฅุถุงูุฉ +3 ูุฌููุน ุงูุฃุทุฑุงูุ ููุญุตู ุนูู ุงููุชูุฌุฉ ุงูููุงุฆูุฉ.
                        </div>
                        <button class="btn-explain" onclick="showExplanation(this)">๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</button>
                    </div>
                    
                    <!-- ุณุคุงู ููุงูู 3 -->
                    <div class="essay-question-block" id="essay-block-q18">
                        <p class="question-prompt">
                            <span class="question-number">ูกูจ</span>
                            <span class="question-title">ุงูุชุจ ุจุตูุบุฉ ุงูููู ูุงูููุทุน ูุนุงุฏูุฉ ุงููุณุชููู ุงููุงุฑ ุจุงูููุทุฉ (ูฃุ ูค) ูููุงุฒู ุงููุณุชููู ุต = ูขุณ - ูฅ. (ุฏุฑุฌุฉ ููุตู)
                                <span class="meta-info">ุชุญููู - ุฏุฑุณ ูฃ-ูค</span>
                            </span>
                        </p>
                        <textarea class="answer-space" id="q18-answer" placeholder="ุงูุชุจ ุฎุทูุงุช ุงูุญู ูุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ..."></textarea>
                        
                         <!-- ููุทูุฉ ุงูุชูููู ุงูุฐุงุชู ูุฎููุฉ -->
                         <div class="self-grading-section" id="q18-grading">
                            <div class="model-answer-box">
                                <span class="model-answer-title">ุงูุฅุฌุงุจุฉ ุงููููุฐุฌูุฉ:</span>
                                1) ุจูุง ุฃู ุงููุณุชููู ููุงุฒูุ ุฅุฐู ุงูููู = 2.<br>
                                2) ูุณุชุฎุฏู ุตูุบุฉ ุงูููู ูุงูููุทุน: ุต = ู ุณ + ุจ<br>
                                3) ูุนูุถ ุจุงูููุทุฉ (3ุ 4): 4 = 2(3) + ุจ โ 4 = 6 + ุจ<br>
                                4) ูุทุฑุญ 6 ูู ุงูุทุฑููู: ุจ = -2<br>
                                5) ุงููุนุงุฏูุฉ ุงูููุงุฆูุฉ: ุต = 2ุณ - 2
                            </div>
                            <div class="grading-input-box">
                                <label for="q18-score">ูู ุชุนุทู ููุณู ูู 1.5ุ</label>
                                <input type="text" inputmode="decimal" id="q18-score" placeholder="0">
                                <span class="grading-note">(ุงูุฏุฑุฌุฉ ุงููุตูู: 1.5)</span>
                            </div>
                        </div>
                        <div class="explanation-content" style="display:none;">
                             <strong>ุงูุฎุทูุงุช:</strong><br>
                            1- ุดุฑุท ุงูุชูุงุฒู ูุนูู ููุณ ุงููููุ ุฅุฐู ู = 2.<br>
                            2- ููุชุจ ุงููุนุงุฏูุฉ ุงูุนุงูุฉ ุต = 2ุณ + ุจ.<br>
                            3- ูุฅูุฌุงุฏ (ุจ)ุ ูุนูุถ ุจุงูููุทุฉ ุงููุนุทุงุฉ (3ุ 4) ูู ุงููุนุงุฏูุฉ ููุงู ุณ ูุต.<br>
                            4- ูุญู ุงููุนุงุฏูุฉ ูุฅูุฌุงุฏ ุจุ ุซู ููุชุจ ุงูุดูู ุงูููุงุฆู.
                        </div>
                        <button class="btn-explain" onclick="showExplanation(this)">๐ก ููุงุฐุง ูุฐู ุงูุฅุฌุงุจุฉุ</button>
                    </div>
                </div>

            </div>
            <div class="page-footer">ุตูุญุฉ ูฃ ูู ูฃ</div>
        </div>
    </div>

    <script>
        // Global variables
        let studentName = '', studentClass = '', startTime, attemptCount = 1;
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzrf1-At3Pq7i39bGV3F1iD3-b0G-WWyRi5cgpKeQjyn_N5fh2EmGhoyRKUsbLd-F_UJQ/exec";
        let mcqScore = 0; // Store MCQ score globally after grading

        document.addEventListener('DOMContentLoaded', () => {
            const savedStudent = localStorage.getItem('currentStudent');
            if (savedStudent) {
                startTest(JSON.parse(savedStudent));
            }
        });

        async function loginWithId() {
            const studentId = document.getElementById('student-id-input').value.trim();
            const classId = document.getElementById('student-class-input').value;
            const statusElement = document.getElementById('login-status');
            
            if (!studentId || !classId) {
                statusElement.textContent = 'ูุฑุฌู ุฅุฏุฎุงู ุฑูู ุงููููุฉ ูุงุฎุชูุงุฑ ุงูุตู.';
                return;
            }
            statusElement.textContent = 'ุฌุงุฑู ุงูุชุญูู ูู ุงูุจูุงูุงุช...';
            
            const url = `${SCRIPT_URL}?action=getStudentData&studentId=${studentId}&classId=${classId}`;
            try {
                const response = await fetch(url);
                const result = await response.json();
                if (result.status === 'success' && result.data) {
                    localStorage.setItem('currentStudent', JSON.stringify(result.data));
                    startTest(result.data);
                } else {
                    throw new Error(result.message || 'ุฑูู ุงููููุฉ ุฃู ุงูุตู ุบูุฑ ุตุญูุญ.');
                }
            } catch (error) {
                console.error("Fetch Student Error:", error);
                statusElement.textContent = `ุฎุทุฃ: ${error.message}`;
            }
        }

        function startTest(student) {
            studentName = student.name;
            studentClass = student.class;
            document.getElementById('login-modal').style.display = 'none';
            document.getElementById('test-container').style.display = 'block';
            document.querySelector('.controls').style.display = 'flex';
            let storedAttempts = localStorage.getItem('mathTestAttempts_U2');
            attemptCount = storedAttempts ? parseInt(storedAttempts) + 1 : 1;
            localStorage.setItem('mathTestAttempts_U2', attemptCount);
            document.getElementById('display-student-name').textContent = studentName;
            document.getElementById('display-student-class').textContent = studentClass;
            const today = new Date();
            const hijriDate = new Intl.DateTimeFormat('ar-SA-u-ca-islamic-nu-arab', { day: 'numeric', month: 'long', year: 'numeric' }).format(today);
            document.getElementById('display-test-date').textContent = hijriDate;
            startTime = Date.now();
            shuffleOptions();
        }

        function shuffleOptions() {
            const questions = document.querySelectorAll('.question-block[data-question-id]');
            const optionLabels = ['ุฃ', 'ุจ', 'ุฌ', 'ุฏ'];
            questions.forEach(question => {
                const container = question.querySelector('.options-container');
                if (container) {
                    const options = Array.from(container.children);
                    for (let i = options.length - 1; i > 0; i--) {
                        const j = Math.floor(Math.random() * (i + 1));
                        [options[i], options[j]] = [options[j], options[i]];
                    }
                    container.innerHTML = '';
                    options.forEach((option, index) => {
                        option.querySelector('.option-label').textContent = optionLabels[index];
                        container.appendChild(option);
                    });
                }
            });
        }
        
        function startSelfGrading() {
            if (!studentName || !studentClass) { console.error('Student data not found.'); return; }
            
            mcqScore = 0;
            const questions = document.querySelectorAll('.question-block[data-question-id]');
            document.querySelectorAll('.option').forEach(label => {
                label.classList.remove('correct', 'incorrect');
            });
            
            questions.forEach(question => {
                const questionId = question.dataset.questionId;
                const userAnswerNode = document.querySelector(`input[name="${questionId}"]:checked`);
                const correctAnswerNode = question.querySelector('.option[data-correct="true"]');
                
                if (correctAnswerNode) correctAnswerNode.classList.add('correct');
                
                if (userAnswerNode) {
                    const selectedLabel = userAnswerNode.parentElement;
                    if (selectedLabel.dataset.correct) {
                        mcqScore++;
                    } else {
                        selectedLabel.classList.add('incorrect');
                    }
                }
                
                const radios = question.querySelectorAll('input[type="radio"]');
                radios.forEach(r => r.disabled = true);
            });

            // Show Self Grading Sections
            document.querySelectorAll('.self-grading-section').forEach(div => {
                div.style.display = 'block';
            });
            
            // Show Explain Buttons
            document.querySelectorAll('.btn-explain').forEach(btn => {
                btn.style.display = 'inline-block';
            });

            document.querySelectorAll('.answer-space').forEach(txt => {
                txt.readOnly = true;
                txt.style.backgroundColor = "#e9e9e9";
            });

            document.getElementById('start-grading-btn').style.display = 'none';
            document.getElementById('submit-final-btn').style.display = 'block';
            
            // Show the instruction modal instead of alert
            document.getElementById('instruction-modal').style.display = 'flex';
        }

        // --- Explain Modal Functions ---
        function showExplanation(btn) {
            // The explanation content is the sibling with class 'explanation-content'
            // We traverse up to parent then find the div
            const parent = btn.parentElement;
            const content = parent.querySelector('.explanation-content').innerHTML;
            
            document.getElementById('explanation-text').innerHTML = content;
            document.getElementById('explanation-modal').style.display = 'flex';
        }

        function closeExplanation() {
            document.getElementById('explanation-modal').style.display = 'none';
        }
        
        // --- Close Instruction Modal ---
        function closeInstructionModal() {
            document.getElementById('instruction-modal').style.display = 'none';
            document.getElementById('essay-block-q16').scrollIntoView({behavior: "smooth"});
        }

        // --- Helper function to parse Arabic/English numbers ---
        function parseLocalNum(str) {
            if (!str) return NaN;
            var ar = 'ููกูขูฃูคูฅูฆูงูจูฉ';
            var en = '0123456789';
            var res = '';
            for (var i = 0; i < str.length; i++) {
                var c = str[i];
                var idx = ar.indexOf(c);
                if (idx >= 0) res += en[idx];
                else res += c;
            }
            res = res.replace(/,/g, '.');
            return parseFloat(res);
        }

        // 2. ูุธููุฉ ุงุนุชูุงุฏ ุงูุฏุฑุฌุฉ ุงูููุงุฆูุฉ (Robust Version)
        function submitFinalGrade() {
            try {
                const score16Input = document.getElementById('q16-score');
                const score17Input = document.getElementById('q17-score');
                const score18Input = document.getElementById('q18-score');

                score16Input.style.border = '2px solid #007bff';
                score17Input.style.border = '2px solid #007bff';
                score18Input.style.border = '2px solid #007bff';

                let s16 = parseLocalNum(score16Input.value);
                let s17 = parseLocalNum(score17Input.value);
                let s18 = parseLocalNum(score18Input.value);

                if (isNaN(s16)) {
                    alert("ูุฑุฌู ุฅุฏุฎุงู ุฏุฑุฌุฉ ุงูุณุคุงู ูกูฆ (ุถุน 0 ุฅุฐุง ูุงูุช ุฎุทุฃ).");
                    score16Input.style.border = '2px solid red';
                    score16Input.scrollIntoView({behavior: 'smooth', block: 'center'});
                    score16Input.focus();
                    return;
                }
                if (isNaN(s17)) {
                    alert("ูุฑุฌู ุฅุฏุฎุงู ุฏุฑุฌุฉ ุงูุณุคุงู ูกูง (ุถุน 0 ุฅุฐุง ูุงูุช ุฎุทุฃ).");
                    score17Input.style.border = '2px solid red';
                    score17Input.scrollIntoView({behavior: 'smooth', block: 'center'});
                    score17Input.focus();
                    return;
                }
                if (isNaN(s18)) {
                    alert("ูุฑุฌู ุฅุฏุฎุงู ุฏุฑุฌุฉ ุงูุณุคุงู ูกูจ (ุถุน 0 ุฅุฐุง ูุงูุช ุฎุทุฃ).");
                    score18Input.style.border = '2px solid red';
                    score18Input.scrollIntoView({behavior: 'smooth', block: 'center'});
                    score18Input.focus();
                    return;
                }

                if (s16 > 2 || s16 < 0) { 
                    alert("ุฏุฑุฌุฉ ุงูุณุคุงู 16 ูุฌุจ ุฃู ุชููู ุจูู 0 ู 2"); 
                    score16Input.style.border = '2px solid red';
                    score16Input.focus(); 
                    return; 
                }
                if (s17 > 1.5 || s17 < 0) { 
                    alert("ุฏุฑุฌุฉ ุงูุณุคุงู 17 ูุฌุจ ุฃู ุชููู ุจูู 0 ู 1.5"); 
                    score17Input.style.border = '2px solid red';
                    score17Input.focus(); 
                    return; 
                }
                if (s18 > 1.5 || s18 < 0) { 
                    alert("ุฏุฑุฌุฉ ุงูุณุคุงู 18 ูุฌุจ ุฃู ุชููู ุจูู 0 ู 1.5"); 
                    score18Input.style.border = '2px solid red';
                    score18Input.focus(); 
                    return; 
                }

                const essayTotal = s16 + s17 + s18;
                const finalMcq = (typeof mcqScore === 'number') ? mcqScore : 0;
                const finalScore = finalMcq + essayTotal;
                
                let duration = 'ุบูุฑ ูุญุฏุฏ';
                if (startTime) {
                    duration = Math.floor((Date.now() - startTime) / 60000) + ' ุฏูููุฉ';
                }

                document.getElementById('result-student-name').textContent = studentName || '---';
                document.getElementById('result-student-class').textContent = studentClass || '---';
                document.getElementById('result-duration').textContent = duration;
                document.getElementById('result-mcq-score').textContent = `${finalMcq} / 15`;
                document.getElementById('result-essay-score').textContent = `${essayTotal} / 5`;
                document.getElementById('result-total-score').textContent = `${finalScore} / 20`;

                document.getElementById('result-modal').style.display = 'flex';
                document.getElementById('submit-final-btn').style.display = 'none';
                
                // Show view result and retry buttons
                document.getElementById('show-result-btn').style.display = 'block';
                document.getElementById('retry-btn-main').style.display = 'block';

            } catch (e) {
                alert("ุนุฐุฑุงูุ ุญุฏุซ ุฎุทุฃ ุชููู ุบูุฑ ูุชููุน: " + e.message);
                console.error(e);
            }
        }
        
        function sendToWhatsApp() {
            const teacherPhone = "966532763225"; 
            const name = document.getElementById('result-student-name').textContent;
            const className = document.getElementById('result-student-class').textContent;
            const finalScore = document.getElementById('result-total-score').textContent;
            const message = `ุงูุณูุงู ุนูููู ูุฑุญูุฉ ุงูููุ\n\nุฅููู ูุชูุฌุฉ ุงุฎุชุจุงุฑ ุงูุทุงูุจ:\n\n๐ค ุงูุงุณู: ${name}\n๐ซ ุงูุตู: ${className}\n๐ ุงูุฏุฑุฌุฉ ุงูููุงุฆูุฉ: ${finalScore}\n\nุดูุฑุงู ูู.`;
            const encodedMessage = encodeURIComponent(message);
            const whatsappUrl = `https://wa.me/${teacherPhone}?text=${encodedMessage}`;
            window.open(whatsappUrl, '_blank');
        }

        function reviewAnswers() { document.getElementById('result-modal').style.display = 'none'; }
        
        function showResultModal() { document.getElementById('result-modal').style.display = 'flex'; }

        function retryTest() {
            location.reload(); 
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('explanation-modal');
            const instructionModal = document.getElementById('instruction-modal');
            if (event.target == modal) {
                modal.style.display = "none";
            }
            // Optional: Close instruction modal if clicked outside, though better to force button click
            if (event.target == instructionModal) {
               // instructionModal.style.display = "none";
            }
        }
    </script>
</body>
</html>
