<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงูุฏุฑุณ ูค-ูฅ: ุญู ูุชุจุงููุงุช ุงููููุฉ ุงููุทููุฉ | ููุตุฉ ุงูุฑูุงุถูุงุช ุงูุชูุงุนููุฉ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* ููุณ ุงูุฃููุงุท ุงูุชู ูุฏูุชูุงุ ูุน ุชุนุฏููุงุช ุทูููุฉ ุฅุฐุง ูุฒู ุงูุฃูุฑ */
        body { font-family: 'Cairo', sans-serif; }
        .hidden { display: none; }
        .step-box { border-right: 4px solid #1d4ed8; }
        .vocab-term { background-color: #ffefc5; padding: 2px 6px; border-radius: 4px; font-weight: bold; }
        .vocab-term-alt { background-color: #dbeafe; padding: 2px 6px; border-radius: 4px; font-weight: bold; }
        .option-label { display: block; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; cursor: pointer; transition: all 0.2s ease-in-out; min-height: 80px; display: flex; align-items: center; justify-content: center; }
        .option-label:hover { border-color: #3b82f6; background-color: #eff6ff; }
        input[type="radio"]:checked + .option-label { border-color: #2563eb; background-color: #dbeafe; box-shadow: 0 0 0 2px #bfdbfe; }
        input[type="radio"] { display: none; }
        .feedback-correct { color: #16a34a; }
        .feedback-incorrect { color: #dc2626; }
        .highlight-number { background-color: #fef9c3; border: 1px solid #fde047; color: #b45309; font-weight: bold; padding: 0 5px; border-radius: 4px; }
        .math-eq { font-family: "Courier New", monospace; font-size: 1.1rem; font-weight: bold; color: #4338ca; background-color: #f3f4f6; border: 1px solid #d1d5db; padding: 2px 8px; border-radius: 6px; display: inline-block; vertical-align: middle; }
        .math-eq .highlight-number { padding: 0; border: none; }
        .fraction { display: inline-flex; flex-direction: column; text-align: center; vertical-align: middle; margin: 0 0.2em; }
        .fraction > span { display: block; padding: 0 0.4em; }
        .fraction > .frac-bar { border-top: 2px solid #4338ca; }
        .step-interactive { display: none; opacity: 0; transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out; transform: translateY(10px); }
        .step-interactive.active { display: block; opacity: 1; transform: translateY(0); }
        .number-line-wrapper { margin-top: 1rem; padding: 1rem 0; }
        .number-line { position: relative; width: 100%; height: 2px; background-color: #374151; }
        .number-line::before, .number-line::after { content: ''; position: absolute; top: 50%; transform: translateY(-50%); width: 0; height: 0; border-style: solid; }
        .number-line::before { left: -1px; border-width: 6px 8px 6px 0; border-color: transparent #374151 transparent transparent; }
        .number-line::after { right: -1px; border-width: 6px 0 6px 8px; border-color: transparent transparent transparent #374151; }
        .ticks-container { position: relative; width: 100%; height: 2rem; }
        .tick { position: absolute; bottom: 0; transform: translateX(-50%); display: flex; flex-direction: column; align-items: center; font-size: 0.875rem; }
        .tick::before { content: ''; width: 2px; height: 8px; background-color: #374151; margin-bottom: 4px; }
        .solution-line { position: absolute; top: 50%; transform: translateY(-50%); height: 4px; background-color: #2563eb; }
        .solution-point { position: absolute; top: 50%; transform: translate(-50%, -50%); width: 12px; height: 12px; border-radius: 9999px; border: 2px solid #2563eb; }
        .solution-point.open { background-color: #fff; }
        .solution-point.closed { background-color: #2563eb; }

        /* Styles for number lines inside quiz options */
        .option-nl-wrapper { width: 100%; padding: 1rem 0.5rem; }
        .option-nl-ticks { position: relative; width: 100%; height: 1.5rem; }
        .option-nl-line { position: relative; width: 100%; height: 2px; background-color: #374151; }
        .option-nl-line::before, .option-nl-line::after { content: ''; position: absolute; top: 50%; transform: translateY(-50%); width: 0; height: 0; border-style: solid; }
        .option-nl-line::before { left: -1px; border-width: 4px 6px 4px 0; border-color: transparent #374151 transparent transparent; }
        .option-nl-line::after { right: -1px; border-width: 4px 0 4px 6px; border-color: transparent transparent transparent #374151; }
        .option-nl-tick { position: absolute; bottom: 0; transform: translateX(-50%); display: flex; flex-direction: column; align-items: center; font-size: 0.75rem; color: #4b5563; }
        .option-nl-tick::before { content: ''; width: 1px; height: 5px; background-color: #4b5563; margin-bottom: 2px; }
        .option-nl-sol-line { position: absolute; top: 50%; transform: translateY(-50%); height: 3px; background-color: #3b82f6; }
        .option-nl-sol-point { position: absolute; top: 50%; transform: translate(-50%, -50%); width: 10px; height: 10px; border-radius: 9999px; border: 2px solid #3b82f6; }
        .option-nl-sol-point.open { background-color: #fff; }
        .option-nl-sol-point.closed { background-color: #3b82f6; }
        
        /* New styles for sentence translation */
        .translation-box { display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; padding: 1rem; background-color: #eef2ff; border-radius: 8px; }
        .translation-part { display: flex; flex-direction: column; align-items: center; }
        .translation-part .word { font-size: 0.875rem; color: #4b5563; padding: 0 8px; }
        .translation-part .symbol { font-weight: bold; font-size: 1.25rem; color: #4338ca; background-color: white; padding: 4px 12px; border: 1px solid #c7d2fe; border-radius: 6px; min-width: 40px; text-align: center;}

    </style>
</head>
<body class="bg-gray-100">
    <div id="app-container" class="grid grid-template-rows: auto 1fr auto; min-height: 100vh;">
        <header id="main-header" class="bg-white shadow-md sticky top-0 z-50"></header>
        <main class="container mx-auto max-w-4xl my-8">
            <div class="p-6 bg-white rounded-xl shadow-lg">
                <header class="flex justify-between items-center mb-8 border-b pb-4 border-gray-200">
                    <h1 id="lesson-title" class="text-3xl font-bold text-green-800">ุงูุฏุฑุณ ูค-ูฅ: ุญู ูุชุจุงููุงุช ุงููููุฉ ุงููุทููุฉ</h1>
                    <!-- The old link was here and has been removed -->
                </header>

                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">๐ก ุฃููุงู: ุงูููููู ุงูุฃุณุงุณู</h2>
                    <div class="p-6 bg-green-50 rounded-lg space-y-6">
                        <div>
                            <h3 class="text-xl font-semibold text-green-700 mb-2">ูุชุจุงููุงุช ุงููููุฉ ุงููุทููุฉ (ุฃุตุบุฑ ูู)</h3>
                            <p class="text-gray-700">ุงููุชุจุงููุฉ ุนูู ุงูุตูุฑุฉ <span class="math-eq">|ุณ| < ุจ</span> ุชุนูู ุฃู ุงููุณุงูุฉ ุจูู <span class="vocab-term-alt">ุณ</span> ูุงูุตูุฑ ุฃูู ูู <span class="vocab-term-alt">ุจ</span>. ูููู ุญููุง ุจุชุญููููุง ุฅูู ูุชุจุงููุฉ ูุฑูุจุฉ ุจุฃุฏุงุฉ ุงูุฑุจุท <span class="font-bold">"ู"</span>.</p>
                            <div class="mt-4 p-4 bg-white rounded-lg border text-center">
                                <p>ุงููุชุจุงููุฉ: <span class="math-eq">|ุฃ| < ุจ</span></p>
                                <p>ุชูุงูุฆ: <span class="math-eq">-ุจ < ุฃ < ุจ</span></p>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold text-blue-700 mb-2">ูุชุจุงููุงุช ุงููููุฉ ุงููุทููุฉ (ุฃูุจุฑ ูู)</h3>
                            <p class="text-gray-700">ุงููุชุจุงููุฉ ุนูู ุงูุตูุฑุฉ <span class="math-eq">|ุณ| > ุจ</span> ุชุนูู ุฃู ุงููุณุงูุฉ ุจูู <span class="vocab-term-alt">ุณ</span> ูุงูุตูุฑ ุฃูุจุฑ ูู <span class="vocab-term-alt">ุจ</span>. ูููู ุญููุง ุจุชุญููููุง ุฅูู ูุชุจุงููุฉ ูุฑูุจุฉ ุจุฃุฏุงุฉ ุงูุฑุจุท <span class="font-bold">"ุฃู"</span>.</p>
                             <div class="mt-4 p-4 bg-white rounded-lg border text-center">
                                <p>ุงููุชุจุงููุฉ: <span class="math-eq">|ุฃ| > ุจ</span></p>
                                <p>ุชูุงูุฆ: <span class="math-eq">ุฃ > ุจ</span> ุฃู <span class="math-eq">ุฃ < -ุจ</span></p>
                            </div>
                        </div>
                        <!-- ูุณู ุงูุญุงูุงุช ุงูุฎุงุตุฉ ุงููุถุงู -->
                        <div class="p-4 bg-yellow-100 rounded-lg border-l-4 border-yellow-500">
                             <h3 class="text-xl font-semibold text-yellow-800 mb-3">โ๏ธ ููุงุญุธุงุช ูุงูุฉ: ุญุงูุงุช ุฎุงุตุฉ</h3>
                             <div class="space-y-4">
                                 <div>
                                     <h4 class="font-bold text-red-700">ูก. ูุง ููุฌุฏ ุญู (ุงููุฌููุนุฉ ุงูุฎุงููุฉ โ)</h4>
                                     <p class="text-gray-700">ุชุญุฏุซ ูุฐู ุงูุญุงูุฉ ุนูุฏูุง ุชููู ุงููููุฉ ุงููุทููุฉ (ููู ุฏุงุฆูุงู ููุฌุจุฉ ุฃู ุตูุฑ) ุฃูู ูู ุนุฏุฏ ุณุงูุจ. ูุฐุง ูุณุชุญูู.</p>
                                     <p class="text-center mt-2">ูุซุงู: <span class="math-eq">|ุณ - ูข| < -ูฃ</span></p>
                                     <p class="text-center text-sm text-gray-600">ุงูุญู ูู โ ูุฃูู ูุง ูููู ุฃู ุชููู ุงููููุฉ ุงููุทููุฉ ุณุงูุจุฉ.</p>
                                 </div>
                                 <div>
                                     <h4 class="font-bold text-green-700">ูข. ุงูุญู ูู ุฌููุน ุงูุฃุนุฏุงุฏ ุงูุญููููุฉ (ุญ)</h4>
                                     <p class="text-gray-700">ุชุญุฏุซ ูุฐู ุงูุญุงูุฉ ุนูุฏูุง ุชููู ุงููููุฉ ุงููุทููุฉ (ููู ุฏุงุฆูุงู ููุฌุจุฉ ุฃู ุตูุฑ) ุฃูุจุฑ ูู ุนุฏุฏ ุณุงูุจ. ูุฐุง ุตุญูุญ ุฏุงุฆูุงู.</p>
                                     <p class="text-center mt-2">ูุซุงู: <span class="math-eq">|ุณ + ูค| โฅ -ูก</span></p>
                                     <p class="text-center text-sm text-gray-600">ุงูุญู ูู ุฌููุน ุงูุฃุนุฏุงุฏ ุงูุญููููุฉ ูุฃู ุงููููุฉ ุงููุทููุฉ ุฏุงุฆูุงู ุฃูุจุฑ ูู ุฃู ุนุฏุฏ ุณุงูุจ.</p>
                                 </div>
                             </div>
                        </div>
                    </div>
                </section>

                <section class="mb-12">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">๐ฏ ุซุงููุงู: ุฃูุซูุฉ ุชูุงุนููุฉ</h2>
                    <div class="p-6 bg-gray-50 rounded-lg space-y-8">
                        
                        <!-- ูุณู ุฃูุซูุฉ ุงููููุฉ ุงููุทููุฉ "ุฃุตุบุฑ ูู" -->
                        <div>
                            <h3 class="text-xl font-bold text-green-800 mb-4 border-b-2 border-green-200 pb-2">ุฃูุซูุฉ ุนูู (<) ู (โค)</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-4">
                                <!-- ุงููุซุงู ุงูุชูุงุนูู 1 -->
                                <div id="interactive-container-1" class="p-4 bg-white rounded-lg shadow">
                                    <div class="mb-4">
                                        <p class="text-lg font-semibold">ูุซุงู ูก:</p>
                                        <p class="text-lg font-semibold mt-1">ุญู <span class="math-eq">|ู - ูจ| โค ูข</span></p>
                                    </div>
                                    <div class="steps-container space-y-4 min-h-[250px]">
                                        <div class="interactive-placeholder text-center text-gray-500 p-4"><p>ุงุถุบุท "ุงูุชุงูู" ูุจุฏุก ุฎุทูุงุช ุงูุญู</p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ ูก: ุงูุชุจูุง ููุชุจุงููุฉ "ู"</h4><p class="text-center"><span class="math-eq">-ูข โค ู - ูจ โค ูข</span></p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ ูข: ุฃุถู ูจ ูุฌููุน ุงูุฃุทุฑุงู</h4><p class="text-center"><span class="math-eq">-ูข <span class="highlight-number">+ูจ</span> โค ู - ูจ <span class="highlight-number">+ูจ</span> โค ูข <span class="highlight-number">+ูจ</span></span></p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ ูฃ: ุงูุญู ุงูููุงุฆู</h4><p class="text-center"><span class="math-eq">ูฆ โค ู โค ูกู</span></p></div>
                                        <div class="step-interactive p-4 bg-green-200 rounded-lg step-box border-green-600"><h4 class="font-bold">ุงูุฎุทูุฉ ูค: ุงูุชูุซูู ุงูุจูุงูู</h4>
                                            <div class="number-line-wrapper">
                                                <div class="ticks-container">
                                                    <div class="tick" style="left: 20%;"><span>ูฆ</span></div>
                                                    <div class="tick" style="left: 50%;"><span>ูจ</span></div>
                                                    <div class="tick" style="left: 80%;"><span>ูกู</span></div>
                                                    <div class="number-line">
                                                        <div class="solution-line" style="left: 20%; width: 60%;"></div>
                                                        <div class="solution-point closed" style="left: 20%;"></div>
                                                        <div class="solution-point closed" style="left: 80%;"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex justify-between mt-6">
                                        <button data-example="1" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">ุฑุฌูุน</button>
                                        <div>
                                            <button data-example="1" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">ุงูุชุงูู</button>
                                            <button data-example="1" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">ุฅุนุงุฏุฉ</button>
                                        </div>
                                    </div>
                                </div>
                                <!-- ุงููุซุงู ุงูุชูุงุนูู 2 (ููุนุฏู) -->
                                <div id="interactive-container-2" class="p-4 bg-white rounded-lg shadow">
                                    <div class="mb-4">
                                        <p class="text-lg font-semibold">ูุซุงู ูข:</p>
                                        <p class="text-lg font-semibold mt-1">ุญู <span class="math-eq">|ูขู + ูก| โค ูฉ</span></p>
                                    </div>
                                    <div class="steps-container space-y-4 min-h-[250px]">
                                        <div class="interactive-placeholder text-center text-gray-500 p-4"><p>ุงุถุบุท "ุงูุชุงูู" ูุจุฏุก ุฎุทูุงุช ุงูุญู</p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ ูก: ุงูุชุจูุง ููุชุจุงููุฉ "ู"</h4><p class="text-center"><span class="math-eq">-ูฉ โค ูขู + ูก โค ูฉ</span></p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ ูข: ุงุทุฑุญ ูก ูู ุงูุฃุทุฑุงู</h4><p class="text-center"><span class="math-eq">-ูฉ <span class="highlight-number">-ูก</span> โค ูขู โค ูฉ <span class="highlight-number">-ูก</span></span></p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ ูฃ: ุงูุชุจุณูุท</h4><p class="text-center"><span class="math-eq">-ูกู โค ูขู โค ูจ</span></p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ ูค: ุงูุณู ุนูู ูข</h4><p class="text-center"><span class="math-eq"><span class="fraction"><span>-ูกู</span><span class="frac-bar"></span><span class="highlight-number">ูข</span></span> โค <span class="fraction"><span>ูขู</span><span class="frac-bar"></span><span class="highlight-number">ูข</span></span> โค <span class="fraction"><span>ูจ</span><span class="frac-bar"></span><span class="highlight-number">ูข</span></span></span></p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ ูฅ: ุงูุญู ุงูููุงุฆู</h4><p class="text-center"><span class="math-eq">-ูฅ โค ู โค ูค</span></p></div>
                                        <div class="step-interactive p-4 bg-green-200 rounded-lg step-box border-green-600"><h4 class="font-bold">ุงูุฎุทูุฉ ูฆ: ุงูุชูุซูู ุงูุจูุงูู</h4>
                                            <div class="number-line-wrapper">
                                                <div class="ticks-container">
                                                    <div class="tick" style="left: 10%;"><span>-ูฅ</span></div>
                                                    <div class="tick" style="left: 50%;"><span>ู</span></div>
                                                    <div class="tick" style="left: 90%;"><span>ูค</span></div>
                                                    <div class="number-line">
                                                        <div class="solution-line" style="left: 10%; width: 80%;"></div>
                                                        <div class="solution-point closed" style="left: 10%;"></div>
                                                        <div class="solution-point closed" style="left: 90%;"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex justify-between mt-6">
                                        <button data-example="2" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">ุฑุฌูุน</button>
                                        <div>
                                            <button data-example="2" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">ุงูุชุงูู</button>
                                            <button data-example="2" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">ุฅุนุงุฏุฉ</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ูุณู ุฃูุซูุฉ ุงููููุฉ ุงููุทููุฉ "ุฃูุจุฑ ูู" -->
                        <div>
                            <h3 class="text-xl font-bold text-blue-800 mb-4 border-b-2 border-blue-200 pb-2">ุฃูุซูุฉ ุนูู (>) ู (โฅ)</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-4">
                                <!-- ุงููุซุงู ุงูุชูุงุนูู 3 -->
                                <div id="interactive-container-3" class="p-4 bg-white rounded-lg shadow">
                                    <div class="mb-4">
                                        <p class="text-lg font-semibold">ูุซุงู ูฃ:</p>
                                        <p class="text-lg font-semibold mt-1">ุญู <span class="math-eq">|ูขู + ูก| > ูง</span></p>
                                    </div>
                                    <div class="steps-container space-y-4 min-h-[250px]">
                                        <div class="interactive-placeholder text-center text-gray-500 p-4"><p>ุงุถุบุท "ุงูุชุงูู" ูุจุฏุก ุฎุทูุงุช ุงูุญู</p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box">
                                            <h4 class="font-bold">ุงูุฎุทูุฉ ูก: ุงูุชุจูุง ููุชุจุงููุฉ "ุฃู"</h4>
                                            <div class="flex justify-around text-center mt-2">
                                                <p><span class="math-eq">ูขู + ูก > ูง</span></p>
                                                <p class="font-bold">ุฃู</p>
                                                <p><span class="math-eq">ูขู + ูก < -ูง</span></p>
                                            </div>
                                        </div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box">
                                            <h4 class="font-bold">ุงูุฎุทูุฉ ูข: ุญู ุงููุชุจุงููุชูู</h4>
                                            <div class="flex justify-around text-center mt-2">
                                                <div class="space-y-1">
                                                    <p><span class="math-eq" style="font-size: 1rem; padding: 2px 4px;">ูขู > ูง<span class="highlight-number">-ูก</span></span></p>
                                                    <p class="font-bold text-xl">โ</p>
                                                    <p><span class="math-eq">ู > ูฃ</span></p>
                                                </div>
                                                <div class="space-y-1">
                                                    <p><span class="math-eq" style="font-size: 1rem; padding: 2px 4px;">ูขู < -ูง<span class="highlight-number">-ูก</span></span></p>
                                                    <p class="font-bold text-xl">โ</p>
                                                    <p><span class="math-eq">ู < -ูค</span></p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ ูฃ: ุงูุญู ุงูููุงุฆู</h4>
                                            <p class="text-center"><span class="math-eq">ู > ูฃ</span> ุฃู <span class="math-eq">ู < -ูค</span></p>
                                        </div>
                                        <div class="step-interactive p-4 bg-green-200 rounded-lg step-box border-green-600"><h4 class="font-bold">ุงูุฎุทูุฉ ูค: ุงูุชูุซูู ุงูุจูุงูู</h4>
                                            <div class="number-line-wrapper">
                                                <div class="ticks-container">
                                                    <div class="tick" style="left: 25%;"><span>-ูค</span></div>
                                                    <div class="tick" style="left: 50%;"><span>ู</span></div>
                                                    <div class="tick" style="left: 75%;"><span>ูฃ</span></div>
                                                    <div class="number-line">
                                                        <div class="solution-line" style="left: 0%; width: 25%;"></div>
                                                        <div class="solution-point open" style="left: 25%;"></div>
                                                        <div class="solution-line" style="left: 75%; width: 25%;"></div>
                                                        <div class="solution-point open" style="left: 75%;"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex justify-between mt-6">
                                        <button data-example="3" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">ุฑุฌูุน</button>
                                        <div>
                                            <button data-example="3" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">ุงูุชุงูู</button>
                                            <button data-example="3" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">ุฅุนุงุฏุฉ</button>
                                        </div>
                                    </div>
                                </div>
                                <!-- ุงููุซุงู ุงูุชูุงุนูู 4 (ููุนุฏู) -->
                                <div id="interactive-container-4" class="p-4 bg-white rounded-lg shadow">
                                    <div class="mb-4">
                                        <p class="text-lg font-semibold">ูุซุงู ูค (ููุฑุฉ ุฌุฏูุฏุฉ):</p>
                                        <p class="text-lg font-semibold mt-1">ุญู <span class="math-eq">|ูฅ - ูขุฏ| > ูฃ</span></p>
                                    </div>
                                    <div class="steps-container space-y-4 min-h-[250px]">
                                        <div class="interactive-placeholder text-center text-gray-500 p-4"><p>ุงุถุบุท "ุงูุชุงูู" ูุจุฏุก ุฎุทูุงุช ุงูุญู</p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box">
                                            <h4 class="font-bold">ุงูุฎุทูุฉ ูก: ุงูุชุจูุง ููุชุจุงููุฉ "ุฃู"</h4>
                                            <div class="flex justify-around text-center mt-2">
                                                <p><span class="math-eq">ูฅ - ูขุฏ > ูฃ</span></p>
                                                <p class="font-bold">ุฃู</p>
                                                <p><span class="math-eq">ูฅ - ูขุฏ < -ูฃ</span></p>
                                            </div>
                                        </div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box">
                                            <h4 class="font-bold">ุงูุฎุทูุฉ ูข: ุงุทุฑุญ ูฅ ูู ุงูุทุฑููู</h4>
                                            <div class="flex justify-around text-center mt-2">
                                                <div class="space-y-1">
                                                    <p><span class="math-eq" style="font-size: 1rem; padding: 2px 4px;">-ูขุฏ > ูฃ<span class="highlight-number">-ูฅ</span></span></p>
                                                    <p class="font-bold text-xl">โ</p>
                                                    <p><span class="math-eq">-ูขุฏ > -ูข</span></p>
                                                </div>
                                                <div class="space-y-1">
                                                    <p><span class="math-eq" style="font-size: 1rem; padding: 2px 4px;">-ูขุฏ < -ูฃ<span class="highlight-number">-ูฅ</span></span></p>
                                                    <p class="font-bold text-xl">โ</p>
                                                    <p><span class="math-eq">-ูขุฏ < -ูจ</span></p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="step-interactive p-4 bg-yellow-100 rounded-lg step-box border-yellow-500"><h4 class="font-bold text-yellow-800">ุงูุฎุทูุฉ ูฃ: ุงูุณู ุนูู -ูข (ุงูุชุจู!)</h4>
                                            <p class="text-center text-red-600 font-bold">ุนูุฏ ุงููุณูุฉ ุนูู ุนุฏุฏ ุณุงูุจุ ูุฌุจ ุนูุณ ุงุชุฌุงู ุฅุดุงุฑุฉ ุงููุชุจุงููุฉ.</p>
                                            <div class="flex justify-around text-center mt-2">
                                                 <p><span class="math-eq"><span class="fraction"><span>-ูขุฏ</span><span class="frac-bar"></span><span class="highlight-number">-ูข</span></span> <span class="text-red-600 font-bold"><</span> <span class="fraction"><span>-ูข</span><span class="frac-bar"></span><span class="highlight-number">-ูข</span></span></span></p>
                                                 <p class="font-bold">ุฃู</p>
                                                 <p><span class="math-eq"><span class="fraction"><span>-ูขุฏ</span><span class="frac-bar"></span><span class="highlight-number">-ูข</span></span> <span class="text-red-600 font-bold">></span> <span class="fraction"><span>-ูจ</span><span class="frac-bar"></span><span class="highlight-number">-ูข</span></span></span></p>
                                            </div>
                                        </div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box">
                                            <h4 class="font-bold">ุงูุฎุทูุฉ ูค: ุงูุญู ุงูููุงุฆู</h4>
                                            <p class="text-center"><span class="math-eq">ุฏ < ูก</span> ุฃู <span class="math-eq">ุฏ > ูค</span></p>
                                        </div>
                                        <div class="step-interactive p-4 bg-green-200 rounded-lg step-box border-green-600"><h4 class="font-bold">ุงูุฎุทูุฉ ูฅ: ุงูุชูุซูู ุงูุจูุงูู</h4>
                                            <div class="number-line-wrapper">
                                                <div class="ticks-container">
                                                    <div class="tick" style="left: 25%;"><span>ูก</span></div>
                                                    <div class="tick" style="left: 50%;"><span>ูข.ูฅ</span></div>
                                                    <div class="tick" style="left: 75%;"><span>ูค</span></div>
                                                    <div class="number-line">
                                                        <div class="solution-line" style="left: 0%; width: 25%;"></div>
                                                        <div class="solution-point open" style="left: 25%;"></div>
                                                        <div class="solution-line" style="left: 75%; width: 25%;"></div>
                                                        <div class="solution-point open" style="left: 75%;"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex justify-between mt-6">
                                        <button data-example="4" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">ุฑุฌูุน</button>
                                        <div>
                                            <button data-example="4" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">ุงูุชุงูู</button>
                                            <button data-example="4" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">ุฅุนุงุฏุฉ</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ูุณู ุฃูุซูุฉ ูู ูุงูุน ุงูุญูุงุฉ -->
                        <div>
                            <h3 class="text-xl font-bold text-teal-800 mb-4 border-b-2 border-teal-200 pb-2">ุฃูุซูุฉ ูู ูุงูุน ุงูุญูุงุฉ</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-4">
                                <!-- ุงููุซุงู ุงูุชูุงุนูู 5 (ููุนุฏู) -->
                                <div id="interactive-container-5" class="p-4 bg-white rounded-lg shadow">
                                    <div class="mb-4">
                                        <p class="text-lg font-semibold">ูุซุงู ูฅ (ูุซุจุช ุงูุณุฑุนุฉ):</p>
                                        <p class="text-lg mt-1">ูุญูุธ ูุซุจุช ุณุฑุนุฉ ุงูุณูุงุฑุฉ ุนูุฏ ูจูจ ููู/ุณุงุนุฉุ ุจุฒูุงุฏุฉ ุฃู ููุตุงู ููุฏุงุฑู ูฅ ููู/ุณุงุนุฉ. ุงูุชุจ ูุฏู ุงูุณุฑุนุฉ ุงููุนููุฉ ููุณูุงุฑุฉ.</p>
                                    </div>
                                    <div class="steps-container space-y-4 min-h-[250px]">
                                        <div class="interactive-placeholder text-center text-gray-500 p-4"><p>ุงุถุบุท "ุงูุชุงูู" ูุจุฏุก ุฎุทูุงุช ุงูุญู</p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ ูก: ูุชุงุจุฉ ุงููุชุจุงููุฉ</h4>
                                            <p>ุงูููุฑุฉ: ุงููุฏู - ุฃู ุงููุฑู - ุจูู ุงูุณุฑุนุฉ ุงููุนููุฉ (ุน) ูุงูุณุฑุนุฉ ุงููุฑูุฒูุฉ (ูจูจ) ูุฌุจ ุฃู ูููู ุจูู -ูฅ ู ูฅ. ูููุนุจุฑ ุนู ูุฐุง ุงููุฑู ุจุงููููุฉ ุงููุทููุฉ ุจุฃูู ูุง ูุฒูุฏ ุนู ูฅ.</p>
                                            <p class="text-center mt-4"><span class="math-eq">|ุน - ูจูจ| โค ูฅ</span></p>
                                        </div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ ูข: ุญู ุงููุชุจุงููุฉ</h4><p>ูุญูููุง ููุชุจุงููุฉ "ู":</p><p class="text-center mt-2"><span class="math-eq">-ูฅ โค ุน - ูจูจ โค ูฅ</span></p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ ูฃ: ุฃุถู ูจูจ ููุฃุทุฑุงู</h4><p class="text-center"><span class="math-eq">-ูฅ <span class="highlight-number">+ูจูจ</span> โค ุน โค ูฅ <span class="highlight-number">+ูจูจ</span></span></p></div>
                                        <div class="step-interactive p-4 bg-green-200 rounded-lg step-box border-green-600"><h4 class="font-bold">ุงูุฎุทูุฉ ูค: ุงูุญู ุงูููุงุฆู</h4><p>ูุฏู ุงูุณุฑุนุฉ ุงููุนููุฉ ูู:</p><p class="text-center mt-2"><span class="math-eq">ูจูฃ โค ุน โค ูฉูฃ</span></p><p class="text-center text-sm text-gray-600">ุฃู ุฃู ุณุฑุนุฉ ุงูุณูุงุฑุฉ ุชุชุฑุงูุญ ุจูู ูจูฃ ู ูฉูฃ ููู/ุณุงุนุฉ.</p></div>
                                    </div>
                                    <div class="flex justify-between mt-6">
                                        <button data-example="5" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">ุฑุฌูุน</button>
                                        <div>
                                            <button data-example="5" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">ุงูุชุงูู</button>
                                            <button data-example="5" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">ุฅุนุงุฏุฉ</button>
                                        </div>
                                    </div>
                                </div>
                                <!-- ุงููุซุงู ุงูุชูุงุนูู 6 (ููุนุฏู) -->
                                <div id="interactive-container-6" class="p-4 bg-white rounded-lg shadow">
                                    <div class="mb-4">
                                        <p class="text-lg font-semibold">ูุซุงู ูฆ (ููููุงุก):</p>
                                        <p class="text-lg mt-1">ููุญูุงุธ ุนูู ููุงู ุงููุณุจุญ ุขููุฉุ ูุฌุจ ุฃู ูููู ูุณุชูู ุงูุญููุถุฉ (ุจ) ุงููุซุงูู ูู ูงูซูคุ ูุน ุชูุงูุช ูุง ูุฒูุฏ ุนู ููซูข. ุงูุชุจ ูุชุจุงููุฉ ุชูุซู ูุฏู ุงูุญููุถุฉ ุงูููุจูู.</p>
                                    </div>
                                    <div class="steps-container space-y-4 min-h-[250px]">
                                        <div class="interactive-placeholder text-center text-gray-500 p-4"><p>ุงุถุบุท "ุงูุชุงูู" ูุจุฏุก ุฎุทูุงุช ุงูุญู</p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ ูก: ูุชุงุจุฉ ุงููุชุจุงููุฉ</h4>
                                            <p>ุงูููุฑุฉ: ุงููุฑู ุจูู ูุณุชูู ุงูุญููุถุฉ ุงููุนูู (ุจ) ูุงููุณุชูู ุงููุซุงูู (ูงูซูค) ูุฌุจ ุฃู ูููู ุจูู -ููซูข ู ููซูข. ูููุนุจุฑ ุนู ูุฐุง ุงููุฑู ุจุงููููุฉ ุงููุทููุฉ ุจุฃูู ูุง ูุฒูุฏ ุนู ููซูข.</p>
                                            <p class="text-center mt-4"><span class="math-eq">|ุจ - ูงูซูค| โค ููซูข</span></p>
                                        </div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ ูข: ุญู ุงููุชุจุงููุฉ</h4><p>ูุญูููุง ููุชุจุงููุฉ "ู":</p><p class="text-center mt-2"><span class="math-eq">-ููซูข โค ุจ - ูงูซูค โค ููซูข</span></p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ ูฃ: ุฃุถู ูงูซูค ููุฃุทุฑุงู</h4><p class="text-center"><span class="math-eq">-ููซูข <span class="highlight-number">+ูงูซูค</span> โค ุจ โค ููซูข <span class="highlight-number">+ูงูซูค</span></span></p></div>
                                        <div class="step-interactive p-4 bg-green-200 rounded-lg step-box border-green-600"><h4 class="font-bold">ุงูุฎุทูุฉ ูค: ุงูุญู ุงูููุงุฆู</h4><p>ูุฏู ุงูุญููุถุฉ ุงูููุจูู ูู:</p><p class="text-center mt-2"><span class="math-eq">ูงูซูข โค ุจ โค ูงูซูฆ</span></p></div>
                                    </div>
                                    <div class="flex justify-between mt-6">
                                        <button data-example="6" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">ุฑุฌูุน</button>
                                        <div>
                                            <button data-example="6" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">ุงูุชุงูู</button>
                                            <button data-example="6" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">ุฅุนุงุฏุฉ</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 mt-8"> <!-- New container for example 7 -->
                                <!-- ุงููุซุงู ุงูุชูุงุนูู 7 (ุฌุฏูุฏ) -->
                                <div id="interactive-container-7" class="p-4 bg-white rounded-lg shadow">
                                    <div class="mb-4">
                                        <p class="text-lg font-semibold">ูุซุงู ูง (ุณูุงูุฉ ุงูุบุฐุงุก):</p>
                                        <p class="text-lg mt-1">ูุฌุจ ุฃู ุชุจูู ุฏุฑุฌุฉ ุญุฑุงุฑุฉ ุซูุงุฌุฉ ุงูุญููุจ ุนูุฏ ูฅยฐ ูุฆููุฉ. ุฅุฐุง ุงุฎุชููุช ุงูุฏุฑุฌุฉ ุงููุนููุฉ (ุฏ) ุนู ูฅยฐ ุจุฃูุซุฑ ูู ุฏุฑุฌุชููุ ูุฅููุง ุชุชุทูุจ ูุญุตุงู ููุฑูุงู. ุงูุชุจ ูุชุจุงููุฉ ุชูุซู ุฏุฑุฌุงุช ุงูุญุฑุงุฑุฉ ุงูุชู ุชุชุทูุจ ูุญุตุงู.</p>
                                    </div>
                                    <div class="steps-container space-y-4 min-h-[250px]">
                                        <div class="interactive-placeholder text-center text-gray-500 p-4"><p>ุงุถุบุท "ุงูุชุงูู" ูุจุฏุก ุฎุทูุงุช ุงูุญู</p></div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ ูก: ูุชุงุจุฉ ุงููุชุจุงููุฉ</h4>
                                            <p>ุงูููุฑุฉ: ุงููุฑู ุจูู ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ ุงููุนููุฉ (ุฏ) ูุงููุซุงููุฉ (ูฅ) ูุฌุจ ุฃู ูููู "ุฃูุซุฑ ูู" ุฏุฑุฌุชูู. ูุฐุง ูุนูู ุฃู ุงููููุฉ ุงููุทููุฉ ูููุฑู ุฃูุจุฑ ูู ูข.</p>
                                            <p class="text-center mt-4"><span class="math-eq">|ุฏ - ูฅ| > ูข</span></p>
                                        </div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ ูข: ุญู ุงููุชุจุงููุฉ</h4><p>ูุญูููุง ููุชุจุงููุฉ "ุฃู":</p>
                                            <div class="flex justify-around text-center mt-2">
                                                <p><span class="math-eq">ุฏ - ูฅ > ูข</span></p>
                                                <p class="font-bold">ุฃู</p>
                                                <p><span class="math-eq">ุฏ - ูฅ < -ูข</span></p>
                                            </div>
                                        </div>
                                        <div class="step-interactive p-4 bg-gray-50 rounded-lg step-box"><h4 class="font-bold">ุงูุฎุทูุฉ ูฃ: ุฃุถู ูฅ ููุทุฑููู</h4>
                                            <div class="flex justify-around text-center mt-2">
                                                <p><span class="math-eq">ุฏ > ูง</span></p>
                                                <p class="font-bold">ุฃู</p>
                                                <p><span class="math-eq">ุฏ < ูฃ</span></p>
                                            </div>
                                        </div>
                                        <div class="step-interactive p-4 bg-green-200 rounded-lg step-box border-green-600"><h4 class="font-bold">ุงูุฎุทูุฉ ูค: ุงูุญู ุงูููุงุฆู</h4><p>ุฏุฑุฌุงุช ุงูุญุฑุงุฑุฉ ุงูุชู ุชุชุทูุจ ูุญุตุงู ูู:</p><p class="text-center mt-2"><span class="math-eq">ุฏ < ูฃ</span> ุฃู <span class="math-eq">ุฏ > ูง</span></p><p class="text-center text-sm text-gray-600">ุฃู ุฅุฐุง ูุงูุช ุงูุญุฑุงุฑุฉ ุฃูู ูู ูฃยฐ ุฃู ุฃุนูู ูู ูงยฐ.</p></div>
                                    </div>
                                    <div class="flex justify-between mt-6">
                                        <button data-example="7" class="prev-btn bg-gray-300 text-gray-700 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 disabled:opacity-50 disabled:cursor-not-allowed">ุฑุฌูุน</button>
                                        <div>
                                            <button data-example="7" class="next-btn bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700">ุงูุชุงูู</button>
                                            <button data-example="7" class="reset-btn hidden bg-purple-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-purple-700">ุฅุนุงุฏุฉ</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </section>

                <section class="mt-12">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-bold text-gray-800">โ๏ธ ุซุงูุซุงู: ุญุงู ุฏูุฑู! ุงุฎุชุจุฑ ูููู</h2>
                        <div id="attempts-counter" class="text-sm font-bold text-gray-600"></div>
                    </div>
                    <form id="quizForm" class="p-6 bg-gray-50 rounded-lg space-y-8"></form>
                    <div id="quiz-results" class="hidden mt-6 p-4 rounded-lg text-center">
                        <h3 class="text-xl font-bold">ูุชูุฌุชู ุงูููุงุฆูุฉ</h3>
                        <p id="quiz-score" class="text-4xl font-bold my-2"></p>
                        <div id="save-status" class="mt-4 text-sm font-semibold"></div>
                        <button id="retake-quiz-btn" class="hidden mt-4 bg-blue-600 text-white font-medium py-2 px-6 rounded-lg hover:bg-blue-700">ุฅุนุงุฏุฉ ุงูุงุฎุชุจุงุฑ</button>
                    </div>
                </section>
            </div>
        </main>
        <footer id="main-footer" class="bg-gray-200 py-4"></footer>
    </div>

    <!-- Modals for explanations -->
    <div id="explanationModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-lg shadow-2xl p-6 max-w-lg w-full">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold">๐ก ุดุฑุญ ุงูุฅุฌุงุจุฉ</h3>
                <button id="closeModalBtn" class="p-2 -m-2 rounded-full hover:bg-gray-200">
                    <svg class="h-6 w-6 text-gray-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <div id="explanationText" class="text-gray-700 max-h-[60vh] overflow-y-auto"></div>
        </div>
    </div>
    <div id="smartExplanationModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-lg shadow-2xl p-6 max-w-lg w-full border-t-4 border-purple-500">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-purple-800">๐ง ุงูุญู ุงูุฐูู</h3>
                <button id="closeSmartModalBtn" class="p-2 -m-2 rounded-full hover:bg-gray-200">
                    <svg class="h-6 w-6 text-gray-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                </button>
            </div>
            <div id="smartExplanationText" class="text-gray-700 max-h-[60vh] overflow-y-auto"></div>
        </div>
    </div>

    <script>
    // --- Start of JS modifications ---
    const urlParams = new URLSearchParams(window.location.search);
    const studentId = urlParams.get('studentId');
    const classId = urlParams.get('classId');
    // --- End of JS modifications ---

    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzrf1-At3Pq7i39bGV3F1iD3-b0G-WWyRi5cgpKeQjyn_N5fh2EmGhoyRKUsbLd-F_UJQ/exec";
    const MAX_ATTEMPTS = 3;
    let currentQuestions = [];
    function getStudentFromStorage() { const studentDataString = localStorage.getItem('currentStudent'); if (studentDataString) { try { return JSON.parse(studentDataString); } catch (e) { return null; } } return null; }
    function buildHeader(studentData, lessonTitle = null) { 
        const headerContainer = document.getElementById('main-header'); 
        if (!headerContainer) return; 
        let titleHtml; 
        if (lessonTitle) { 
            titleHtml = `<div><h2 class="text-sm text-gray-500 leading-tight">ููุตุฉ ุงูุฑูุงุถูุงุช ุงูุชูุงุนููุฉ</h2><h1 class="text-xl font-bold text-indigo-700 leading-tight">${lessonTitle}</h1></div>`; 
        } else { 
            titleHtml = `<a href="../index.html" target="_top"><h1 class="text-2xl font-bold text-blue-800">ููุตุฉ ุงูุฑูุงุถูุงุช ุงูุชูุงุนููุฉ</h1></a>`; 
        } 
        let userInfoHtml = ''; 
        if (studentData) { 
            userInfoHtml = `<div class="text-left"><div class="flex items-center justify-end gap-4"><span class="font-semibold">ุฃููุงูุ ${studentData.name}</span><a href="../index.html" target="_top" id="logout-link" class="bg-red-500 text-white py-1 px-3 rounded-lg hover:bg-red-600">ุฎุฑูุฌ</a></div><a href="../index.html" target="_top" class="text-sm text-blue-600 hover:underline mt-1 inline-block">&larr; ุงูุนูุฏุฉ ุฅูู ุงูููุฑุณ</a></div>`; 
        } else { 
            userInfoHtml = `<div class="text-left"><p class="text-lg text-gray-600">ุฒุงุฆุฑ</p><a href="../index.html" target="_top" class="text-sm text-blue-600 hover:underline mt-1 inline-block">&larr; ุงูุนูุฏุฉ ุฅูู ุงูููุฑุณ</a></div>`; 
        } 
        headerContainer.innerHTML = `<div class="container mx-auto px-6 py-4 flex justify-between items-center">${titleHtml}${userInfoHtml}</div>`; 
        const logoutLink = headerContainer.querySelector('#logout-link'); 
        if(logoutLink) { 
            logoutLink.addEventListener('click', () => { localStorage.removeItem('currentStudent'); }); 
        } 
    }
    function buildFooter() { const footerContainer = document.getElementById('main-footer'); if (!footerContainer) return; footerContainer.innerHTML = `<div class="container mx-auto px-6"><p class="text-center text-gray-600 text-sm">ยฉ 2024 ุฌููุน ุงูุญููู ูุญููุธุฉ | ุชุตููู ูุชุทููุฑ: ุฃ. ุนุจุฏุงูุนุฒูุฒ ุฎุงูุฏ ุงูุนุจูุงู</p></div>`; }
    function initializeQuiz(lessonId, questions, studentData) { currentQuestions = questions; const quizForm = document.getElementById('quizForm'); if (!quizForm) return; if (questions.length === 0) { quizForm.innerHTML = `<p class="text-center text-gray-600">ูุง ุชูุฌุฏ ุฃุณุฆูุฉ ูุชุงุญุฉ ููุฐุง ุงูุฏุฑุณ ุญุงููุงู.</p>`; return; } let attemptsLeft; if (studentData) { const studentLessonData = studentData.lessons?.[lessonId] || { attempts: 0 }; attemptsLeft = MAX_ATTEMPTS - studentLessonData.attempts; } else { attemptsLeft = 1; } const attemptsCounter = document.getElementById('attempts-counter'); if (attemptsCounter) { attemptsCounter.innerHTML = `ุงููุญุงููุงุช ุงููุชุจููุฉ: <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full">${attemptsLeft}</span>`; } const quizHtml = questions.map((q, index) => { const optionsHTML = q.options.map((opt, optIndex) => `<div><input type="radio" name="q${index}" value="${opt.value}" id="q${index}_opt${optIndex}" class="hidden"><label for="q${index}_opt${optIndex}" class="option-label">${opt.display}</label></div>`).join(''); const smartButtonHTML = q.smartExplanation ? `<button type="button" id="smart-explain-btn-${index}" class="hidden mt-2 text-xs text-purple-600 hover:underline font-semibold">๐ง ุงูุญู ุงูุฐูู</button>` : ''; return `<div class="p-4 border-2 border-gray-200 rounded-lg"><p class="font-bold">${index + 1}. <span class="text-yellow-500">${q.level}</span> ${q.text}</p><div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mt-3">${optionsHTML}</div><div id="feedback-q${index}" class="mt-2 text-sm font-bold"></div><div class="flex items-center space-x-4 space-x-reverse">${smartButtonHTML}<button type="button" id="explain-btn-${index}" class="hidden mt-2 text-xs text-blue-600 hover:underline">ุงุนุฑู ููุงุฐุงุ</button></div></div>`; }).join(''); quizForm.innerHTML = quizHtml + `<button type="submit" id="submit-quiz-btn" class="w-full text-white bg-green-600 hover:bg-green-700 font-medium rounded-lg text-lg px-5 py-3 mt-8">ุชุญูู ูู ุฅุฌุงุจุงุชู</button>`; questions.forEach((q, index) => { const explainBtn = document.getElementById(`explain-btn-${index}`); if(explainBtn) explainBtn.addEventListener('click', () => showExplanation(index)); if (q.smartExplanation) { const smartExplainBtn = document.getElementById(`smart-explain-btn-${index}`); if(smartExplainBtn) smartExplainBtn.addEventListener('click', () => showSmartExplanation(index)); } }); if (attemptsLeft <= 0) { const submitBtn = quizForm.querySelector('#submit-quiz-btn'); submitBtn.disabled = true; submitBtn.textContent = 'ูุง ุชูุฌุฏ ูุญุงููุงุช ูุชุจููุฉ'; submitBtn.classList.add('bg-gray-400', 'hover:bg-gray-400'); } quizForm.onsubmit = (e) => { e.preventDefault(); let score = 0; questions.forEach((q, index) => { const userAnswer = e.target.elements[`q${index}`]?.value; const feedbackEl = document.getElementById(`feedback-q${index}`); if (userAnswer === q.correct) { score++; feedbackEl.textContent = 'โ ุฅุฌุงุจุฉ ุตุญูุญุฉ!'; feedbackEl.className = 'mt-2 text-sm font-bold text-green-600'; } else { feedbackEl.textContent = `โ ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ.`; feedbackEl.className = 'mt-2 text-sm font-bold text-red-600'; } document.getElementById(`explain-btn-${index}`).classList.remove('hidden'); if (q.smartExplanation) { document.getElementById(`smart-explain-btn-${index}`).classList.remove('hidden'); } }); const finalGrade = Math.round((score / questions.length) * 10); const resultsDiv = document.getElementById('quiz-results'); resultsDiv.classList.remove('hidden'); document.getElementById('quiz-score').textContent = `${finalGrade} / 10`; if (studentData) { saveGrade(lessonId, finalGrade); } else { document.getElementById('save-status').textContent = 'ุชู ุนุฑุถ ูุชูุฌุชู. ุณุฌู ุงูุฏุฎูู ูุญูุธ ุชูุฏูู.'; } e.target.querySelector('#submit-quiz-btn').disabled = true; }; }
    function saveGrade(lessonId, grade) { 
        const saveStatus = document.getElementById('save-status');
        if (!studentId || !classId) {
            saveStatus.textContent = 'ุฎุทุฃ: ูุง ูููู ุญูุธ ูุชูุฌุชู. ุจูุงูุงุช ุงูุทุงูุจ ุฃู ุงููุตู ููููุฏุฉ.';
            console.error("Student ID or Class ID is missing from the URL.");
            return;
        }
        saveStatus.textContent = 'ุฌุงุฑู ุญูุธ ูุชูุฌุชู...'; 
        const url = `${SCRIPT_URL}?action=saveGrade&studentId=${studentId}&classId=${classId}&lessonId=${lessonId}&grade=${grade}`; 
        fetch(url) .then(res => res.json()) .then(result => { if (result.status === 'success') { saveStatus.textContent = 'โ ุชู ุญูุธ ูุชูุฌุชู ุจูุฌุงุญ! ุณุชุธูุฑ ูู ููุญุฉ ุงูุชุญูู ุนูุฏ ุงูุนูุฏุฉ.'; const studentData = JSON.parse(localStorage.getItem('currentStudent')); if (!studentData.lessons) studentData.lessons = {}; if (!studentData.lessons[lessonId] || studentData.lessons[lessonId].grade < grade) { studentData.lessons[lessonId] = { grade: grade, attempts: (studentData.lessons[lessonId]?.attempts || 0) + 1 }; } else { studentData.lessons[lessonId].attempts++; } localStorage.setItem('currentStudent', JSON.stringify(studentData)); } else { throw new Error(result.message); } }) .catch(error => { saveStatus.textContent = 'โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุงูุฏุฑุฌุฉ.'; console.error("Save Grade Error:", error); }); 
    }
    function showExplanation(questionIndex) { const modal = document.getElementById('explanationModal'); const explanationText = document.getElementById('explanationText'); if(modal && explanationText && currentQuestions[questionIndex] && currentQuestions[questionIndex].explanation) { explanationText.innerHTML = currentQuestions[questionIndex].explanation; modal.classList.remove('hidden'); } }
    function closeModal() { const modal = document.getElementById('explanationModal'); if(modal) modal.classList.add('hidden'); }
    function showSmartExplanation(questionIndex) { const modal = document.getElementById('smartExplanationModal'); const explanationText = document.getElementById('smartExplanationText'); if(modal && explanationText && currentQuestions[questionIndex] && currentQuestions[questionIndex].smartExplanation) { explanationText.innerHTML = currentQuestions[questionIndex].smartExplanation; modal.classList.remove('hidden'); } }
    function closeSmartModal() { const modal = document.getElementById('smartExplanationModal'); if(modal) modal.classList.add('hidden'); }
    
    const LESSON_ID = 'c4_l5';
    
    function generateQuiz() { 
        const questionBank = [
            { 
                type: 'mcq', level: 'โญ', text: `ุฃู ูุชุจุงููุฉ ุชูุงูุฆ <span class="math-eq">|ุณ| < ูฅ</span>ุ`,
                options: [ 
                    { display: '<span class="math-eq">ุณ < ูฅ</span>', value: 'A' }, 
                    { display: '<span class="math-eq">ุณ < ูฅ</span> ุฃู <span class="math-eq">ุณ > -ูฅ</span>', value: 'B' }, 
                    { display: '<span class="math-eq">-ูฅ < ุณ < ูฅ</span>', value: 'C' }, 
                    { display: '<span class="math-eq">ุณ > -ูฅ</span>', value: 'D' }
                ], 
                correct: 'C',
                explanation: `<p>ูุชุจุงููุฉ ุงููููุฉ ุงููุทููุฉ ูุน ุนูุงูุฉ "ุฃุตุบุฑ ูู" (<) ุชุชุญูู ุฅูู ูุชุจุงููุฉ ูุฑูุจุฉ ุจุฃุฏุงุฉ ุงูุฑุจุท "ู".</p><p>ุงููุชุจุงููุฉ <span class="math-eq">|ุณ| < ูฅ</span> ุชุนูู ุฃู ุณ ูุญุตูุฑุฉ ุจูู <span class="highlight-number">-ูฅ</span> ู <span class="highlight-number">ูฅ</span>.</p>`,
            },
            { 
                type: 'mcq', level: 'โญโญ', text: `ุญู ุงููุชุจุงููุฉ <span class="math-eq">|ุต - ูข| โค ูค</span>`,
                options: [ 
                    { display: '<span class="math-eq">-ูข โค ุต โค ูฆ</span>', value: 'A' }, 
                    { display: '<span class="math-eq">ุต โค ูฆ</span>', value: 'B' }, 
                    { display: '<span class="math-eq">ุต โฅ -ูข</span>', value: 'C' }, 
                    { display: '<span class="math-eq">ุต โค -ูข</span> ุฃู <span class="math-eq">ุต โฅ ูฆ</span>', value: 'D' }
                ], 
                correct: 'A',
                explanation: `<p>1. ูุญูููุง ุฅูู ูุชุจุงููุฉ ูุฑูุจุฉ "ู": <span class="math-eq">-ูค โค ุต - ูข โค ูค</span></p><p>2. ูุถูู <span class="highlight-number">ูข</span> ููู ุงูุฃุทุฑุงู: <span class="math-eq">-ูค + ูข โค ุต โค ูค + ูข</span></p><p>3. ูุจุณุท ููุญุตูู ุนูู ุงูุญู: <span class="math-eq">-ูข โค ุต โค ูฆ</span></p>`,
                smartExplanation: `<p>ุฌุฑุจ ุชุนููุถ ูููุฉ ูู ุงูููุชุตูุ ูุซูุงู <span class="math-eq">ุต = ู</span>. ุงููุชุจุงููุฉ ุชุตุจุญ <span class="math-eq">|ู - ูข| = |-ูข| = ูข</span>. ุจูุง ุฃู <span class="math-eq">ูข โค ูค</span>ุ ูุงูุนุจุงุฑุฉ ุตุญูุญุฉ. ุฅุฐูุ ุงูุตูุฑ ูุฌุจ ุฃู ูููู ุถูู ุงูุญู. ูุฐุง ููุบู ุงูุฎูุงุฑ (ุฏ).</p><p>ุฌุฑุจ ูููุฉ ุญุฏูุฉุ ูุซูุงู <span class="math-eq">ุต = ูฆ</span>. ุงููุชุจุงููุฉ ุชุตุจุญ <span class="math-eq">|ูฆ - ูข| = |ูค| = ูค</span>. ุจูุง ุฃู <span class="math-eq">ูค โค ูค</span>ุ ูุงูุนุจุงุฑุฉ ุตุญูุญุฉ. ุฅุฐูุ ุงูุญู ูุฌุจ ุฃู ูุดูู ูฆ. ูุฐุง ููุบู ุงูุฎูุงุฑูู (ุจ) ู (ุฌ) ูุฃูููุง ูุง ูุญุฏุฏุงู ุงูุทุฑู ุงูุขุฎุฑ.</p>`
            },
            { 
                type: 'mcq', level: 'โญโญ', text: `ุญู ุงููุชุจุงููุฉ <span class="math-eq">|ูขุฃ + ูก| > ูฅ</span>`,
                options: [ 
                    { display: '<span class="math-eq">-ูฃ < ุฃ < ูข</span>', value: 'A' }, 
                    { display: '<span class="math-eq">ุฃ > ูข</span>', value: 'B' }, 
                    { display: '<span class="math-eq">ุฃ < -ูฃ</span>', value: 'C' }, 
                    { display: '<span class="math-eq">ุฃ > ูข</span> ุฃู <span class="math-eq">ุฃ < -ูฃ</span>', value: 'D' }
                ], 
                correct: 'D',
                explanation: `<p>ูุฐู ูุชุจุงููุฉ "ุฃูุจุฑ ูู"ุ ูุฐุง ูุญูููุง ุฅูู ูุชุจุงููุฉ ูุฑูุจุฉ ุจุฃุฏุงุฉ ุงูุฑุจุท "ุฃู".</p><p>ุงูุญุงูุฉ ุงูุฃููู: <span class="math-eq">ูขุฃ + ูก > ูฅ</span> โ <span class="math-eq">ูขุฃ > ูค</span> โ <span class="math-eq">ุฃ > ูข</span>.</p><p>ุงูุญุงูุฉ ุงูุซุงููุฉ: <span class="math-eq">ูขุฃ + ูก < -ูฅ</span> โ <span class="math-eq">ูขุฃ < -ูฆ</span> โ <span class="math-eq">ุฃ < -ูฃ</span>.</p><p>ุงูุญู ูู ุงุชุญุงุฏ ุงูุญููู: <span class="math-eq">ุฃ > ูข</span> ุฃู <span class="math-eq">ุฃ < -ูฃ</span>.</p>`,
            },
            {
                type: 'mcq', level: 'โญโญ', text: 'ุฃู ูุชุจุงููุฉ ููุซููุง ุงูุฑุณู ุงูุจูุงูู ุงูุชุงููุ<div class="option-nl-wrapper my-4"><div class="option-nl-ticks"><div class="option-nl-tick" style="left: 20%;"><span>-ูก</span></div><div class="option-nl-tick" style="left: 50%;"><span>ูข</span></div><div class="option-nl-tick" style="left: 80%;"><span>ูฅ</span></div><div class="option-nl-line"><div class="option-nl-sol-line" style="left: 0%; width: 20%;"></div><div class="option-nl-sol-point open" style="left: 20%;"></div><div class="option-nl-sol-line" style="left: 80%; width: 20%;"></div><div class="option-nl-sol-point open" style="left: 80%;"></div></div></div></div>',
                options: [
                    { value: 'A', display: `<span class="math-eq">|ุณ - ูข| > ูฃ</span>` },
                    { value: 'B', display: `<span class="math-eq">|ุณ - ูข| < ูฃ</span>` },
                    { value: 'C', display: `<span class="math-eq">|ุณ - ูฃ| > ูข</span>` },
                    { value: 'D', display: `<span class="math-eq">|ุณ - ูฃ| < ูข</span>` }
                ],
                correct: 'A',
                explanation: '<p>ุงูุฑุณู ููุซู <span class="math-eq">ุณ < -ูก</span> ุฃู <span class="math-eq">ุณ > ูฅ</span>. ูุฅูุฌุงุฏ ูุชุจุงููุฉ ุงููููุฉ ุงููุทููุฉุ ููุฌุฏ ููุทุฉ ุงูููุชุตู: <span class="math-eq"><span class="fraction"><span>(-ูก+ูฅ)</span><span class="frac-bar"></span><span>ูข</span></span> = ูข</span>. ุซู ููุฌุฏ ุงููุณุงูุฉ ูู ุงูููุชุตู ุฅูู ุฃุญุฏ ุงูุทุฑููู: <span class="math-eq">|ูฅ - ูข| = ูฃ</span>. ุจูุง ุฃู ุงูุฃุณูู ุชุชุฌู ููุฎุงุฑุฌุ ูุงููุชุจุงููุฉ ุชุณุชุฎุฏู ุนูุงูุฉ "ุฃูุจุฑ ูู": <span class="math-eq">|ุณ - ูข| > ูฃ</span>.</p>',
                smartExplanation: `<p>ุจูุง ุฃู ุงูุนุฏุฏ ูข ููุน ูู ููุชุตู ุงููุณุงูุฉ ุจูู -ูก ู ูฅุ ูุฅู ุงูุนุจุงุฑุฉ ุฏุงุฎู ุงููููุฉ ุงููุทููุฉ ุณุชููู <span class="math-eq">|ุณ - ูข|</span>.</p><p>ุงููุณุงูุฉ ุจูู ููุทุฉ ุงูููุชุตู (ูข) ูุฃุญุฏ ุงูุทุฑููู (ูฅ) ูู ูฃ ูุญุฏุงุช (<span class="math-eq">|ูฅ - ูข| = ูฃ</span>). ููุฃู ุงูุชูุซูู ุงูุจูุงูู ูุชุฌู ููุฎุงุฑุฌุ ูุณุชุฎุฏู ุนูุงูุฉ "ุฃูุจุฑ ูู" (>).</p><p>ุฅุฐูุงุ ุงููุชุจุงููุฉ ูู <span class="math-eq">|ุณ - ูข| > ูฃ</span>.</p>`
            },
            {
                type: 'mcq', level: 'โญโญโญ', text: 'ูู ุฅุญุฏู ุงูุตูุงุนุงุชุ ูุฌุจ ุฃู ูููู ูุทุฑ ูุถูุจ ุงูุญุฏูุฏ ุงูููุชุฌ <span class="math-eq">ูฅ.ูฆ</span> ุณูุ ุจูุงูุด ุฎุทุฃ ูุง ูุฒูุฏ ุนู <span class="math-eq">ู.ููข</span> ุณู. ุฃู ูุชุจุงููุฉ ุชูุซู ุงููุทุฑ ุงูููุจูู (ู)ุ',
                options: [
                    { display: '<span class="math-eq">|ู - ู.ููข| โค ูฅ.ูฆ</span>', value: 'A' },
                    { display: '<span class="math-eq">|ู - ูฅ.ูฆ| โค ู.ููข</span>', value: 'B' },
                    { display: '<span class="math-eq">|ู - ูฅ.ูฆ| โฅ ู.ููข</span>', value: 'C' },
                    { display: '<span class="math-eq">|ู + ูฅ.ูฆ| โค ู.ููข</span>', value: 'D' }
                ],
                correct: 'B',
                explanation: '<p>ุงููููุฉ ุงููุทููุฉ ุชุณุชุฎุฏู ููุชุนุจูุฑ ุนู ุงููุณุงูุฉ ุฃู ุงููุฑู. ุงูุฌููุฉ ุชุนูู ุฃู "ุงููุฑู ุจูู ุงููุทุฑ ุงููุนูู (ู) ูุงููุทุฑ ุงููุซุงูู (ูฅ.ูฆ) ูุฌุจ ุฃู ูููู ุฃูู ูู ุฃู ูุณุงูู (ูุง ูุฒูุฏ ุนู) ูุงูุด ุงูุฎุทุฃ (ู.ููข)".</p><p>ูุชุฑุฌู ูุฐุง ูุจุงุดุฑุฉ ุฅูู ุงููุชุจุงููุฉ: <span class="math-eq">|ู - ูฅ.ูฆ| โค ู.ููข</span>.</p>'
            },
            { 
                type: 'mcq', level: 'โญโญ', text: `ูุง ูู ูุฌููุนุฉ ุญู ุงููุชุจุงููุฉ <span class="math-eq">|ุณ + ูฃ| < -ูค</span>ุ`,
                options: [ 
                    { display: '<span class="math-eq">{ุณ | ุณ < -ูง}</span>', value: 'A' }, 
                    { display: '<span class="math-eq">{ุณ | ุณ > ูก}</span>', value: 'B' }, 
                    { display: 'ุงููุฌููุนุฉ ุงูุฎุงููุฉ (โ)', value: 'C' }, 
                    { display: 'ุฌููุน ุงูุฃุนุฏุงุฏ ุงูุญููููุฉ', value: 'D' }
                ], 
                correct: 'C',
                explanation: `<p>ุงููููุฉ ุงููุทููุฉ ูุฃู ุนุฏุฏ ูู ุฏุงุฆูุงู ูููุฉ ููุฌุจุฉ ุฃู ุตูุฑ. ูุฐููุ ูู ุงููุณุชุญูู ุฃู ุชููู ุงููููุฉ ุงููุทููุฉ ุฃูู ูู ุนุฏุฏ ุณุงูุจ ูุซู -ูค. ุฅุฐูุ ูุง ููุฌุฏ ุญู ููุฐู ุงููุชุจุงููุฉ.</p>`,
            },
            { 
                type: 'mcq', level: 'โญโญ', text: `ูุง ูู ูุฌููุนุฉ ุญู ุงููุชุจุงููุฉ <span class="math-eq">|ุณ - ูฉ| โฅ -ูฅ</span>ุ`,
                options: [ 
                    { display: '<span class="math-eq">{ุณ | ุณ โฅ ูกูค}</span>', value: 'A' }, 
                    { display: '<span class="math-eq">{ุณ | ุณ โค ูค}</span>', value: 'B' }, 
                    { display: 'ุงููุฌููุนุฉ ุงูุฎุงููุฉ (โ)', value: 'C' }, 
                    { display: 'ุฌููุน ุงูุฃุนุฏุงุฏ ุงูุญููููุฉ', value: 'D' }
                ], 
                correct: 'D',
                explanation: `<p>ุงููููุฉ ุงููุทููุฉ ุฏุงุฆูุงู ุชูุชุฌ ูููุฉ ููุฌุจุฉ ุฃู ุตูุฑ. ุฃู ูููุฉ ููุฌุจุฉ ุฃู ุตูุฑ ูู ุฏุงุฆูุงู ุฃูุจุฑ ูู ุฃู ุชุณุงูู ุนุฏุฏุงู ุณุงูุจุงู ูุซู -ูฅ. ูุฐููุ ูุฐู ุงููุชุจุงููุฉ ุตุญูุญุฉ ูุฌููุน ุงูุฃุนุฏุงุฏ ุงูุญููููุฉ.</p>`,
            },
            { 
                type: 'mcq', level: 'โญโญโญ', text: `ุญู ุงููุชุจุงููุฉ <span class="math-eq">|<span class="fraction"><span>ู</span><span class="frac-bar"></span><span>ูข</span></span> - ูก| โฅ ูฃ</span>`,
                options: [ 
                    { display: '<span class="math-eq">ู โฅ ูจ</span>', value: 'A' }, 
                    { display: '<span class="math-eq">ู โค -ูค</span>', value: 'B' }, 
                    { display: '<span class="math-eq">-ูค โค ู โค ูจ</span>', value: 'C' }, 
                    { display: '<span class="math-eq">ู โค -ูค</span> ุฃู <span class="math-eq">ู โฅ ูจ</span>', value: 'D' }
                ], 
                correct: 'D',
                explanation: `<p>ูุญููุง ููุชุจุงููุฉ "ุฃู".</p><p>ุงูุญุงูุฉ ุงูุฃููู: <span class="math-eq"><span class="fraction"><span>ู</span><span class="frac-bar"></span><span>ูข</span></span> - ูก โฅ ูฃ</span> โ <span class="math-eq"><span class="fraction"><span>ู</span><span class="frac-bar"></span><span>ูข</span></span> โฅ ูค</span> โ <span class="math-eq">ู โฅ ูจ</span>.</p><p>ุงูุญุงูุฉ ุงูุซุงููุฉ: <span class="math-eq"><span class="fraction"><span>ู</span><span class="frac-bar"></span><span>ูข</span></span> - ูก โค -ูฃ</span> โ <span class="math-eq"><span class="fraction"><span>ู</span><span class="frac-bar"></span><span>ูข</span></span> โค -ูข</span> โ <span class="math-eq">ู โค -ูค</span>.</p><p>ุงูุญู ูู ุงุชุญุงุฏ ุงูุญููู.</p>`,
            },
            { 
                type: 'mcq', level: 'โญโญโญ', text: `ุญู ุงููุชุจุงููุฉ <span class="math-eq">ูข|ุณ - ูก| + ูค โค ูกูข</span>`,
                options: [ 
                    { display: '<span class="math-eq">-ูฃ โค ุณ โค ูฅ</span>', value: 'A' }, 
                    { display: '<span class="math-eq">ุณ โค ูฅ</span>', value: 'B' }, 
                    { display: '<span class="math-eq">ุณ โฅ -ูฃ</span>', value: 'C' }, 
                    { display: '<span class="math-eq">ุณ โค -ูฃ</span> ุฃู <span class="math-eq">ุณ โฅ ูฅ</span>', value: 'D' }
                ], 
                correct: 'A',
                explanation: `<p>ุฃููุงูุ ูุฌุจ ุนุฒู ุงููููุฉ ุงููุทููุฉ.</p><p>ูก. ุงุทุฑุญ ูค: <span class="math-eq">ูข|ุณ - ูก| โค ูจ</span></p><p>ูข. ุงูุณู ุนูู ูข: <span class="math-eq">|ุณ - ูก| โค ูค</span></p><p>ูฃ. ุงูุขู ุญููุง ููุชุจุงููุฉ "ู": <span class="math-eq">-ูค โค ุณ - ูก โค ูค</span></p><p>ูค. ุฃุถู ูก: <span class="math-eq">-ูฃ โค ุณ โค ูฅ</span></p>`,
            },
            {
                type: 'mcq', level: 'โญ', text: 'ุฃู ุชูุซูู ุจูุงูู ููุซู ุญู ุงููุชุจุงููุฉ <span class="math-eq">|ุณ| โฅ ูฃ</span>ุ',
                options: [
                    { value: 'A', display: `<div class="option-nl-wrapper"><div class="option-nl-ticks"><div class="option-nl-tick" style="left: 20%;"><span>-ูฃ</span></div><div class="option-nl-tick" style="left: 80%;"><span>ูฃ</span></div><div class="option-nl-line"><div class="option-nl-sol-line" style="left: 0%; width: 20%;"></div><div class="option-nl-sol-point closed" style="left: 20%;"></div><div class="option-nl-sol-line" style="left: 80%; width: 20%;"></div><div class="option-nl-sol-point closed" style="left: 80%;"></div></div></div></div>` },
                    { value: 'B', display: `<div class="option-nl-wrapper"><div class="option-nl-ticks"><div class="option-nl-tick" style="left: 20%;"><span>-ูฃ</span></div><div class="option-nl-tick" style="left: 80%;"><span>ูฃ</span></div><div class="option-nl-line"><div class="option-nl-sol-line" style="left: 20%; width: 60%;"></div><div class="option-nl-sol-point closed" style="left: 20%;"></div><div class="option-nl-sol-point closed" style="left: 80%;"></div></div></div></div>` },
                    { value: 'C', display: `<div class="option-nl-wrapper"><div class="option-nl-ticks"><div class="option-nl-tick" style="left: 20%;"><span>-ูฃ</span></div><div class="option-nl-tick" style="left: 80%;"><span>ูฃ</span></div><div class="option-nl-line"><div class="option-nl-sol-line" style="left: 0%; width: 20%;"></div><div class="option-nl-sol-point open" style="left: 20%;"></div><div class="option-nl-sol-line" style="left: 80%; width: 20%;"></div><div class="option-nl-sol-point open" style="left: 80%;"></div></div></div></div>` },
                ],
                correct: 'A',
                explanation: '<p>ุงููุชุจุงููุฉ <span class="math-eq">|ุณ| โฅ ูฃ</span> ุชุนูู <span class="math-eq">ุณ โฅ ูฃ</span> ุฃู <span class="math-eq">ุณ โค -ูฃ</span>.</p><p>ูุฐุง ููุซู ุดุนุงุนูู ูุชุฌููู ููุฎุงุฑุฌ. ุงูุฅุดุงุฑุฉ <span class="math-eq">โฅ</span> ุชุนูู ุฃู ุงูุฏูุงุฆุฑ ุนูุฏ <span class="highlight-number">-ูฃ</span> ู <span class="highlight-number">ูฃ</span> ูุฌุจ ุฃู ุชููู ูุบููุฉ.</p>'
            },
            {
                type: 'mcq', level: 'โญโญโญ', text: 'ูุฌุจ ุฃู ุชููู ุฏุฑุฌุฉ ุญุฑุงุฑุฉ ูุญุฑู ุงูุณูุงุฑุฉ (ุฏ) ุจูู ูงูฅยฐ ู ูกููฅยฐ. ุฃู ูุชุจุงููุฉ ูููุฉ ูุทููุฉ ุชูุซู ูุฐุง ุงููุฏูุ',
                options: [
                    { display: '<span class="math-eq">|ุฏ - ูฉู| โค ูกูฅ</span>', value: 'A' },
                    { display: '<span class="math-eq">|ุฏ - ูกูฅ| โค ูฉู</span>', value: 'B' },
                    { display: '<span class="math-eq">|ุฏ - ูงูฅ| โค ูฃู</span>', value: 'C' },
                    { display: '<span class="math-eq">|ุฏ - ูกููฅ| โค ูฃู</span>', value: 'D' }
                ],
                correct: 'A',
                explanation: '<p>ูุฅูุฌุงุฏ ุงููุฑูุฒุ ูุญุณุจ ุงููุชูุณุท: <span class="math-eq">(ูงูฅ + ูกููฅ) / ูข = ูฉู</span>. ูุฅูุฌุงุฏ ููุฏุงุฑ ุงูุชูุงูุชุ ูุญุณุจ ุงููุณุงูุฉ ูู ุงููุฑูุฒ ุฅูู ุฃุญุฏ ุงูุทุฑููู: <span class="math-eq">ูกููฅ - ูฉู = ูกูฅ</span>. ุจูุง ุฃู ุงููุฏู ูุดูู ุงูุทุฑููู ("ุจูู")ุ ูุณุชุฎุฏู ุนูุงูุฉ "ุฃุตุบุฑ ูู ุฃู ูุณุงูู": <span class="math-eq">|ุฏ - ูฉู| โค ูกูฅ</span>.</p>'
            },
            { 
                type: 'mcq', level: 'โญโญ', text: `ุญู ุงููุชุจุงููุฉ <span class="math-eq">|ูฃู + ูฆ| < ูกูฅ</span>`,
                options: [ 
                    { display: '<span class="math-eq">-ูง < ู < ูฃ</span>', value: 'A' }, 
                    { display: '<span class="math-eq">ู < ูฃ</span>', value: 'B' }, 
                    { display: '<span class="math-eq">ู > -ูง</span>', value: 'C' }, 
                    { display: '<span class="math-eq">ู < -ูง</span> ุฃู <span class="math-eq">ู > ูฃ</span>', value: 'D' }
                ], 
                correct: 'A',
                explanation: `<p>ูุญููุง ููุชุจุงููุฉ "ู":</p><p>ูก. <span class="math-eq">-ูกูฅ < ูฃู + ูฆ < ูกูฅ</span></p><p>ูข. ุงุทุฑุญ ูฆ: <span class="math-eq">-ูขูก < ูฃู < ูฉ</span></p><p>ูฃ. ุงูุณู ุนูู ูฃ: <span class="math-eq">-ูง < ู < ูฃ</span></p>`,
            }
        ];
        
        const shuffled = [...questionBank].sort(() => 0.5 - Math.random());
        const questionCount = Math.min(shuffled.length, 5);
        return shuffled.slice(0, questionCount);
    }

    document.addEventListener('DOMContentLoaded', () => {
        const exampleContainers = document.querySelectorAll('[id^="interactive-container-"]');
        const state = {};
        exampleContainers.forEach(container => {
            const exampleId = container.id.split('-')[2];
            state[exampleId] = { currentIndex: -1, steps: container.querySelectorAll('.step-interactive'), placeholder: container.querySelector('.interactive-placeholder'), prevBtn: container.querySelector('.prev-btn'), nextBtn: container.querySelector('.next-btn'), resetBtn: container.querySelector('.reset-btn') };
            const resetExample = () => { state[exampleId].steps.forEach(step => step.classList.remove('active')); state[exampleId].currentIndex = -1; if (state[exampleId].placeholder) { state[exampleId].placeholder.classList.remove('hidden'); } updateButtons(); };
            const updateButtons = () => { 
                const isFirstStep = state[exampleId].currentIndex <= -1; 
                const isLastStep = state[exampleId].currentIndex >= state[exampleId].steps.length - 1; 
                state[exampleId].prevBtn.disabled = isFirstStep; 
                if (isLastStep) { 
                    state[exampleId].nextBtn.classList.add('hidden'); 
                    if(state[exampleId].resetBtn) state[exampleId].resetBtn.classList.remove('hidden'); 
                } else { 
                    state[exampleId].nextBtn.classList.remove('hidden'); 
                    if(state[exampleId].resetBtn) state[exampleId].resetBtn.classList.add('hidden'); 
                } 
            };
            
            state[exampleId].nextBtn.addEventListener('click', () => {
                if (state[exampleId].currentIndex < state[exampleId].steps.length - 1) {
                    if (state[exampleId].currentIndex === -1 && state[exampleId].placeholder) {
                        state[exampleId].placeholder.classList.add('hidden');
                    }
                    state[exampleId].currentIndex++;
                    state[exampleId].steps[state[exampleId].currentIndex].classList.add('active');
                    updateButtons();
                }
            });
            state[exampleId].prevBtn.addEventListener('click', () => {
                if (state[exampleId].currentIndex > -1) {
                    if(state[exampleId].steps[state[exampleId].currentIndex]) {
                       state[exampleId].steps[state[exampleId].currentIndex].classList.remove('active');
                    }
                    state[exampleId].currentIndex--;
                     if (state[exampleId].currentIndex === -1 && state[exampleId].placeholder) {
                         state[exampleId].placeholder.classList.remove('hidden');
                     }
                    updateButtons();
                }
            });

            if(state[exampleId].resetBtn) { state[exampleId].resetBtn.addEventListener('click', resetExample); }
            updateButtons();
        });

        const student = getStudentFromStorage();
        const lessonTitleElement = document.getElementById('lesson-title');
        const lessonTitle = lessonTitleElement ? lessonTitleElement.textContent : null;
        buildHeader(student, lessonTitle);
        buildFooter();
        const questions = generateQuiz();
        initializeQuiz(LESSON_ID, questions, student);
        const retakeBtn = document.getElementById('retake-quiz-btn');
        if(retakeBtn) { retakeBtn.addEventListener('click', () => { window.location.reload(); }); }
        
        const closeModalBtn = document.getElementById('closeModalBtn');
        if(closeModalBtn) closeModalBtn.addEventListener('click', closeModal);
        
        const closeSmartModalBtn = document.getElementById('closeSmartModalBtn');
        if(closeSmartModalBtn) closeSmartModalBtn.addEventListener('click', closeSmartModal);
    });
    </script>
</body>
</html>
