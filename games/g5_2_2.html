<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ุงูุญู ุจุงูุชุนููุถ 2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            direction: rtl;
            overscroll-behavior: none;
            background-color: #f0fdf4;
            height: 100dvh;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
            padding: 10px;
            box-sizing: border-box;
        }

        .equation-font {
            font-family: 'Times New Roman', serif;
            font-size: 1.15rem; 
            font-weight: 700;
            text-align: center;
            direction: rtl; 
            unicode-bidi: isolate;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 3px;
            white-space: nowrap;
        }

        .fraction {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            vertical-align: middle;
            margin: 0 3px;
            font-size: 0.85em; 
        }
        .numerator {
            border-bottom: 1.5px solid #000; 
            padding: 0 2px;
            text-align: center;
            width: 100%;
        }
        .denominator {
            padding: 0 2px;
            text-align: center;
            width: 100%;
        }

        .game-card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 480px; 
            padding: 1rem; 
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            max-height: 100%;
            overflow-y: auto;
            scroll-behavior: smooth;
        }

        .problem-area {
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            padding: 0.5rem; 
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .main-equations {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.75rem; 
            width: 100%;
            border-bottom: 2px dashed #cbd5e1;
            padding-bottom: 0.5rem;
            margin-bottom: 0.25rem;
            transition: all 0.5s ease;
        }
        
        .main-equations.faded {
            opacity: 0.5;
            filter: grayscale(100%);
        }

        .eq-badge {
            background: white;
            border: 1px solid #94a3b8;
            padding: 0.3rem 0.8rem; 
            border-radius: 0.5rem;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
            color: #1e40af;
        }

        .history-step {
            background-color: #dcfce7;
            border: 1px solid #86efac;
            color: #166534;
            padding: 0.4rem; 
            border-radius: 0.5rem;
            width: 100%;
            text-align: center;
            animation: fadeIn 0.5s ease-out;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.2rem;
            font-size: 0.9rem;
        }
        
        .history-step.modification-step {
            background-color: #ecfdf5;
            border: 2px solid #10b981;
            flex-direction: column;
            gap: 0.4rem;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #interaction-area {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            width: 100%;
        }

        .choices-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem; 
            width: 100%;
        }

        .choice-button {
            width: 100%;
            padding: 0.3rem; 
            background-color: #ffffff;
            border: 2px solid #e5e7eb;
            border-radius: 0.6rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            transition: all 0.2s;
            cursor: pointer;
            min-height: 3.5rem; 
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .choice-button .btn-content {
            font-family: 'Times New Roman', serif;
            font-size: 0.95rem; 
            font-weight: 700;
            direction: rtl; 
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 2px; 
        }
        
        .choice-button.text-choice .btn-content {
            font-family: 'Cairo', sans-serif;
            direction: rtl;
            font-size: 0.9rem;
        }

        .choice-button:hover:not(:disabled) {
            border-color: #3b82f6;
            background-color: #f0f9ff;
        }
        .choice-button:disabled {
            cursor: default;
            opacity: 0.7;
        }
        .choice-button.correct {
            border-color: #16a34a !important;
            background-color: #dcfce7 !important;
            color: #15803d;
        }
        .choice-button.incorrect {
            border-color: #dc2626 !important;
            background-color: #fee2e2 !important;
            color: #991b1b;
        }

        .action-btn {
            width: 100%;
            padding: 0.6rem; 
            border-radius: 0.5rem;
            font-weight: bold;
            font-size: 0.95rem; 
            transition: 0.2s;
            text-align: center;
            color: white;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            cursor: pointer;
        }
        .btn-blue { background-color: #2563eb; }
        .btn-green { background-color: #16a34a; }
        .btn-gray { background-color: #9ca3af; color: #1f2937; }
        .btn-yellow { background-color: #eab308; color: #713f12; }
        .btn-yellow:hover { background-color: #ca8a04; }

        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.7);
            display: flex; align-items: center; justify-content: center;
            z-index: 50; opacity: 0; visibility: hidden; transition: 0.3s;
            padding: 1rem;
        }
        .modal-overlay.show { opacity: 1; visibility: visible; }
        
        .modal-box {
            background: white; padding: 1.5rem; border-radius: 1rem;
            width: 100%; max-width: 420px; 
            text-align: center;
            transform: scale(0.9); transition: 0.3s;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }
        .modal-overlay.show .modal-box { transform: scale(1); }

        .score-badge {
            background: #fef3c7;
            color: #d97706;
            padding: 0.15rem 0.5rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: bold;
            margin-right: auto;
        }
        
        .time-badge {
            background: #e0f2fe;
            color: #0284c7;
            padding: 0.15rem 0.5rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: bold;
            margin-right: 0.5rem;
        }

        /* ุชูุณูู ุงูุดุฑุญ ุงูุชูุตููู */
        .explanation-content ul, .explanation-content ol {
            text-align: right;
            margin-right: 0.5rem;
            margin-top: 0.5rem;
        }
        .explanation-content li {
            margin-bottom: 0.5rem;
            line-height: 1.6;
            font-size: 0.9rem;
            color: #374151;
        }
        .step-highlight {
            background-color: #f3f4f6;
            padding: 1px 5px;
            border-radius: 4px;
            font-family: 'Times New Roman', serif;
            font-weight: bold;
            display: inline-block;
            direction: ltr; 
        }
        .original-eq-box {
            background-color: #eff6ff;
            border: 1px solid #bfdbfe;
            padding: 0.5rem;
            border-radius: 0.5rem;
            margin-bottom: 0.75rem;
            text-align: center;
        }
        .original-eq-label {
            display: block;
            color: #6b7280;
            font-size: 0.8rem;
            margin-bottom: 0.2rem;
        }
        .result-eq-box {
            background-color: #dcfce7;
            border: 1px solid #86efac;
            padding: 0.5rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            text-align: center;
        }
        .result-eq-label {
            display: block;
            color: #15803d;
            font-size: 0.9rem;
            margin-bottom: 0.2rem;
            font-weight: bold;
        }
        .eq-display {
            font-family: 'Times New Roman', serif;
            font-size: 1.25rem;
            font-weight: bold;
            color: #1e40af;
            direction: rtl;
        }
        .result-eq-display {
            font-family: 'Times New Roman', serif;
            font-size: 1.3rem;
            font-weight: bold;
            color: #166534;
            direction: rtl;
        }
        .highlight-num {
            color: #dc2626;
            font-weight: 900;
            font-size: 1.1em;
        }
        .dist-highlight {
            color: #dc2626; 
            font-weight: 900;
            font-size: 1.1em;
        }
        .step-label {
            font-weight: bold;
            color: #166534;
            margin-bottom: 4px;
            display: block;
            text-align: right;
            font-size: 1rem;
        }
    </style>
</head>
<body>

    <!-- ุดุงุดุฉ ุงูุจุฏุงูุฉ -->
    <div id="welcome-screen" class="modal-overlay show">
        <div class="modal-box">
            <h1 class="text-xl font-bold text-red-700 mb-2">ุงูุญู ุจุงูุชุนููุถ 2</h1>
            <p class="text-gray-600 mb-3 text-sm">
                ุชุญุฏู ุงููุนุงุฏูุงุช ุงูุฎุทูุฉ ุงูุตุนุจุฉ.<br>
                ุฌููุน ุงููุณุงุฆู ุชุญุชุงุฌ ูุชุนุฏูู ูุฑูุจ (ูุณูุฑ).<br>
                ุนุฏุฏ ุงูุฃุณุฆูุฉ: ูฃ ููุท.
            </p>
            <div class="bg-red-50 p-3 rounded-lg text-xs text-red-800 mb-5 text-right">
                <p><strong>ุชุนูููุงุช ูุงูุฉ:</strong></p>
                <ul class="list-disc list-inside">
                    <li>ูุฌุจ ุนุฒู ุงููุชุบูุฑ (ุณ ุฃู ุต) ุญุชู ูู ูุชุฌ ูุณุฑ.</li>
                    <li>ุงุณุชุฎุฏู ุงููุฑูุฉ ูุงูููู ูููุณุงุนุฏุฉ ูู ุงูุญุณุงุจุงุช.</li>
                    <li>ููุน ุงููุธุงู (ุญู ูุญูุฏุ ูุณุชุญููุฉุ ูุง ููุงุฆู) ุณูุธูุฑ ุนุดูุงุฆูุงู.</li>
                </ul>
            </div>
            <button onclick="startGame()" class="action-btn btn-blue">
                ุงุจุฏุฃ ุงูุชุญุฏู
            </button>
            <p class="text-xs text-gray-400 mt-4 font-semibold">
                ุชุตููู ูุชุทููุฑ: ุงูุฃุณุชุงุฐ ุนุจุฏ ุงูุนุฒูุฒ ุฎุงูุฏ ุงูุนุจูุงู
            </p>
        </div>
    </div>

    <!-- ูุงุฌูุฉ ุงููุนุจุฉ -->
    <div id="game-ui" class="game-card hidden">
        <div class="flex items-center mb-2 px-1 w-full">
            <h2 id="question-counter" class="text-base font-bold text-gray-700">ุงููุณุฃูุฉ ูก ูู ูฃ</h2>
            <div id="current-score-display" class="score-badge">ุงูููุงุท: ู</div>
            <div id="time-display" class="time-badge">โฑ๏ธ ูู:ูู</div>
            <button onclick="location.reload()" class="text-red-500 font-bold text-lg mr-2">โ</button>
        </div>

        <div class="problem-area" id="problem-area">
            <div class="main-equations" id="main-equations">
                <div id="eq1" class="equation-font eq-badge"></div>
                <div id="eq2" class="equation-font eq-badge"></div>
            </div>
            <div id="steps-history" class="w-full flex flex-col"></div>
        </div>

        <div id="interaction-area">
            <p id="prompt-text" class="text-center text-blue-600 font-bold text-xs my-2">ุงููุทููุจ: ุงุฎุชุฑ ุงูุฎุทูุฉ ุงูุตุญูุญุฉ</p>
            <div id="options-grid" class="choices-grid"></div>
        </div>

        <!-- ููุทูุฉ ุงูุชุบุฐูุฉ ุงูุฑุงุฌุนุฉ -->
        <div id="feedback-container" class="mt-3 flex flex-col items-center gap-2 min-h-[35px]">
            <div class="flex items-center gap-3">
                <div id="feedback-message" class="text-base font-bold"></div>
                <button id="explain-btn" onclick="showDetailedExplanation()" class="hidden px-3 py-1 bg-yellow-100 text-yellow-800 border border-yellow-300 rounded-full text-xs font-bold hover:bg-yellow-200 transition shadow-sm whitespace-nowrap">
                    ุงุนุฑู ููุงุฐุงุ ๐ก
                </button>
            </div>
            <button id="next-btn" onclick="nextStep()" class="action-btn btn-green mt-1 hidden">ุงูุฎุทูุฉ ุงูุชุงููุฉ</button>
        </div>
    </div>

    <!-- ูุงูุฐุฉ ุงูุดุฑุญ ุงูุชูุตููู -->
    <div id="detailed-explanation-modal" class="modal-overlay">
        <div class="modal-box text-right relative">
            <button onclick="hideDetailedExplanation()" class="absolute top-3 left-3 text-gray-400 hover:text-gray-600 text-lg font-bold">โ</button>
            <h3 class="text-lg font-bold text-blue-700 mb-3 text-center border-b pb-2">ุชูุถูุญ ุงูุฎุทูุฉ</h3>
            
            <div id="explanation-content" class="explanation-content text-gray-700 text-sm leading-relaxed"></div>
            
            <div class="mt-4">
                <button onclick="hideDetailedExplanation()" class="action-btn btn-blue py-2 text-sm">ูููุชุ ุดูุฑุงู ๐</button>
            </div>
        </div>
    </div>

    <!-- ุดุงุดุฉ ุงูููุงูุฉ -->
    <div id="end-screen" class="modal-overlay">
        <div class="modal-box">
            <h2 class="text-2xl font-bold text-green-600 mb-2">๐ ุงูุชูู ุงูุชุญุฏู!</h2>
            <div class="bg-gray-50 p-4 rounded-lg mb-4">
                <p class="text-gray-600 text-xs mb-1">ูุฌููุน ุงูููุงุท:</p>
                <p id="points-display" class="text-lg font-bold text-gray-800 mb-2"></p>
                <div class="border-t border-gray-300 my-2"></div>
                <p class="text-gray-600 text-xs mb-1">ุงูููุช ุงููุณุชุบุฑู:</p>
                <p id="final-time-display" class="text-lg font-bold text-blue-600 mb-2"></p>
                <div class="border-t border-gray-300 my-2"></div>
                <p class="text-blue-700 font-bold text-base mb-1">ุงูุฏุฑุฌุฉ ุงูููุงุฆูุฉ:</p>
                <p id="final-grade-display" class="text-3xl font-bold text-blue-600"></p>
            </div>
            <div id="save-status" class="text-xs text-gray-500 mb-3 h-5"></div>
            <button onclick="location.reload()" class="action-btn btn-gray text-white text-sm">ูุญุงููุฉ ุฃุฎุฑู</button>
            <p class="text-xs text-gray-400 mt-4 font-semibold">
                ุชุตููู ูุชุทููุฑ: ุงูุฃุณุชุงุฐ ุนุจุฏ ุงูุนุฒูุฒ ุฎุงูุฏ ุงูุนุจูุงู
            </p>
        </div>
    </div>

    <script>
        function createFraction(num, den) {
            return `<div class="fraction"><span class="numerator">${num}</span><span class="denominator">${den}</span></div>`;
        }

        function createMultiLineOption(line1, line2) {
            return `<div class="flex flex-col items-center gap-1 w-full"><span>${line1}</span><span>${line2}</span></div>`;
        }

        function toArabicNum(str) {
            return str.toString().replace(/\d/g, d => "ููกูขูฃูคูฅูฆูงูจูฉ"[d]).replace(/-/g, 'โ');
        }

        // --- ุจูู ุงูุฃุณุฆูุฉ ูุน ุดุฑูุญุงุช ุชุนููููุฉ ูุงููุฉ ูููุตูุฉ ---
        const hardQuestions = {
            intersection: [
                {
                    eq1HTML: `ูฃุณ + ูคุต = ูกูก`, 
                    eq2HTML: `ูขุณ โ ูฅุต = โูจ`,
                    steps: [
                        {
                            label: "ุชุนุฏูู ุงููุนุงุฏูุฉ",
                            prompt: "ูุง ููุฌุฏ ูุชุบูุฑ ูุนุฒูู. ุงุนุฒู (ุณ) ูู ุงููุนุงุฏูุฉ ุงูุฃููู:",
                            correctHTML: `ุณ = ${createFraction('ูกูก โ ูคุต', 'ูฃ')}`,
                            optionsHTML: [`ุณ = ${createFraction('ูกูก โ ูคุต', 'ูฃ')}`, `ุณ = ${createFraction('ูกูก + ูคุต', 'ูฃ')}`],
                            type: "modification",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูฃุณ + ูคุต = ูกูก</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><ul class="list-disc list-inside space-y-2"><li>ูููู ูคุต ููุทุฑู ุงูุขุฎุฑ ูุชุชุบูุฑ ุฅุดุงุฑุชูุง ูุชุตุจุญ ุณุงูุจุฉ.</li><li>ููุณู ุนูู ูฃ.</li></ul><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ (ุงููุนุงุฏูุฉ ุงูุฌุฏูุฏุฉ)</span><span class="result-eq-display">ุณ = ${createFraction('ูกูก โ ูคุต', 'ูฃ')}</span></div>`,
                            newEqs: [`ุณ = ${createFraction('ูกูก โ ูคุต', 'ูฃ')}`, `ูขุณ โ ูฅุต = โูจ`]
                        },
                        {
                            label: "ุงูุชุนููุถ",
                            prompt: "ุนูุถ ุจูููุฉ ุณ ูู ุงููุนุงุฏูุฉ ุงูุซุงููุฉ:",
                            correctHTML: `ูข(${createFraction('ูกูก โ ูคุต', 'ูฃ')}) โ ูฅุต = โูจ`,
                            optionsHTML: [`ูข(${createFraction('ูกูก โ ูคุต', 'ูฃ')}) โ ูฅุต = โูจ`, `${createFraction('ูกูก โ ูคุต', 'ูฃ')} โ ูฅุต = โูจ`],
                            type: "sub",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุซุงููุฉ</span><span class="eq-display">ูขุณ โ ูฅุต = โูจ</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><ul class="list-disc list-inside"><li>ุนุฑููุง ูู ุงูุฎุทูุฉ ุงูุณุงุจูุฉ ูููุฉ ุณ ููู ุงููุณุฑ.</li><li>ูุญุฐู ุญุฑู <strong>ุณ</strong> ูู ุงููุนุงุฏูุฉ ุงูุซุงููุฉ ููุถุน ููุงูู ูุฐุง ุงููุณุฑ (ุจูู ููุณูู).</li><li>ูุง ุชูุณู ุฃู <strong>ุณ</strong> ูุถุฑูุจุฉ ูู ูขุ ูุฐุง ูุฌุจ ูุถุน ูข ูุจู ุงูููุณ.</li></ul><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ (ุดูู ุงูุชุนููุถ)</span><span class="result-eq-display">ูข(${createFraction('ูกูก โ ูคุต', 'ูฃ')}) โ ูฅุต = โูจ</span></div>`
                        },
                        {
                            label: "ุงูุชุฎูุต ูู ุงูููุงู",
                            prompt: "ุงุถุฑุจ ุงููุนุงุฏูุฉ ูููุง ูู ูฃ ููุชุฎูุต ูู ุงูููุงู:",
                            correctHTML: `ูข(ูกูก โ ูคุต) โ ูกูฅุต = โูขูค`,
                            optionsHTML: [`ูข(ูกูก โ ูคุต) โ ูกูฅุต = โูขูค`, `ูข(ูกูก โ ูคุต) โ ูฅุต = โูขูค`],
                            type: "simplify",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูข(${createFraction('ูกูก โ ูคุต', 'ูฃ')}) โ ูฅุต = โูจ</span></div><div class="step-label">ุงูุถุฑุจ ูู ูฃ:</div><p>ูุถุฑุจ ูู ุญุฏ ูู ูฃ: ุงูุญุฏ ุงูุฃูู ูุฐูุจ ููุงููุ <span class="equation-font">โูฅุตรูฃ = โูกูฅุต</span>ุ <span class="equation-font">โูจรูฃ = โูขูค</span>.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูข(ูกูก โ ูคุต) โ ูกูฅุต = โูขูค</span></div>`
                        },
                        {
                            label: "ุงูุชุจุณูุท",
                            prompt: "ูู ุงูุฃููุงุณ ูุฌูุน ุงูุญุฏูุฏ ุงููุชุดุงุจูุฉ:",
                            correctHTML: createMultiLineOption(`ูขูข โ ูจุต โ ูกูฅุต = โูขูค`, `โูขูฃุต = โูคูฆ`),
                            optionsHTML: [createMultiLineOption(`ูขูข โ ูจุต โ ูกูฅุต = โูขูค`, `โูขูฃุต = โูคูฆ`), createMultiLineOption(`ูขูข โ ูคุต โ ูกูฅุต = โูขูค`, `โูกูฉุต = โูคูฆ`)],
                            type: "simplify",
                            explanation: `
                                <div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูข(ูกูก โ ูคุต) โ ูกูฅุต = โูขูค</span></div>
                                <div class="step-label">ุงูุฎุทูุงุช:</div>
                                <ul class="list-disc list-inside">
                                    <li><strong>ูู ุงูุฃููุงุณ:</strong> ูุถุฑุจ <span class="dist-highlight">ูข</span> ูู ูู ุญุฏ:<br><span class="dist-highlight">ูข</span> ร ูกูก = ูขูข<br><span class="dist-highlight">ูข</span> ร โูคุต = โูจุต</li>
                                    <li>ุชุตุจุญ ุงููุนุงุฏูุฉ: <span class="equation-font text-sm">ูขูข โ ูจุต โ ูกูฅุต = โูขูค</span></li>
                                    <li><strong>ุชุฌููุน ุงูุตุงุฏุงุช:</strong> โูจุต โ ูกูฅุต = โูขูฃุต.</li>
                                    <li>ูููู ูขูข ููุทุฑู ุงูุขุฎุฑ ูุชุตุจุญ โูขูข ูุชุฌูุน ูุน โูขูค ูุชุตุจุญ โูคูฆ.</li>
                                </ul>
                                <div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ ุงูููุงุฆู</span><span class="result-eq-display">โูขูฃุต = โูคูฆ</span></div>`
                        },
                        {
                            label: "ุฅูุฌุงุฏ ุต",
                            prompt: "ูููุฉ ุต ูู:",
                            correctHTML: `ุต = ูข`,
                            optionsHTML: [`ุต = ูข`, `ุต = โูข`],
                            type: "solve",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงููุจุณุทุฉ</span><span class="eq-display">โูขูฃุต = โูคูฆ</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ูุฅูุฌุงุฏ ูููุฉ ุตุ ููุณู ุงูุทุฑููู ุนูู ูุนุงูู ุต ููู (<strong>โูขูฃ</strong>).</p><p class="mt-2 text-center"><span class="equation-font">ุต = โูคูฆ รท โูขูฃ</span></p><p class="text-center text-sm text-gray-500">(ุงูุณุงูุจ ูุฑูุญ ูุน ุงูุณุงูุจ)</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ุต = ูข</span></div>`
                        },
                        {
                            label: "ุฅูุฌุงุฏ ุณ",
                            prompt: "ุนูุถ ุนู ุต ูุฅูุฌุงุฏ ุณ:",
                            correctHTML: `(ูก , ูข)`,
                            optionsHTML: [`(ูก , ูข)`, `(ูข , ูก)`],
                            type: "final",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ูุนุงุฏูุฉ ุณ</span><span class="eq-display">ุณ = ${createFraction('ูกูก โ ูคุต', 'ูฃ')}</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><ul class="list-disc list-inside"><li>ูุนูุถ ุนู ุต ุจุงููููุฉ ุงูุชู ุฃูุฌุฏูุงูุง (ูข).</li><li>ุงูุจุณุท ูุตุจุญ: ูกูก โ ูค(ูข) = ูกูก โ ูจ = ูฃ.</li><li>ููุณู ุนูู ุงูููุงู: ูฃ รท ูฃ = ูก.</li></ul><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ (ุงูุญู ุงูููุงุฆู)</span><span class="result-eq-display">ุณ = ูก ุ ุต = ูข โฌ (ูก ุ ูข)</span></div>`
                        },
                        {
                            label: "ููุน ุงููุธุงู",
                            prompt: "ุชุตููู ุงููุธุงู:",
                            correctHTML: "ูุชุณู ููุณุชูู",
                            optionsHTML: ["ูุชุณู ููุณุชูู", "ุบูุฑ ูุชุณู"],
                            type: "text",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงูุญู</span><span class="eq-display">(ูก ุ ูข)</span></div><div class="step-label">ุงูุดุฑุญ:</div><p>ุจูุง ุฃููุง ุงุณุชุทุนูุง ุฅูุฌุงุฏ ูููุฉ ูุญุฏุฏุฉ ูู ุณ ููููุฉ ูุญุฏุฏุฉ ูู ุตุ ููุฐุง ูุนูู ุฃู ุงููุณุชููููู ูุชูุงุทุนุงู ูู ููุทุฉ ูุงุญุฏุฉ ููุท.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูุธุงู ูุชุณู ููุณุชูู</span></div>`
                        }
                    ]
                },
                {
                    eq1HTML: `ูขุณ + ูฃุต = ูง`, 
                    eq2HTML: `ูฃุณ โ ูขุต = ูค`,
                    steps: [
                        {
                            label: "ุชุนุฏูู ุงููุนุงุฏูุฉ",
                            prompt: "ุงุนุฒู (ุณ) ูู ุงููุนุงุฏูุฉ ุงูุฃููู:",
                            correctHTML: `ุณ = ${createFraction('ูง โ ูฃุต', 'ูข')}`,
                            optionsHTML: [`ุณ = ${createFraction('ูง โ ูฃุต', 'ูข')}`, `ุณ = ${createFraction('ูง + ูฃุต', 'ูข')}`],
                            type: "modification",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูขุณ + ูฃุต = ูง</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ูููู ูฃุต ููุทุฑู ุงูุขุฎุฑ ูุชุตุจุญ ุณุงูุจุฉุ ุซู ููุณู ุงูุทุฑููู ุนูู ูข.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ุณ = ${createFraction('ูง โ ูฃุต', 'ูข')}</span></div>`,
                            newEqs: [`ุณ = ${createFraction('ูง โ ูฃุต', 'ูข')}`, `ูฃุณ โ ูขุต = ูค`]
                        },
                        {
                            label: "ุงูุชุนููุถ",
                            prompt: "ุนูุถ ุจูููุฉ ุณ ูู ุงูุซุงููุฉ:",
                            correctHTML: `ูฃ(${createFraction('ูง โ ูฃุต', 'ูข')}) โ ูขุต = ูค`,
                            // ุงูุฎูุงุฑ ุงูุฎุงุทุฆ: ูุณูุงู ุถุฑุจ ุงููุนุงูู 3
                            optionsHTML: [`ูฃ(${createFraction('ูง โ ูฃุต', 'ูข')}) โ ูขุต = ูค`, `${createFraction('ูง โ ูฃุต', 'ูข')} โ ูขุต = ูค`],
                            type: "sub",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูฃุณ โ ูขุต = ูค</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ูุณุชุจุฏู ุณ ุจุงููุณุฑ ูุงููุงูุ ููุง ููุณู ุถุฑุจู ูู ูฃ.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูฃ(${createFraction('ูง โ ูฃุต', 'ูข')}) โ ูขุต = ูค</span></div>`
                        },
                        {
                            label: "ุงูุชุฎูุต ูู ุงูููุงู",
                            prompt: "ุงุถุฑุจ ูู ูข:",
                            correctHTML: `ูฃ(ูง โ ูฃุต) โ ูคุต = ูจ`,
                            optionsHTML: [`ูฃ(ูง โ ูฃุต) โ ูคุต = ูจ`, `ูฃ(ูง โ ูฃุต) โ ูขุต = ูจ`],
                            type: "simplify",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูฃ(${createFraction('ูง โ ูฃุต', 'ูข')}) โ ูขุต = ูค</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ูุถุฑุจ ุงููุนุงุฏูุฉ ูุงููุฉ ูู ูข ููุชุฎูุต ูู ุงูููุงู.</p><ul class="list-disc list-inside"><li>ูุฐูุจ ููุงู ุงููุณุฑ.</li><li>โูขุต ร ูข = โูคุต.</li><li>ูค ร ูข = ูจ.</li></ul><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูฃ(ูง โ ูฃุต) โ ูคุต = ูจ</span></div>`
                        },
                        {
                            label: "ุงูุชุจุณูุท",
                            prompt: "ูู ูุฌูุน:",
                            correctHTML: createMultiLineOption(`ูขูก โ ูฉุต โ ูคุต = ูจ`, `โูกูฃุต = โูกูฃ`),
                            optionsHTML: [createMultiLineOption(`ูขูก โ ูฉุต โ ูคุต = ูจ`, `โูกูฃุต = โูกูฃ`), createMultiLineOption(`ูขูก โ ูฃุต โ ูคุต = ูจ`, `โูงุต = โูกูฃ`)],
                            type: "simplify",
                            explanation: `
                                <div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูฃ(ูง โ ูฃุต) โ ูคุต = ูจ</span></div>
                                <div class="step-label">ุงูุฎุทูุงุช:</div>
                                <p>ูุถุฑุจ ุงูุนุฏุฏ (<span class="dist-highlight">ูฃ</span>) ูู ุงูููุณ:</p>
                                <ul class="list-disc list-inside">
                                    <li><span class="dist-highlight">ูฃ</span> ร ูง = ูขูก</li>
                                    <li><span class="dist-highlight">ูฃ</span> ร โูฃุต = โูฉุต</li>
                                </ul>
                                <p class="mt-2">ุชุฌููุน: โูฉุต โ ูคุต = โูกูฃุต. ููู ูขูก: ูจ - ูขูก = -ูกูฃ.</p>
                                <div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">โูกูฃุต = โูกูฃ</span></div>`
                        },
                        {
                            label: "ุฅูุฌุงุฏ ุต",
                            prompt: "ูููุฉ ุต:",
                            correctHTML: `ุต = ูก`,
                            optionsHTML: [`ุต = ูก`, `ุต = โูก`],
                            type: "solve",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">โูกูฃุต = โูกูฃ</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ููุณู ุงูุทุฑููู ุนูู โูกูฃ.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ุต = ูก</span></div>`
                        },
                        {
                            label: "ุฅูุฌุงุฏ ุณ",
                            prompt: "ุงูุญู ุงูููุงุฆู:",
                            correctHTML: `(ูข , ูก)`,
                            optionsHTML: [`(ูข , ูก)`, `(ูก , ูข)`],
                            type: "final",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุต = ูก</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ูุนูุถ ุจู ูก ูู ูุนุงุฏูุฉ ุณ.</p><p>ูง โ ูฃ(ูก) = ูค.</p><p>ูค รท ูข = ูข.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">(ูข ุ ูก)</span></div>`
                        },
                        {
                            label: "ููุน ุงููุธุงู",
                            prompt: "ุงูุชุตููู:",
                            correctHTML: "ูุชุณู ููุณุชูู",
                            optionsHTML: ["ูุชุณู ููุณุชูู", "ูุชุณู ูุบูุฑ ูุณุชูู"],
                            type: "text",
                            explanation: `<div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูุธุงู ูุชุณู ููุณุชูู (ุญู ูุญูุฏ)</span></div>`
                        }
                    ]
                },
                {
                    eq1HTML: `ูฅุณ + ูขุต = ูกูข`, 
                    eq2HTML: `ูฃุณ โ ูคุต = ูข`,
                    steps: [
                        {
                            label: "ุชุนุฏูู ุงููุนุงุฏูุฉ",
                            prompt: "ุงุนุฒู (ุณ) ูู ุงููุนุงุฏูุฉ ุงูุฃููู:",
                            correctHTML: `ุณ = ${createFraction('ูกูข โ ูขุต', 'ูฅ')}`,
                            optionsHTML: [`ุณ = ${createFraction('ูกูข โ ูขุต', 'ูฅ')}`, `ุณ = ${createFraction('ูกูข + ูขุต', 'ูฅ')}`],
                            type: "modification",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูฅุณ + ูขุต = ูกูข</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ููู ูขุต ุซู ุงููุณูุฉ ุนูู ูฅ.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ุณ = ${createFraction('ูกูข โ ูขุต', 'ูฅ')}</span></div>`,
                            newEqs: [`ุณ = ${createFraction('ูกูข โ ูขุต', 'ูฅ')}`, `ูฃุณ โ ูคุต = ูข`]
                        },
                        {
                            label: "ุงูุชุนููุถ",
                            prompt: "ุนูุถ ูู ุงูุซุงููุฉ:",
                            correctHTML: `ูฃ(${createFraction('ูกูข โ ูขุต', 'ูฅ')}) โ ูคุต = ูข`,
                            // ุงูุฎูุงุฑ ุงูุฎุงุทุฆ: ูุณูุงู ุถุฑุจ ุงููุนุงูู 3
                            optionsHTML: [`ูฃ(${createFraction('ูกูข โ ูขุต', 'ูฅ')}) โ ูคุต = ูข`, `${createFraction('ูกูข โ ูขุต', 'ูฅ')} โ ูคุต = ูข`],
                            type: "sub",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูฃุณ โ ูคุต = ูข</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ุงุณุชุจุฏุงู ุณ ุจุงููุณุฑ ูุน ุถุฑุจู ูู ูฃ.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูฃ(${createFraction('ูกูข โ ูขุต', 'ูฅ')}) โ ูคุต = ูข</span></div>`
                        },
                        {
                            label: "ุงูุชุฎูุต ูู ุงูููุงู",
                            prompt: "ุงุถุฑุจ ูู ูฅ:",
                            correctHTML: `ูฃ(ูกูข โ ูขุต) โ ูขูุต = ูกู`,
                            optionsHTML: [`ูฃ(ูกูข โ ูขุต) โ ูขูุต = ูกู`, `ูฃ(ูกูข โ ูขุต) โ ูคุต = ูกู`],
                            type: "simplify",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูฃ(${createFraction('ูกูข โ ูขุต', 'ูฅ')}) โ ูคุต = ูข</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ูุถุฑุจ ูู ูฅ ููุชุฎูุต ูู ุงูููุงู.</p><ul class="list-disc list-inside"><li>โูคุต ร ูฅ = โูขูุต.</li><li>ูข ร ูฅ = ูกู.</li></ul><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูฃ(ูกูข โ ูขุต) โ ูขูุต = ูกู</span></div>`
                        },
                        {
                            label: "ุงูุชุจุณูุท",
                            prompt: "ูู ูุฌูุน:",
                            correctHTML: createMultiLineOption(`ูฃูฆ โ ูฆุต โ ูขูุต = ูกู`, `โูขูฆุต = โูขูฆ`),
                            optionsHTML: [createMultiLineOption(`ูฃูฆ โ ูฆุต โ ูขูุต = ูกู`, `โูขูฆุต = โูขูฆ`), createMultiLineOption(`ูฃูฆ โ ูขุต โ ูขูุต = ูกู`, `โูขูขุต = โูขูฆ`)],
                            type: "simplify",
                            explanation: `
                                <div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูฃ(ูกูข โ ูขุต) โ ูขูุต = ูกู</span></div>
                                <div class="step-label">ุงูุฎุทูุงุช:</div>
                                <ul class="list-disc list-inside">
                                    <li><strong>ูู ุงูููุณ:</strong> <span class="dist-highlight">ูฃ</span>รูกูข=ูฃูฆุ <span class="dist-highlight">ูฃ</span>รโูขุต=โูฆุต.</li>
                                    <li><strong>ุชุฌููุน:</strong> โูฆุต โ ูขูุต = โูขูฆุต.</li>
                                    <li>ููู ูฃูฆ: ูกู โ ูฃูฆ = โูขูฆ.</li>
                                </ul>
                                <div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">โูขูฆุต = โูขูฆ</span></div>`
                        },
                        {
                            label: "ุฅูุฌุงุฏ ุต",
                            prompt: "ูููุฉ ุต:",
                            correctHTML: `ุต = ูก`,
                            optionsHTML: [`ุต = ูก`, `ุต = ูข`],
                            type: "solve",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">โูขูฆุต = โูขูฆ</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ุงููุณูุฉ ุนูู โูขูฆ.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ุต = ูก</span></div>`
                        },
                        {
                            label: "ุฅูุฌุงุฏ ุณ",
                            prompt: "ุงูุญู ุงูููุงุฆู:",
                            correctHTML: `(ูข , ูก)`,
                            optionsHTML: [`(ูข , ูก)`, `(ูก , ูข)`],
                            type: "final",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุต = ูก</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ุงูุชุนููุถ ูู ูุนุงุฏูุฉ ุณ: (ูกูข โ ูข) รท ูฅ = ูข.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">(ูข ุ ูก)</span></div>`
                        },
                        {
                            label: "ููุน ุงููุธุงู",
                            prompt: "ุงูุชุตููู:",
                            correctHTML: "ูุชุณู ููุณุชูู",
                            optionsHTML: ["ูุชุณู ููุณุชูู", "ุบูุฑ ูุชุณู"],
                            type: "text",
                            explanation: `<div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ุญู ูุญูุฏ</span></div>`
                        }
                    ]
                }
            ],

            noSolution: [
                // ูุณุฃูุฉ 1
                {
                    eq1HTML: `ูขุณ โ ูฃุต = ูฆ`, 
                    eq2HTML: `โูคุณ + ูฆุต = ูกู`,
                    steps: [
                        {
                            label: "ุชุนุฏูู ุงููุนุงุฏูุฉ",
                            prompt: "ุงุนุฒู (ุณ) ูู ุงููุนุงุฏูุฉ ุงูุฃููู:",
                            correctHTML: `ุณ = ${createFraction('ูฆ + ูฃุต', 'ูข')}`,
                            optionsHTML: [`ุณ = ${createFraction('ูฆ + ูฃุต', 'ูข')}`, `ุณ = ${createFraction('ูฆ โ ูฃุต', 'ูข')}`],
                            type: "modification",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูขุณ โ ูฃุต = ูฆ</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ููู โูฃุต ููุทุฑู ุงูุขุฎุฑ (ุชุตุจุญ ููุฌุจุฉ)ุ ุซู ุงููุณูุฉ ุนูู ูข.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ุณ = ${createFraction('ูฆ + ูฃุต', 'ูข')}</span></div>`,
                            newEqs: [`ุณ = ${createFraction('ูฆ + ูฃุต', 'ูข')}`, `โูคุณ + ูฆุต = ูกู`]
                        },
                        {
                            label: "ุงูุชุนููุถ",
                            prompt: "ุนูุถ ูู ุงูุซุงููุฉ:",
                            correctHTML: `โูค(${createFraction('ูฆ + ูฃุต', 'ูข')}) + ูฆุต = ูกู`,
                            // ุงูุฎูุงุฑ ุงูุฎุงุทุฆ: ูุณูุงู ุถุฑุจ ุงููุนุงูู -4
                            optionsHTML: [`โูค(${createFraction('ูฆ + ูฃุต', 'ูข')}) + ูฆุต = ูกู`, `${createFraction('ูฆ + ูฃุต', 'ูข')} + ูฆุต = ูกู`],
                            type: "sub",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">โูคุณ + ูฆุต = ูกู</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ูุณุชุจุฏู ุณ ุจุงููุณุฑ ููุถุฑุจู ูู โูค.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">โูค(${createFraction('ูฆ + ูฃุต', 'ูข')}) + ูฆุต = ูกู</span></div>`
                        },
                        {
                            label: "ุงูุชุจุณูุท",
                            prompt: "ุงุฎุชุตุงุฑ -ูค ูุน ุงูููุงู ูข:",
                            correctHTML: `โูข(ูฆ + ูฃุต) + ูฆุต = ูกู`,
                            optionsHTML: [`โูข(ูฆ + ูฃุต) + ูฆุต = ูกู`, `โูค(ูฆ + ูฃุต) + ูกูขุต = ูขู`],
                            type: "simplify",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">โูค(${createFraction('ูฆ + ูฃุต', 'ูข')}) + ูฆุต = ูกู</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ููุณู ุงูุนุฏุฏ ุงููุถุฑูุจ (<span class="highlight-num">โูค</span>) ุนูู ุงูููุงู (<span class="highlight-num">ูข</span>):<br>โูค รท ูข = โูข.</p><p>ูุถุฑุจ ุงููุงุชุฌ (โูข) ูู ุงูููุณ.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">โูข(ูฆ + ูฃุต) + ูฆุต = ูกู</span></div>`
                        },
                        {
                            label: "ุงููุชูุฌุฉ",
                            prompt: "ุฃููู ุงูุญู:",
                            correctHTML: createMultiLineOption(`โูกูข โ ูฆุต + ูฆุต = ูกู`, `โูกูข = ูกู`),
                            optionsHTML: [createMultiLineOption(`โูกูข โ ูฆุต + ูฆุต = ูกู`, `โูกูข = ูกู`), createMultiLineOption(`โูกูข + ูฃุต + ูฆุต = ูกู`, `ูฉุต = ูขูข`)],
                            type: "simplify",
                            explanation: `
                                <div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">โูข(ูฆ + ูฃุต) + ูฆุต = ูกู</span></div>
                                <div class="step-label">ุงูุฎุทูุงุช:</div>
                                <ul class="list-disc list-inside">
                                    <li><strong>ูู ุงูููุณ:</strong> <span class="dist-highlight">โูข</span>รูฆ=โูกูขุ <span class="dist-highlight">โูข</span>รูฃุต=โูฆุต.</li>
                                    <li>ุงููุนุงุฏูุฉ: โูกูข โ ูฆุต + ูฆุต = ูกู.</li>
                                    <li><strong>ุชุฌููุน:</strong> ูุชู ุญุฐู โูฆุต ูุน +ูฆุต ูุฃู ูุงุชุฌูู ุตูุฑ.</li>
                                </ul>
                                <div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">โูกูข = ูกู (ุนุจุงุฑุฉ ุฎุงุทุฆุฉ)</span></div>`
                        },
                        {
                            label: "ููุน ุงููุธุงู",
                            prompt: "ุงูุชุตููู:",
                            correctHTML: "ุบูุฑ ูุชุณู",
                            optionsHTML: ["ุบูุฑ ูุชุณู", "ูุชุณู ููุณุชูู"],
                            type: "text",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุชูุฌุฉ ุงูุชู ูุตููุง ููุง</span><span class="eq-display">ุนุจุงุฑุฉ ุฎุงุทุฆุฉ (โูกูข=ูกู)</span></div><div class="step-label">ุงูุดุฑุญ:</div><p>ุนูุฏูุง ูุฎุชูู ุงููุชุบูุฑ ูุชูุชุฌ ุนุจุงุฑุฉ ุฑูุงุถูุฉ ุบูุฑ ุตุญูุญุฉ (ูุณุชุญููุฉ)ุ ููุฐุง ูุนูู ุฃู ุงููุณุชููููู ูุชูุงุฒูุงู ููุง ููุชููุงู ุฃุจุฏุงู.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ุบูุฑ ูุชุณู</span></div>`
                        }
                    ]
                },
                // ูุณุฃูุฉ 2
                {
                    eq1HTML: `ูฃุณ โ ูขุต = ูฆ`, 
                    eq2HTML: `โูฆุณ + ูคุต = ูฅ`,
                    steps: [
                        {
                            label: "ุชุนุฏูู ุงููุนุงุฏูุฉ",
                            prompt: "ุงุนุฒู (ุณ) ูู ุงููุนุงุฏูุฉ ุงูุฃููู:",
                            correctHTML: `ุณ = ${createFraction('ูฆ + ูขุต', 'ูฃ')}`,
                            optionsHTML: [`ุณ = ${createFraction('ูฆ + ูขุต', 'ูฃ')}`, `ุณ = ${createFraction('ูฆ โ ูขุต', 'ูฃ')}`],
                            type: "modification",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูฃุณ โ ูขุต = ูฆ</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ููู โูขุต ูุงููุณูุฉ ุนูู ูฃ.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ุณ = ${createFraction('ูฆ + ูขุต', 'ูฃ')}</span></div>`,
                            newEqs: [`ุณ = ${createFraction('ูฆ + ูขุต', 'ูฃ')}`, `โูฆุณ + ูคุต = ูฅ`]
                        },
                        {
                            label: "ุงูุชุนููุถ",
                            prompt: "ุนูุถ ูู ุงูุซุงููุฉ:",
                            correctHTML: `โูฆ(${createFraction('ูฆ + ูขุต', 'ูฃ')}) + ูคุต = ูฅ`,
                            // ุงูุฎูุงุฑ ุงูุฎุงุทุฆ: ูุณูุงู ุถุฑุจ ุงููุนุงูู -6
                            optionsHTML: [`โูฆ(${createFraction('ูฆ + ูขุต', 'ูฃ')}) + ูคุต = ูฅ`, `${createFraction('ูฆ + ูขุต', 'ูฃ')} + ูคุต = ูฅ`],
                            type: "sub",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">โูฆุณ + ูคุต = ูฅ</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ุงุณุชุจุฏุงู ุณ ุจุงููุณุฑ ูุน ุถุฑุจู ูู โูฆ.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">โูฆ(${createFraction('ูฆ + ูขุต', 'ูฃ')}) + ูคุต = ูฅ</span></div>`
                        },
                        {
                            label: "ุงูุชุจุณูุท",
                            prompt: "ุงุฎุชุตุงุฑ -ูฆ ูุน ูฃ:",
                            correctHTML: `โูข(ูฆ + ูขุต) + ูคุต = ูฅ`,
                            optionsHTML: [`โูข(ูฆ + ูขุต) + ูคุต = ูฅ`, `โูฃ(ูฆ + ูขุต) + ูคุต = ูฅ`],
                            type: "simplify",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">โูฆ(${createFraction('ูฆ + ูขุต', 'ูฃ')}) + ูคุต = ูฅ</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ููุณู <span class="highlight-num">โูฆ</span> ุนูู <span class="highlight-num">ูฃ</span> = โูข.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">โูข(ูฆ + ูขุต) + ูคุต = ูฅ</span></div>`
                        },
                        {
                            label: "ุงููุชูุฌุฉ",
                            prompt: "ุฃููู ุงูุญู:",
                            correctHTML: createMultiLineOption(`โูกูข โ ูคุต + ูคุต = ูฅ`, `โูกูข = ูฅ`),
                            optionsHTML: [createMultiLineOption(`โูกูข โ ูคุต + ูคุต = ูฅ`, `โูกูข = ูฅ`), createMultiLineOption(`โูกูข โ ูขุต + ูคุต = ูฅ`, `ูขุต = ูกูง`)],
                            type: "simplify",
                            explanation: `
                                <div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">โูข(ูฆ + ูขุต) + ูคุต = ูฅ</span></div>
                                <div class="step-label">ุงูุฎุทูุงุช:</div>
                                <ul class="list-disc list-inside">
                                    <li><strong>ูู ุงูููุณ:</strong> <span class="dist-highlight">โูข</span>รูฆ=โูกูขุ <span class="dist-highlight">โูข</span>รูขุต=โูคุต.</li>
                                    <li>ุงููุนุงุฏูุฉ: โูกูข โ ูคุต + ูคุต = ูฅ.</li>
                                    <li><strong>ุชุฌููุน:</strong> ูุญุฐู โูคุต ูุน +ูคุต ูุฃู ูุงุชุฌูู ุตูุฑ.</li>
                                </ul>
                                <div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">โูกูข = ูฅ (ุฎุทุฃ)</span></div>`
                        },
                        {
                            label: "ููุน ุงููุธุงู",
                            prompt: "ุงูุชุตููู:",
                            correctHTML: "ุบูุฑ ูุชุณู",
                            optionsHTML: ["ุบูุฑ ูุชุณู", "ูุชุณู"],
                            type: "text",
                            explanation: `<div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ุบูุฑ ูุชุณู</span></div>`
                        }
                    ]
                },
                // ูุณุฃูุฉ 3
                {
                    eq1HTML: `ูขุณ + ูฅุต = ูก`, 
                    eq2HTML: `ูคุณ + ูกูุต = ูฆ`,
                    steps: [
                        {
                            label: "ุชุนุฏูู ุงููุนุงุฏูุฉ",
                            prompt: "ุงุนุฒู (ุณ) ูู ุงููุนุงุฏูุฉ ุงูุฃููู:",
                            correctHTML: `ุณ = ${createFraction('ูก โ ูฅุต', 'ูข')}`,
                            optionsHTML: [`ุณ = ${createFraction('ูก โ ูฅุต', 'ูข')}`, `ุณ = ${createFraction('ูก + ูฅุต', 'ูข')}`],
                            type: "modification",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุฃุตููุฉ</span><span class="eq-display">ูขุณ + ูฅุต = ูก</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ููู ูฅุต โฌ ุณุงูุจ. ูุณูุฉ ุนูู ูข.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ุณ = ${createFraction('ูก โ ูฅุต', 'ูข')}</span></div>`,
                            newEqs: [`ุณ = ${createFraction('ูก โ ูฅุต', 'ูข')}`, `ูคุณ + ูกูุต = ูฆ`]
                        },
                        {
                            label: "ุงูุชุนููุถ",
                            prompt: "ุนูุถ ูู ุงูุซุงููุฉ:",
                            correctHTML: `ูค(${createFraction('ูก โ ูฅุต', 'ูข')}) + ูกูุต = ูฆ`,
                            // ุงูุฎูุงุฑ ุงูุฎุงุทุฆ: ูุณูุงู ุถุฑุจ ุงููุนุงูู 4
                            optionsHTML: [`ูค(${createFraction('ูก โ ูฅุต', 'ูข')}) + ูกูุต = ูฆ`, `${createFraction('ูก โ ูฅุต', 'ูข')} + ูกูุต = ูฆ`],
                            type: "sub",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูคุณ + ูกูุต = ูฆ</span></div><p>ุงุณุชุจุฏุงู ุณ ุจุงููุณุฑ ูุถุฑุจู ูู ูค.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูค(${createFraction('ูก โ ูฅุต', 'ูข')}) + ูกูุต = ูฆ</span></div>`
                        },
                        {
                            label: "ุงูุชุจุณูุท",
                            prompt: "ุงุฎุชุตุงุฑ ูค ูุน ูข:",
                            correctHTML: `ูข(ูก โ ูฅุต) + ูกูุต = ูฆ`,
                            optionsHTML: [`ูข(ูก โ ูฅุต) + ูกูุต = ูฆ`, `ูค(ูก โ ูฅุต) + ูขูุต = ูกูข`],
                            type: "simplify",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูค(...)</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p><span class="highlight-num">ูค</span> รท <span class="highlight-num">ูข</span> = ูข.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูข(ูก โ ูฅุต) + ูกูุต = ูฆ</span></div>`
                        },
                        {
                            label: "ุงููุชูุฌุฉ",
                            prompt: "ุฃููู ุงูุญู:",
                            correctHTML: createMultiLineOption(`ูข โ ูกูุต + ูกูุต = ูฆ`, `ูข = ูฆ`),
                            optionsHTML: [createMultiLineOption(`ูข โ ูกูุต + ูกูุต = ูฆ`, `ูข = ูฆ`), createMultiLineOption(`ูข โ ูฅุต + ูกูุต = ูฆ`, `ูฅุต = ูค`)],
                            type: "simplify",
                            explanation: `
                                <div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูข(ูก โ ูฅุต) + ูกูุต = ูฆ</span></div>
                                <div class="step-label">ุงูุฎุทูุงุช:</div>
                                <ul class="list-disc list-inside">
                                    <li><span class="dist-highlight">ูข</span>รูก=ูขุ <span class="dist-highlight">ูข</span>รโูฅุต=โูกูุต.</li>
                                    <li>ุงููุนุงุฏูุฉ: ูข โ ูกูุต + ูกูุต = ูฆ.</li>
                                    <li>ุชุฌููุน: ูุชู ุญุฐู โูกูุต ูุน +ูกูุต ูุฃู ูุงุชุฌูู ุตูุฑ.</li>
                                </ul>
                                <div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูข = ูฆ (ุฎุทุฃ)</span></div>`
                        },
                        {
                            label: "ููุน ุงููุธุงู",
                            prompt: "ุงูุชุตููู:",
                            correctHTML: "ุบูุฑ ูุชุณู",
                            optionsHTML: ["ุบูุฑ ูุชุณู", "ูุชุณู"],
                            type: "text",
                            explanation: `<div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ุบูุฑ ูุชุณู</span></div>`
                        }
                    ]
                }
            ],

            infinite: [
                // ูุณุฃูุฉ 1
                {
                    eq1HTML: `ุณ + ูขุต = ูค`, 
                    eq2HTML: `ูฃุณ + ูฆุต = ูกูข`,
                    steps: [
                        {
                            label: "ุชุนุฏูู ุงููุนุงุฏูุฉ",
                            prompt: "ุงุนุฒู (ุต) ูู ุงูุฃููู:",
                            correctHTML: `ุต = ${createFraction('ูค โ ุณ', 'ูข')}`,
                            optionsHTML: [`ุต = ${createFraction('ูค โ ุณ', 'ูข')}`, `ุต = ${createFraction('ูค + ุณ', 'ูข')}`],
                            type: "modification",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ุณ + ูขุต = ูค</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ููู ุณ ุซู ุงููุณูุฉ ุนูู ูข.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ุต = ${createFraction('ูค โ ุณ', 'ูข')}</span></div>`,
                            newEqs: [`ุต = ${createFraction('ูค โ ุณ', 'ูข')}`, `ูฃุณ + ูฆุต = ูกูข`]
                        },
                        {
                            label: "ุงูุชุนููุถ",
                            prompt: "ุนูุถ ุนู ุต:",
                            correctHTML: `ูฃุณ + ูฆ(${createFraction('ูค โ ุณ', 'ูข')}) = ูกูข`,
                            // ุงูุฎูุงุฑ ุงูุฎุงุทุฆ: ูุณูุงู ุถุฑุจ ุงููุนุงูู 6
                            optionsHTML: [`ูฃุณ + ูฆ(${createFraction('ูค โ ุณ', 'ูข')}) = ูกูข`, `ูฃุณ + ${createFraction('ูค โ ุณ', 'ูข')} = ูกูข`],
                            type: "sub",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูฃุณ + ูฆุต = ูกูข</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ุงุณุชุจุฏุงู ุต ุจุงููุณุฑ ูุถุฑุจู ูู ูฆ.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูฃุณ + ูฆ(${createFraction('ูค โ ุณ', 'ูข')}) = ูกูข</span></div>`
                        },
                        {
                            label: "ุงูุชุจุณูุท",
                            prompt: "ุงุฎุชุตุงุฑ ูฆ ูุน ูข:",
                            correctHTML: `ูฃุณ + ูฃ(ูค โ ุณ) = ูกูข`,
                            optionsHTML: [`ูฃุณ + ูฃ(ูค โ ุณ) = ูกูข`, `ูฃุณ + ูฆ(ูค โ ุณ) = ูขูค`],
                            type: "simplify",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูฆ(${createFraction('ูค โ ุณ', 'ูข')})</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ููุณู <span class="highlight-num">ูฆ</span> ุนูู <span class="highlight-num">ูข</span> = ูฃ.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูฃุณ + ูฃ(ูค โ ุณ) = ูกูข</span></div>`
                        },
                        {
                            label: "ุงููุชูุฌุฉ",
                            prompt: "ูู ูุฌูุน:",
                            correctHTML: createMultiLineOption(`ูฃุณ + ูกูข โ ูฃุณ = ูกูข`, `ูกูข = ูกูข`),
                            optionsHTML: [createMultiLineOption(`ูฃุณ + ูกูข โ ูฃุณ = ูกูข`, `ูกูข = ูกูข`), createMultiLineOption(`ูฃุณ + ูกูข โ ุณ = ูกูข`, `ูขุณ = ู`)],
                            type: "simplify",
                            explanation: `
                                <div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูฃุณ + ูฃ(ูค โ ุณ) = ูกูข</span></div>
                                <div class="step-label">ุงูุฎุทูุงุช:</div>
                                <ul class="list-disc list-inside">
                                    <li><strong>ูู ุงูููุณ:</strong> <span class="dist-highlight">ูฃ</span>รูค=ูกูขุ <span class="dist-highlight">ูฃ</span>รโุณ=โูฃุณ.</li>
                                    <li>ุงููุนุงุฏูุฉ: ูฃุณ + ูกูข โ ูฃุณ = ูกูข.</li>
                                    <li><strong>ุชุฌููุน:</strong> ูุชู ุญุฐู ูฃุณ ูุน โูฃุณ ูุฃู ูุงุชุฌูู ุตูุฑ.</li>
                                </ul>
                                <div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูกูข = ูกูข (ุนุจุงุฑุฉ ุตุญูุญุฉ)</span></div>`
                        },
                        {
                            label: "ููุน ุงููุธุงู",
                            prompt: "ุงูุชุตููู:",
                            correctHTML: "ูุชุณู ูุบูุฑ ูุณุชูู",
                            optionsHTML: ["ูุชุณู ูุบูุฑ ูุณุชูู", "ุบูุฑ ูุชุณู"],
                            type: "text",
                            explanation: `<div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูุชุณู ูุบูุฑ ูุณุชูู</span></div>`
                        }
                    ]
                },
                // ูุณุฃูุฉ 2
                {
                    eq1HTML: `ูฃุณ + ูฅุต = ูกูฅ`, 
                    eq2HTML: `ูฆุณ + ูกูุต = ูฃู`,
                    steps: [
                        {
                            label: "ุชุนุฏูู ุงููุนุงุฏูุฉ",
                            prompt: "ุงุนุฒู (ุณ) ูู ุงูุฃููู:",
                            correctHTML: `ุณ = ${createFraction('ูกูฅ โ ูฅุต', 'ูฃ')}`,
                            optionsHTML: [`ุณ = ${createFraction('ูกูฅ โ ูฅุต', 'ูฃ')}`, `ุณ = ${createFraction('ูกูฅ + ูฅุต', 'ูฃ')}`],
                            type: "modification",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูฃุณ + ูฅุต = ูกูฅ</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ููู ูฅุต ูุงููุณูุฉ ุนูู ูฃ.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ุณ = ${createFraction('ูกูฅ โ ูฅุต', 'ูฃ')}</span></div>`,
                            newEqs: [`ุณ = ${createFraction('ูกูฅ โ ูฅุต', 'ูฃ')}`, `ูฆุณ + ูกูุต = ูฃู`]
                        },
                        {
                            label: "ุงูุชุนููุถ",
                            prompt: "ุนูุถ ุนู ุณ:",
                            correctHTML: `ูฆ(${createFraction('ูกูฅ โ ูฅุต', 'ูฃ')}) + ูกูุต = ูฃู`,
                            // ุงูุฎูุงุฑ ุงูุฎุงุทุฆ: ูุณูุงู ุถุฑุจ ุงููุนุงูู 6
                            optionsHTML: [`ูฆ(${createFraction('ูกูฅ โ ูฅุต', 'ูฃ')}) + ูกูุต = ูฃู`, `${createFraction('ูกูฅ โ ูฅุต', 'ูฃ')} + ูกูุต = ูฃู`],
                            type: "sub",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูฆุณ + ูกูุต = ูฃู</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ุงุณุชุจุฏุงู ุณ ุจุงููุณุฑ ูุถุฑุจู ูู ูฆ.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูฆ(${createFraction('ูกูฅ โ ูฅุต', 'ูฃ')}) + ูกูุต = ูฃู</span></div>`
                        },
                        {
                            label: "ุงูุชุจุณูุท",
                            prompt: "ุงุฎุชุตุงุฑ ูฆ ูุน ูฃ:",
                            correctHTML: `ูข(ูกูฅ โ ูฅุต) + ูกูุต = ูฃู`,
                            optionsHTML: [`ูข(ูกูฅ โ ูฅุต) + ูกูุต = ูฃู`, `ูฆ(ูกูฅ โ ูฅุต) + ูฃูุต = ูฉู`],
                            type: "simplify",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูฆ(...)</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p><span class="highlight-num">ูฆ</span> รท <span class="highlight-num">ูฃ</span> = ูข.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูข(ูกูฅ โ ูฅุต) + ูกูุต = ูฃู</span></div>`
                        },
                        {
                            label: "ุงููุชูุฌุฉ",
                            prompt: "ูู ูุฌูุน:",
                            correctHTML: createMultiLineOption(`ูฃู โ ูกูุต + ูกูุต = ูฃู`, `ูฃู = ูฃู`),
                            optionsHTML: [createMultiLineOption(`ูฃู โ ูกูุต + ูกูุต = ูฃู`, `ูฃู = ูฃู`), createMultiLineOption(`ูฃู โ ูฅุต + ูกูุต = ูฃู`, `ูฅุต = ู`)],
                            type: "simplify",
                            explanation: `
                                <div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">ูข(ูกูฅ โ ูฅุต) + ูกูุต = ูฃู</span></div>
                                <div class="step-label">ุงูุฎุทูุงุช:</div>
                                <ul class="list-disc list-inside">
                                    <li><span class="dist-highlight">ูข</span>รูกูฅ=ูฃูุ <span class="dist-highlight">ูข</span>รโูฅุต=โูกูุต.</li>
                                    <li>ุชุฌููุน: ูุชู ุญุฐู โูกูุต ูุน +ูกูุต ูุฃู ูุงุชุฌูู ุตูุฑ.</li>
                                </ul>
                                <div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูฃู = ูฃู</span></div>`
                        },
                        {
                            label: "ููุน ุงููุธุงู",
                            prompt: "ุงูุชุตููู:",
                            correctHTML: "ูุชุณู ูุบูุฑ ูุณุชูู",
                            optionsHTML: ["ูุชุณู ูุบูุฑ ูุณุชูู", "ูุชุณู ููุณุชูู"],
                            type: "text",
                            explanation: `<div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูุชุณู ูุบูุฑ ูุณุชูู</span></div>`
                        }
                    ]
                },
                // ูุณุฃูุฉ 3
                {
                    eq1HTML: `ูขุณ + ูฃุต = ูฆ`, 
                    eq2HTML: `โูคุณ โ ูฆุต = โูกูข`,
                    steps: [
                        {
                            label: "ุชุนุฏูู ุงููุนุงุฏูุฉ",
                            prompt: "ุงุนุฒู (ุณ) ูู ุงูุฃููู:",
                            correctHTML: `ุณ = ${createFraction('ูฆ โ ูฃุต', 'ูข')}`,
                            optionsHTML: [`ุณ = ${createFraction('ูฆ โ ูฃุต', 'ูข')}`, `ุณ = ${createFraction('ูฆ + ูฃุต', 'ูข')}`],
                            type: "modification",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุฃุตููุฉ</span><span class="eq-display">ูขุณ + ูฃุต = ูฆ</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p>ููู ูฃุต โฌ ุณุงูุจ. ูุณูุฉ ุนูู ูข.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ุณ = ${createFraction('ูฆ โ ูฃุต', 'ูข')}</span></div>`,
                            newEqs: [`ุณ = ${createFraction('ูฆ โ ูฃุต', 'ูข')}`, `โูคุณ โ ูฆุต = โูกูข`]
                        },
                        {
                            label: "ุงูุชุนููุถ",
                            prompt: "ุนูุถ ุนู ุณ:",
                            correctHTML: `โูค(${createFraction('ูฆ โ ูฃุต', 'ูข')}) โ ูฆุต = โูกูข`,
                            // ุงูุฎูุงุฑ ุงูุฎุงุทุฆ: ูุณูุงู ุถุฑุจ ุงููุนุงูู -4
                            optionsHTML: [`โูค(${createFraction('ูฆ โ ูฃุต', 'ูข')}) โ ูฆุต = โูกูข`, `${createFraction('ูฆ โ ูฃุต', 'ูข')} โ ูฆุต = โูกูข`],
                            type: "sub",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุชุงู</span><span class="eq-display">ุณ = ...</span> ุ <span class="eq-display">โูคุณ โ ูฆุต = โูกูข</span></div><p>ุงุณุชุจุฏุงู ุณ ุจุงููุณุฑ ูุถุฑุจู ูู โูค.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">โูค(${createFraction('ูฆ โ ูฃุต', 'ูข')}) โ ูฆุต = โูกูข</span></div>`
                        },
                        {
                            label: "ุงูุชุจุณูุท",
                            prompt: "ุงุฎุชุตุงุฑ -ูค ูุน ูข:",
                            correctHTML: `โูข(ูฆ โ ูฃุต) โ ูฆุต = โูกูข`,
                            optionsHTML: [`โูข(ูฆ โ ูฃุต) โ ูฆุต = โูกูข`, `โูค(ูฆ โ ูฃุต) โ ูกูขุต = โูขูค`],
                            type: "simplify",
                            explanation: `<div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">โูค(...)</span></div><div class="step-label">ุงูุฎุทูุงุช:</div><p><span class="highlight-num">โูค</span> รท <span class="highlight-num">ูข</span> = โูข.</p><div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">โูข(ูฆ โ ูฃุต) โ ูฆุต = โูกูข</span></div>`
                        },
                        {
                            label: "ุงููุชูุฌุฉ",
                            prompt: "ูู ูุฌูุน:",
                            correctHTML: createMultiLineOption(`โูกูข + ูฆุต โ ูฆุต = โูกูข`, `โูกูข = โูกูข`),
                            optionsHTML: [createMultiLineOption(`โูกูข + ูฆุต โ ูฆุต = โูกูข`, `โูกูข = โูกูข`), createMultiLineOption(`โูกูข + ูฆุต โ ูฆุต = โูกูข`, `ูกูขุต = โูขูค`)],
                            type: "simplify",
                            explanation: `
                                <div class="original-eq-box"><span class="original-eq-label">ุงููุนุงุฏูุฉ ุงูุณุงุจูุฉ</span><span class="eq-display">โูข(ูฆ โ ูฃุต) โ ูฆุต = โูกูข</span></div>
                                <div class="step-label">ุงูุฎุทูุงุช:</div>
                                <ul class="list-disc list-inside">
                                    <li><span class="dist-highlight">โูข</span>รูฆ=โูกูขุ <span class="dist-highlight">โูข</span>รโูฃุต=ูฆุต.</li>
                                    <li>ุชุฌููุน: ูฆุต โ ูฆุต = ู.</li>
                                </ul>
                                <div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">โูกูข = โูกูข</span></div>`
                        },
                        {
                            label: "ููุน ุงููุธุงู",
                            prompt: "ุงูุชุตููู:",
                            correctHTML: "ูุชุณู ูุบูุฑ ูุณุชูู",
                            optionsHTML: ["ูุชุณู ูุบูุฑ ูุณุชูู", "ุบูุฑ ูุชุณู"],
                            type: "text",
                            explanation: `<div class="result-eq-box"><span class="result-eq-label">ุงููุงุชุฌ</span><span class="result-eq-display">ูุชุณู ูุบูุฑ ูุณุชูู</span></div>`
                        }
                    ]
                }
            ]
        };

        // --- ุจุงูู ุงูููุฏ ---
        let gameSequence = [];
        let currentQIndex = 0;
        let currentStepIndex = 0;
        let score = 0;
        let maxScore = 0;
        let timerInterval;
        let startTime;

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function startTimer() {
            startTime = Date.now();
            timerInterval = setInterval(() => {
                const elapsedTime = Math.floor((Date.now() - startTime) / 1000);
                const minutes = Math.floor(elapsedTime / 60);
                const seconds = elapsedTime % 60;
                document.getElementById('time-display').innerText = `โฑ๏ธ ${toArabicNum(minutes.toString().padStart(2, '0'))}:${toArabicNum(seconds.toString().padStart(2, '0'))}`;
            }, 1000);
        }

        function stopTimer() {
            clearInterval(timerInterval);
        }

        function resumeTimer() {
            // We adjust startTime to account for the pause duration
            // For simplicity in this context, we'll just restart from current elapsed visual
            // A more robust way involves tracking total elapsed time separately.
            // Given the simplicity, let's just restart interval, noting that 
            // true pause/resume logic usually tracks 'pausedTime'.
            // For this demo, let's assume the timer just continues running in background
            // OR we pause it visually. 
            
            // Better approach for this request:
            // 1. Track `totalPausedTime`
            // 2. When resuming, add the pause duration to `startTime`
            // But since the user asked to "stop" and "resume", let's do:
            // When stopping, record `pauseStart`. When resuming, add `Date.now() - pauseStart` to `startTime`.
        }
        
        // Global variables for timer management
        let pauseStartTime;
        let totalPausedTime = 0;
        let isPaused = false;

        function startGame() {
            let types = ['intersection', 'noSolution', 'infinite'];
            types = shuffleArray(types);

            gameSequence = types.map(type => {
                const pool = hardQuestions[type];
                const randomIndex = Math.floor(Math.random() * pool.length);
                return pool[randomIndex];
            });

            maxScore = gameSequence.reduce((acc, q) => acc + q.steps.length, 0);
            
            currentQIndex = 0;
            currentStepIndex = 0;
            score = 0;
            
            document.getElementById('welcome-screen').classList.remove('show');
            document.getElementById('game-ui').classList.remove('hidden');
            updateScoreDisplay();
            
            // Start Timer
            startTime = Date.now();
            timerInterval = setInterval(updateTimerDisplay, 1000);
            
            loadQuestion();
        }

        function updateTimerDisplay() {
            if (!isPaused) {
                const now = Date.now();
                const totalElapsed = now - startTime - totalPausedTime;
                const secondsTotal = Math.floor(totalElapsed / 1000);
                const minutes = Math.floor(secondsTotal / 60);
                const seconds = secondsTotal % 60;
                document.getElementById('time-display').innerText = `โฑ๏ธ ${toArabicNum(minutes.toString().padStart(2, '0'))}:${toArabicNum(seconds.toString().padStart(2, '0'))}`;
            }
        }

        function updateScoreDisplay() {
            document.getElementById('current-score-display').innerText = `ุงูููุงุท: ${toArabicNum(score)}`;
        }

        function loadQuestion() {
            const q = gameSequence[currentQIndex];
            currentStepIndex = 0;
            
            document.getElementById('question-counter').innerText = `ุงููุณุฃูุฉ ${toArabicNum(currentQIndex + 1)} ูู ${toArabicNum(gameSequence.length)}`;
            
            const mainEqDiv = document.getElementById('main-equations');
            mainEqDiv.classList.remove('faded');
            
            document.getElementById('eq1').innerHTML = q.eq1HTML;
            document.getElementById('eq2').innerHTML = q.eq2HTML;
            
            document.getElementById('steps-history').innerHTML = '';
            document.getElementById('interaction-area').classList.remove('hidden');
            document.getElementById('next-btn').classList.add('hidden');
            document.getElementById('explain-btn').classList.add('hidden');
            document.getElementById('feedback-message').innerText = '';
            
            renderStep();
        }

        function renderStep() {
            const q = gameSequence[currentQIndex];
            const step = q.steps[currentStepIndex];
            
            document.getElementById('prompt-text').innerText = step.prompt;
            const grid = document.getElementById('options-grid');
            grid.innerHTML = '';
            
            const opts = [...step.optionsHTML].sort(() => Math.random() - 0.5);
            
            opts.forEach(optHTML => {
                const btn = document.createElement('button');
                const isText = step.type === 'text';
                btn.className = `choice-button ${isText ? 'text-choice' : ''}`;
                
                btn.innerHTML = `<span class="btn-content">${optHTML}</span>`;
                
                btn.onclick = () => submitChoice(btn, optHTML);
                grid.appendChild(btn);
            });
        }

        function submitChoice(btn, selectedHTML) {
            const buttons = document.querySelectorAll('.choice-button');
            buttons.forEach(b => b.disabled = true);

            const q = gameSequence[currentQIndex];
            const step = q.steps[currentStepIndex];
            
            const isCorrect = selectedHTML === step.correctHTML;
            
            const feedbackMsg = document.getElementById('feedback-message');
            const nextBtn = document.getElementById('next-btn');
            const explainBtn = document.getElementById('explain-btn');

            if (isCorrect) {
                btn.classList.add('correct');
                score++;
                updateScoreDisplay();
                feedbackMsg.innerText = "ุฃุญุณูุช! ุฅุฌุงุจุฉ ุตุญูุญุฉ โ";
                feedbackMsg.className = "text-green-600 font-bold mb-1 text-lg";
                explainBtn.classList.add('hidden');
                
                if (step.newEqs) {
                    document.getElementById('main-equations').classList.add('faded');
                    addModifiedSystemToHistory(step.label, step.newEqs);
                } else {
                    addToHistory(step.label, step.correctHTML);
                }
            } else {
                btn.classList.add('incorrect');
                // ุชูููู ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ
                buttons.forEach(b => {
                    if(b.innerHTML.includes(step.correctHTML)) b.classList.add('correct');
                });
                
                feedbackMsg.innerText = "ุฎุทุฃ โ";
                feedbackMsg.className = "text-red-600 font-bold mb-1 text-2xl";
                
                explainBtn.classList.remove('hidden');
                
                if (step.newEqs) {
                    document.getElementById('main-equations').classList.add('faded');
                    addModifiedSystemToHistory(step.label, step.newEqs);
                } else {
                    addToHistory(step.label, step.correctHTML);
                }
            }
            
            document.getElementById('interaction-area').classList.add('hidden');
            nextBtn.classList.remove('hidden');
            
            setTimeout(scrollGameCardToBottom, 100);
        }

        function scrollGameCardToBottom() {
            const gameCard = document.getElementById('game-ui');
            gameCard.scrollTo({
                top: gameCard.scrollHeight,
                behavior: 'smooth'
            });
        }

        function showDetailedExplanation() {
            const q = gameSequence[currentQIndex];
            const step = q.steps[currentStepIndex];
            const contentDiv = document.getElementById('explanation-content');
            
            contentDiv.innerHTML = step.explanation;
            document.getElementById('detailed-explanation-modal').classList.add('show');
            
            // Pause timer
            isPaused = true;
            pauseStartTime = Date.now();
        }

        function hideDetailedExplanation() {
            document.getElementById('detailed-explanation-modal').classList.remove('show');
            
            // Resume timer
            if(isPaused) {
                const pauseDuration = Date.now() - pauseStartTime;
                totalPausedTime += pauseDuration;
                isPaused = false;
            }
        }

        function addToHistory(label, htmlContent) {
            const div = document.createElement('div');
            div.className = 'history-step';
            div.innerHTML = `<span class="text-sm font-bold text-gray-700">${label}</span> <span class="equation-font">${htmlContent}</span>`;
            document.getElementById('steps-history').appendChild(div);
            scrollToBottom();
        }

        function addModifiedSystemToHistory(label, eqsHTML) {
            const div = document.createElement('div');
            div.className = 'history-step modification-step';
            div.innerHTML = `
                <div class="text-sm font-bold text-green-700 w-full text-center border-b border-green-200 pb-1 mb-1">${label}</div>
                <div class="flex flex-wrap justify-center gap-2">
                    <span class="equation-font eq-badge">${eqsHTML[0]}</span>
                    <span class="equation-font eq-badge">${eqsHTML[1]}</span>
                </div>`;
            document.getElementById('steps-history').appendChild(div);
            scrollToBottom();
        }

        function scrollToBottom() {
            const container = document.getElementById('problem-area');
            container.scrollTop = container.scrollHeight;
        }

        function nextStep() {
            const q = gameSequence[currentQIndex];
            currentStepIndex++;
            
            document.getElementById('interaction-area').classList.remove('hidden');
            document.getElementById('next-btn').classList.add('hidden');
            document.getElementById('explain-btn').classList.add('hidden');
            document.getElementById('feedback-message').innerText = '';

            if (currentStepIndex < q.steps.length) {
                renderStep();
            } else {
                currentQIndex++;
                if (currentQIndex < gameSequence.length) {
                    loadQuestion();
                } else {
                    endGame();
                }
            }
        }

        function endGame() {
            clearInterval(timerInterval);
            document.getElementById('game-ui').classList.add('hidden');
            document.getElementById('end-screen').classList.add('show');
            
            let finalGrade = (score / maxScore) * 5;
            finalGrade = Math.round(finalGrade * 10) / 10; 
            if (finalGrade > 5) finalGrade = 5;

            document.getElementById('points-display').innerText = `${toArabicNum(score)} / ${toArabicNum(maxScore)}`;
            
            // Calculate final time string
            const now = Date.now();
            const totalElapsed = now - startTime - totalPausedTime;
            const secondsTotal = Math.floor(totalElapsed / 1000);
            const minutes = Math.floor(secondsTotal / 60);
            const seconds = secondsTotal % 60;
            const timeString = `${toArabicNum(minutes)} ุฏูููุฉ ู ${toArabicNum(seconds)} ุซุงููุฉ`;
            
            document.getElementById('final-time-display').innerText = timeString;
            document.getElementById('final-grade-display').innerText = `${toArabicNum(finalGrade)} / ูฅ`;

            if (window.saveAndFinishGame) {
                window.saveAndFinishGame(score, maxScore - score);
            }
        }
    </script>

    <!-- ูุญุฑู ุงูุงุชุตุงู -->
    <script>
    (function() {
        let SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzrf1-At3Pq7i39bGV3F1iD3-b0G-WWyRi5cgpKeQjyn_N5fh2EmGhoyRKUsbLd-F_UJQ/exec";
        let GAME_ID = 'g5_2_2';

        const urlParams = new URLSearchParams(window.location.search);
        const studentId = urlParams.get('studentId');
        const classId = urlParams.get('classId');

        window.saveAndFinishGame = function(points, errors) {
            const saveStatus = document.getElementById('save-status');
            
            let grade = (points / maxScore) * 5;
            grade = Math.min(5, Math.max(0, grade)).toFixed(2);

            if(studentId && classId) {
                saveStatus.innerText = "ุฌุงุฑู ุญูุธ ุงูุฏุฑุฌุฉ...";
                const params = new URLSearchParams({
                    action: 'saveGrade',
                    studentId: studentId,
                    classId: classId,
                    itemId: GAME_ID,
                    grade: grade,
                    metricValue: errors
                });

                fetch(`${SCRIPT_URL}?${params.toString()}`)
                    .then(r => r.json())
                    .then(data => {
                        if(data.status === 'success') {
                            saveStatus.innerText = "ุชู ุญูุธ ุงูุฏุฑุฌุฉ ุจูุฌุงุญ โ";
                            saveStatus.className = "text-sm text-green-600 mb-4 h-6 font-bold";
                        } else {
                            saveStatus.innerText = "ูู ูุชู ุงูุญูุธ (ุฎุทุฃ ูู ุงูุฎุงุฏู)";
                            saveStatus.className = "text-sm text-red-500 mb-4 h-6";
                        }
                    })
                    .catch(e => {
                        saveStatus.innerText = "ุฎุทุฃ ูู ุงูุงุชุตุงู โ๏ธ";
                        saveStatus.className = "text-sm text-red-500 mb-4 h-6";
                    });
            } else {
                saveStatus.innerText = "ูุถุน ุงูุฒุงุฆุฑ: ูู ูุชู ุญูุธ ุงูุฏุฑุฌุฉ";
            }
        };
    })();
    </script>
</body>
</html>
